Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross1', dropout=0.3, emb_dim=200, gamma=0.7, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, type=3, weight=None)
2022-02-07 20:03:16
loading data...
[n_users, n_items]=[3209, 12211]
[n_train, n_test]=[2636, 1318]
[n_edges]=[280090]
Using GPU 2,  memory_free: 24265
tensor([-0.0079, -0.0382,  0.0117,  0.0081, -0.0060], device='cuda:2')
Loading Model..Number of Model Parameters:  3324802
Epoch 0 [32.6s + 9.4s]: train==[20.64837 = 4.42397 + 16.22440], recall= [ 0.00000  0.00000  0.00000  0.00000] , precision= [ 0.00000  0.00000  0.00000  0.00000] , auc=[0.43243], sum_recall=[0.00000]
Epoch 1 [33.0s + 10.9s]: train==[18.03345 = 1.83594 + 16.19751], recall= [ 0.02523  0.06885  0.10406  0.13139] , precision= [ 0.02904  0.01520  0.01178  0.00979] , auc=[0.69025], sum_recall=[0.32953]
Epoch 2 [33.3s + 12.2s]: train==[17.24624 = 1.13762 + 16.10862], recall= [ 0.02494  0.09180  0.15124  0.18340] , precision= [ 0.02904  0.02067  0.01734  0.01389] , auc=[0.75950], sum_recall=[0.45139]
Epoch 3 [33.1s + 12.2s]: train==[16.88635 = 0.88238 + 16.00397], recall= [ 0.02736  0.09771  0.15812  0.19863] , precision= [ 0.03160  0.02203  0.01776  0.01503] , auc=[0.78152], sum_recall=[0.48182]
Epoch 4 [33.0s + 11.8s]: train==[16.63467 = 0.73623 + 15.89843], recall= [ 0.02775  0.10070  0.15613  0.19535] , precision= [ 0.02989  0.02254  0.01734  0.01446] , auc=[0.79318], sum_recall=[0.47993]
Epoch 5 [33.3s + 11.8s]: train==[16.45695 = 0.65923 + 15.79771], recall= [ 0.02605  0.10059  0.15186  0.18581] , precision= [ 0.02818  0.02220  0.01691  0.01378] , auc=[0.80044], sum_recall=[0.46431]
Epoch 6 [33.0s + 12.1s]: train==[16.32624 = 0.61914 + 15.70710], recall= [ 0.02861  0.10016  0.15414  0.18814] , precision= [ 0.03074  0.02203  0.01699  0.01401] , auc=[0.80534], sum_recall=[0.47105]
Epoch 7 [33.2s + 11.9s]: train==[16.22339 = 0.59584 + 15.62755], recall= [ 0.02562  0.09995  0.15305  0.19300] , precision= [ 0.02733  0.02186  0.01699  0.01435] , auc=[0.80938], sum_recall=[0.47162]
Epoch 8 [33.5s + 12.2s]: train==[16.13132 = 0.57182 + 15.55950], recall= [ 0.02904  0.09927  0.15531  0.19678] , precision= [ 0.03074  0.02186  0.01725  0.01457] , auc=[0.81313], sum_recall=[0.48039]
Epoch 9 [33.5s + 12.3s]: train==[16.03522 = 0.53857 + 15.49666], recall= [ 0.02875  0.10311  0.15684  0.19769] , precision= [ 0.02989  0.02254  0.01742  0.01469] , auc=[0.81623], sum_recall=[0.48639]
Epoch 10 [33.3s + 12.4s]: train==[15.92379 = 0.50718 + 15.41661], recall= [ 0.02960  0.10268  0.15940  0.20167] , precision= [ 0.03074  0.02254  0.01768  0.01514] , auc=[0.81900], sum_recall=[0.49335]
Epoch 11 [33.0s + 12.2s]: train==[15.77310 = 0.48029 + 15.29281], recall= [ 0.02918  0.10433  0.16194  0.20107] , precision= [ 0.03074  0.02289  0.01802  0.01520] , auc=[0.82120], sum_recall=[0.49651]
Epoch 12 [33.5s + 12.1s]: train==[15.56014 = 0.46227 + 15.09786], recall= [ 0.02918  0.10561  0.16174  0.20085] , precision= [ 0.03074  0.02323  0.01819  0.01526] , auc=[0.82277], sum_recall=[0.49738]
Epoch 13 [33.4s + 12.8s]: train==[15.27594 = 0.43889 + 14.83705], recall= [ 0.02704  0.10454  0.16484  0.20228] , precision= [ 0.02904  0.02323  0.01853  0.01543] , auc=[0.82356], sum_recall=[0.49870]
Epoch 14 [33.6s + 11.8s]: train==[15.01092 = 0.44757 + 14.56336], recall= [ 0.02640  0.10369  0.16185  0.20356] , precision= [ 0.02904  0.02306  0.01827  0.01554] , auc=[0.82400], sum_recall=[0.49550]
Epoch 15 [33.3s + 11.7s]: train==[14.79778 = 0.44741 + 14.35036], recall= [ 0.02565  0.10696  0.16220  0.20644] , precision= [ 0.02904  0.02357  0.01845  0.01571] , auc=[0.82450], sum_recall=[0.50126]
Epoch 16 [35.2s + 12.0s]: train==[14.65711 = 0.46418 + 14.19293], recall= [ 0.02565  0.10653  0.16146  0.20562] , precision= [ 0.02904  0.02340  0.01836  0.01560] , auc=[0.82522], sum_recall=[0.49927]
Epoch 17 [33.5s + 12.7s]: train==[14.55298 = 0.46997 + 14.08301], recall= [ 0.02736  0.10440  0.16025  0.20861] , precision= [ 0.03074  0.02306  0.01827  0.01588] , auc=[0.82626], sum_recall=[0.50062]
Epoch 18 [34.1s + 13.8s]: train==[14.46620 = 0.45828 + 14.00793], recall= [ 0.02480  0.10384  0.15804  0.20475] , precision= [ 0.02733  0.02323  0.01819  0.01549] , auc=[0.82749], sum_recall=[0.49144]
Epoch 19 [34.1s + 12.0s]: train==[14.38403 = 0.46587 + 13.91816], recall= [ 0.02395  0.10014  0.15975  0.20603] , precision= [ 0.02647  0.02272  0.01836  0.01554] , auc=[0.82876], sum_recall=[0.48987]
Epoch 20 [45.4s + 13.1s]: train==[14.33689 = 0.46945 + 13.86744], recall= [ 0.02352  0.09673  0.15790  0.20205] , precision= [ 0.02647  0.02203  0.01810  0.01526] , auc=[0.82995], sum_recall=[0.48019]
Epoch 21 [34.4s + 11.7s]: train==[14.28400 = 0.46413 + 13.81987], recall= [ 0.02064  0.09833  0.15662  0.20205] , precision= [ 0.02220  0.02220  0.01793  0.01526] , auc=[0.83077], sum_recall=[0.47763]
Epoch 22 [33.1s + 11.8s]: train==[14.25120 = 0.46551 + 13.78570], recall= [ 0.02064  0.09483  0.15406  0.19880] , precision= [ 0.02220  0.02135  0.01768  0.01509] , auc=[0.83069], sum_recall=[0.46832]
Epoch 23 [33.7s + 13.3s]: train==[14.23221 = 0.46114 + 13.77107], recall= [ 0.02149  0.09589  0.14883  0.19539] , precision= [ 0.02306  0.02169  0.01708  0.01486] , auc=[0.83052], sum_recall=[0.46160]
Epoch 24 [34.2s + 12.5s]: train==[14.21288 = 0.44606 + 13.76682], recall= [ 0.01978  0.09333  0.14979  0.19325] , precision= [ 0.02135  0.02118  0.01725  0.01475] , auc=[0.83086], sum_recall=[0.45616]
Epoch 25 [33.4s + 12.5s]: train==[14.20492 = 0.44461 + 13.76031], recall= [ 0.02149  0.09504  0.14868  0.19710] , precision= [ 0.02306  0.02152  0.01716  0.01503] , auc=[0.83157], sum_recall=[0.46230]
Epoch 26 [33.7s + 13.5s]: train==[14.17937 = 0.44117 + 13.73821], recall= [ 0.01978  0.09589  0.15156  0.19895] , precision= [ 0.02135  0.02169  0.01742  0.01509] , auc=[0.83160], sum_recall=[0.46618]
Epoch 27 [34.1s + 14.1s]: train==[14.13999 = 0.40157 + 13.73842], recall= [ 0.01850  0.09717  0.15441  0.19969] , precision= [ 0.02050  0.02186  0.01768  0.01509] , auc=[0.83121], sum_recall=[0.46978]
Epoch 28 [34.3s + 14.3s]: train==[14.12523 = 0.39559 + 13.72964], recall= [ 0.01861  0.09604  0.15554  0.20550] , precision= [ 0.02135  0.02152  0.01768  0.01543] , auc=[0.83045], sum_recall=[0.47569]
Epoch 29 [34.3s + 14.4s]: train==[14.11063 = 0.37893 + 13.73169], recall= [ 0.02259  0.10201  0.15981  0.20774] , precision= [ 0.02647  0.02272  0.01810  0.01560] , auc=[0.82962], sum_recall=[0.49216]
Epoch 30 [34.4s + 13.4s]: train==[14.09194 = 0.37139 + 13.72055], recall= [ 0.02003  0.10329  0.16050  0.20707] , precision= [ 0.02391  0.02306  0.01810  0.01554] , auc=[0.82885], sum_recall=[0.49089]
Epoch 31 [35.2s + 12.5s]: train==[14.06469 = 0.33845 + 13.72624], recall= [ 0.02259  0.10500  0.16548  0.20963] , precision= [ 0.02647  0.02340  0.01862  0.01577] , auc=[0.82832], sum_recall=[0.50270]
Epoch 32 [34.1s + 12.9s]: train==[14.07061 = 0.34809 + 13.72252], recall= [ 0.02324  0.10500  0.16704  0.21034] , precision= [ 0.02733  0.02340  0.01870  0.01577] , auc=[0.82814], sum_recall=[0.50562]
Epoch 33 [33.8s + 13.1s]: train==[14.03834 = 0.32430 + 13.71404], recall= [ 0.02324  0.10458  0.16918  0.21057] , precision= [ 0.02733  0.02323  0.01887  0.01588] , auc=[0.82808], sum_recall=[0.50756]
Epoch 34 [33.6s + 11.6s]: train==[14.01428 = 0.30865 + 13.70563], recall= [ 0.02324  0.10201  0.17131  0.21085] , precision= [ 0.02733  0.02272  0.01921  0.01588] , auc=[0.82811], sum_recall=[0.50742]
Epoch 35 [32.8s + 11.9s]: train==[14.02081 = 0.30407 + 13.71675], recall= [ 0.02409  0.10500  0.16956  0.20872] , precision= [ 0.02818  0.02340  0.01896  0.01577] , auc=[0.82814], sum_recall=[0.50737]
Epoch 36 [32.9s + 12.4s]: train==[13.96597 = 0.27825 + 13.68771], recall= [ 0.02665  0.10671  0.17341  0.21099] , precision= [ 0.03074  0.02374  0.01939  0.01600] , auc=[0.82780], sum_recall=[0.51776]
End of trainning! Best recall= [ 0.01978  0.09589  0.15156  0.19895] , precision= [ 0.02135  0.02169  0.01742  0.01509] , auc=[0.83160]
test.sh: line 49: -gpu_id: command not found
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross1', dropout=0.3, emb_dim=200, gamma=0.7, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, type=3, weight=None)
2022-02-07 20:31:58
loading data...
[n_users, n_items]=[3209, 12211]
[n_train, n_test]=[2636, 1318]
[n_edges]=[280090]
Using GPU 0,  memory_free: 24265
tensor([ 0.0269,  0.0011,  0.0408,  0.0241, -0.0345], device='cuda:0')
Loading Model..Number of Model Parameters:  3324802
Epoch 0 [32.6s + 10.0s]: train==[20.66775 = 4.45108 + 16.21667], recall= [ 0.00085  0.00085  0.00085  0.00171] , precision= [ 0.00085  0.00017  0.00009  0.00011] , auc=[0.45642], sum_recall=[0.00427]
Epoch 1 [32.8s + 11.0s]: train==[18.00275 = 1.81068 + 16.19206], recall= [ 0.02541  0.07163  0.10795  0.13630] , precision= [ 0.02733  0.01588  0.01204  0.00996] , auc=[0.68899], sum_recall=[0.34128]
Epoch 2 [32.7s + 12.1s]: train==[17.24013 = 1.12431 + 16.11582], recall= [ 0.03242  0.08629  0.14194  0.17960] , precision= [ 0.03587  0.01913  0.01571  0.01327] , auc=[0.75840], sum_recall=[0.44024]
Epoch 3 [32.7s + 12.3s]: train==[16.89247 = 0.87072 + 16.02175], recall= [ 0.03487  0.09593  0.15054  0.19241] , precision= [ 0.03757  0.02067  0.01648  0.01418] , auc=[0.77882], sum_recall=[0.47375]
Epoch 4 [32.7s + 12.4s]: train==[16.65942 = 0.73731 + 15.92212], recall= [ 0.03359  0.09999  0.15407  0.18956] , precision= [ 0.03587  0.02152  0.01665  0.01378] , auc=[0.78828], sum_recall=[0.47721]
Epoch 5 [33.0s + 12.3s]: train==[16.48120 = 0.65845 + 15.82275], recall= [ 0.03274  0.09899  0.15603  0.19443] , precision= [ 0.03416  0.02135  0.01691  0.01429] , auc=[0.79463], sum_recall=[0.48218]
Epoch 6 [33.0s + 12.3s]: train==[16.33467 = 0.60700 + 15.72767], recall= [ 0.03117  0.09799  0.16132  0.19379] , precision= [ 0.03330  0.02118  0.01759  0.01423] , auc=[0.79919], sum_recall=[0.48427]
Epoch 7 [33.1s + 13.4s]: train==[16.22680 = 0.58553 + 15.64127], recall= [ 0.03373  0.09696  0.16168  0.19368] , precision= [ 0.03672  0.02101  0.01776  0.01418] , auc=[0.80290], sum_recall=[0.48605]
Epoch 8 [33.1s + 12.6s]: train==[16.12902 = 0.56502 + 15.56400], recall= [ 0.03288  0.09707  0.15869  0.19368] , precision= [ 0.03587  0.02101  0.01751  0.01418] , auc=[0.80635], sum_recall=[0.48232]
Epoch 9 [32.9s + 12.3s]: train==[16.01995 = 0.52976 + 15.49019], recall= [ 0.03373  0.09685  0.15954  0.19710] , precision= [ 0.03672  0.02084  0.01751  0.01440] , auc=[0.80941], sum_recall=[0.48723]
Epoch 10 [32.9s + 12.6s]: train==[15.89796 = 0.50389 + 15.39407], recall= [ 0.03174  0.09870  0.16345  0.19898] , precision= [ 0.03416  0.02152  0.01793  0.01475] , auc=[0.81216], sum_recall=[0.49287]
Epoch 11 [32.8s + 12.3s]: train==[15.71731 = 0.47936 + 15.23795], recall= [ 0.02918  0.10250  0.16541  0.20159] , precision= [ 0.03160  0.02254  0.01827  0.01486] , auc=[0.81452], sum_recall=[0.49869]
Epoch 12 [33.0s + 12.6s]: train==[15.46659 = 0.46377 + 15.00282], recall= [ 0.02918  0.10144  0.16954  0.20450] , precision= [ 0.03160  0.02220  0.01879  0.01503] , auc=[0.81634], sum_recall=[0.50465]
Epoch 13 [32.9s + 12.1s]: train==[15.16983 = 0.44809 + 14.72174], recall= [ 0.03003  0.10485  0.17004  0.20656] , precision= [ 0.03245  0.02289  0.01870  0.01526] , auc=[0.81760], sum_recall=[0.51149]
Epoch 14 [32.8s + 12.0s]: train==[14.90505 = 0.45640 + 14.44865], recall= [ 0.03174  0.10357  0.17054  0.20759] , precision= [ 0.03330  0.02254  0.01879  0.01537] , auc=[0.81836], sum_recall=[0.51344]
Epoch 15 [32.5s + 12.0s]: train==[14.73770 = 0.46144 + 14.27626], recall= [ 0.03174  0.10613  0.17105  0.20740] , precision= [ 0.03330  0.02306  0.01887  0.01531] , auc=[0.81887], sum_recall=[0.51633]
Epoch 16 [32.8s + 11.8s]: train==[14.62749 = 0.48365 + 14.14384], recall= [ 0.03003  0.10443  0.17162  0.20614] , precision= [ 0.03160  0.02272  0.01904  0.01537] , auc=[0.81972], sum_recall=[0.51222]
Epoch 17 [32.6s + 11.8s]: train==[14.52671 = 0.48200 + 14.04470], recall= [ 0.03089  0.10101  0.16778  0.20411] , precision= [ 0.03245  0.02203  0.01870  0.01537] , auc=[0.82078], sum_recall=[0.50379]
Epoch 18 [32.8s + 11.7s]: train==[14.43596 = 0.46765 + 13.96830], recall= [ 0.03003  0.10272  0.16639  0.20386] , precision= [ 0.03160  0.02237  0.01870  0.01543] , auc=[0.82206], sum_recall=[0.50300]
Epoch 19 [32.8s + 11.7s]: train==[14.36256 = 0.47640 + 13.88617], recall= [ 0.03110  0.10122  0.16420  0.20578] , precision= [ 0.03330  0.02220  0.01845  0.01560] , auc=[0.82316], sum_recall=[0.50230]
Epoch 20 [32.6s + 11.8s]: train==[14.32212 = 0.48195 + 13.84017], recall= [ 0.02768  0.10383  0.16313  0.19681] , precision= [ 0.03074  0.02272  0.01836  0.01497] , auc=[0.82366], sum_recall=[0.49145]
Epoch 21 [32.6s + 12.0s]: train==[14.28786 = 0.48133 + 13.80653], recall= [ 0.02683  0.09907  0.16089  0.19482] , precision= [ 0.02989  0.02203  0.01802  0.01480] , auc=[0.82349], sum_recall=[0.48161]
Epoch 22 [32.8s + 11.8s]: train==[14.25842 = 0.48050 + 13.77792], recall= [ 0.02683  0.09694  0.15747  0.19397] , precision= [ 0.02989  0.02152  0.01759  0.01475] , auc=[0.82310], sum_recall=[0.47521]
Epoch 23 [32.6s + 11.9s]: train==[14.23448 = 0.46648 + 13.76801], recall= [ 0.02441  0.09779  0.15463  0.19567] , precision= [ 0.02818  0.02169  0.01742  0.01486] , auc=[0.82250], sum_recall=[0.47250]
Epoch 24 [32.7s + 11.9s]: train==[14.20988 = 0.44930 + 13.76058], recall= [ 0.02612  0.09566  0.15270  0.19332] , precision= [ 0.02989  0.02135  0.01699  0.01469] , auc=[0.82247], sum_recall=[0.46781]
Epoch 25 [32.6s + 11.9s]: train==[14.21000 = 0.45566 + 13.75435], recall= [ 0.02676  0.09708  0.15505  0.19439] , precision= [ 0.02989  0.02152  0.01742  0.01469] , auc=[0.82279], sum_recall=[0.47328]
Epoch 26 [32.9s + 11.8s]: train==[14.18583 = 0.44549 + 13.74034], recall= [ 0.02633  0.09680  0.15779  0.19567] , precision= [ 0.02904  0.02169  0.01776  0.01480] , auc=[0.82300], sum_recall=[0.47659]
Epoch 27 [32.7s + 12.1s]: train==[14.14302 = 0.40435 + 13.73867], recall= [ 0.02790  0.10107  0.15960  0.19695] , precision= [ 0.02989  0.02254  0.01802  0.01492] , auc=[0.82323], sum_recall=[0.48552]
Epoch 28 [33.1s + 12.4s]: train==[14.13186 = 0.39854 + 13.73332], recall= [ 0.02790  0.10085  0.16330  0.19727] , precision= [ 0.02989  0.02237  0.01827  0.01492] , auc=[0.82302], sum_recall=[0.48933]
Epoch 29 [32.7s + 12.4s]: train==[14.11993 = 0.38123 + 13.73869], recall= [ 0.02704  0.10581  0.16579  0.19967] , precision= [ 0.02904  0.02357  0.01853  0.01503] , auc=[0.82283], sum_recall=[0.49831]
Epoch 30 [32.5s + 12.6s]: train==[14.09014 = 0.36692 + 13.72321], recall= [ 0.02733  0.10538  0.16963  0.20137] , precision= [ 0.02989  0.02340  0.01904  0.01514] , auc=[0.82276], sum_recall=[0.50371]
End of trainning! Best recall= [ 0.02768  0.10383  0.16313  0.19681] , precision= [ 0.03074  0.02272  0.01836  0.01497] , auc=[0.82366]
test.sh: line 49: -gpu_id: command not found
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross1', dropout=0.3, emb_dim=200, gamma=0.7, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, type=3, weight=None)
2022-02-07 20:55:15
loading data...
[n_users, n_items]=[3209, 12211]
[n_train, n_test]=[2636, 1318]
[n_edges]=[280090]
Using GPU 0,  memory_free: 24265
tensor([-0.0036, -0.0391,  0.0300,  0.0061, -0.0395], device='cuda:0')
Loading Model..Number of Model Parameters:  3324802
Epoch 0 [33.2s + 9.8s]: train==[20.67531 = 4.41216 + 16.26315], recall= [ 0.00000  0.00000  0.00000  0.00085] , precision= [ 0.00000  0.00000  0.00000  0.00006] , auc=[0.46489], sum_recall=[0.00085]
Epoch 1 [33.6s + 11.7s]: train==[18.04703 = 1.80957 + 16.23747], recall= [ 0.02306  0.08212  0.12400  0.13863] , precision= [ 0.02391  0.01793  0.01383  0.01025] , auc=[0.70506], sum_recall=[0.36781]
Epoch 2 [33.4s + 12.0s]: train==[17.27676 = 1.12329 + 16.15347], recall= [ 0.03003  0.10475  0.15162  0.17866] , precision= [ 0.03245  0.02289  0.01665  0.01298] , auc=[0.77221], sum_recall=[0.46506]
Epoch 3 [33.4s + 12.5s]: train==[16.91163 = 0.85853 + 16.05310], recall= [ 0.03074  0.09792  0.15663  0.19523] , precision= [ 0.03330  0.02152  0.01699  0.01418] , auc=[0.79202], sum_recall=[0.48053]
Epoch 4 [33.4s + 12.9s]: train==[16.67045 = 0.72225 + 15.94820], recall= [ 0.02818  0.10248  0.15909  0.19204] , precision= [ 0.03074  0.02254  0.01742  0.01401] , auc=[0.80054], sum_recall=[0.48178]
Epoch 5 [33.7s + 12.9s]: train==[16.49018 = 0.64725 + 15.84293], recall= [ 0.02875  0.09543  0.15788  0.19019] , precision= [ 0.03074  0.02101  0.01734  0.01389] , auc=[0.80535], sum_recall=[0.47225]
Epoch 6 [33.5s + 13.0s]: train==[16.34170 = 0.59847 + 15.74323], recall= [ 0.02904  0.09757  0.16414  0.19173] , precision= [ 0.03160  0.02135  0.01793  0.01412] , auc=[0.80909], sum_recall=[0.48247]
Epoch 7 [33.5s + 13.2s]: train==[16.23753 = 0.58456 + 15.65296], recall= [ 0.03032  0.09543  0.16263  0.19493] , precision= [ 0.03330  0.02084  0.01785  0.01435] , auc=[0.81291], sum_recall=[0.48331]
Epoch 8 [33.3s + 12.7s]: train==[16.13343 = 0.55780 + 15.57564], recall= [ 0.02861  0.09543  0.16433  0.19408] , precision= [ 0.03160  0.02084  0.01802  0.01429] , auc=[0.81623], sum_recall=[0.48245]
Epoch 9 [33.4s + 12.7s]: train==[16.03321 = 0.52582 + 15.50739], recall= [ 0.02818  0.10112  0.16718  0.19878] , precision= [ 0.03074  0.02186  0.01845  0.01457] , auc=[0.81921], sum_recall=[0.49526]
Epoch 10 [33.3s + 13.0s]: train==[15.93109 = 0.50171 + 15.42937], recall= [ 0.02605  0.10554  0.16862  0.20240] , precision= [ 0.02904  0.02289  0.01853  0.01492] , auc=[0.82181], sum_recall=[0.50260]
Epoch 11 [33.4s + 12.5s]: train==[15.79106 = 0.47671 + 15.31435], recall= [ 0.02605  0.10724  0.17054  0.20510] , precision= [ 0.02904  0.02323  0.01870  0.01520] , auc=[0.82384], sum_recall=[0.50893]
Epoch 12 [33.3s + 12.5s]: train==[15.59164 = 0.45582 + 15.13582], recall= [ 0.02605  0.10554  0.17438  0.20285] , precision= [ 0.02904  0.02289  0.01904  0.01497] , auc=[0.82531], sum_recall=[0.50881]
Epoch 13 [33.1s + 12.3s]: train==[15.32355 = 0.43631 + 14.88725], recall= [ 0.02434  0.10554  0.17420  0.20434] , precision= [ 0.02733  0.02289  0.01921  0.01503] , auc=[0.82592], sum_recall=[0.50842]
Epoch 14 [33.5s + 12.4s]: train==[15.04580 = 0.44546 + 14.60034], recall= [ 0.02519  0.10895  0.17602  0.20477] , precision= [ 0.02818  0.02374  0.01947  0.01509] , auc=[0.82598], sum_recall=[0.51493]
Epoch 15 [33.4s + 12.5s]: train==[14.81511 = 0.44105 + 14.37406], recall= [ 0.02946  0.10895  0.17335  0.20391] , precision= [ 0.03245  0.02374  0.01913  0.01503] , auc=[0.82605], sum_recall=[0.51568]
Epoch 16 [33.5s + 12.1s]: train==[14.67274 = 0.46103 + 14.21171], recall= [ 0.03032  0.10938  0.17329  0.20759] , precision= [ 0.03330  0.02374  0.01921  0.01537] , auc=[0.82655], sum_recall=[0.52057]
Epoch 17 [33.3s + 12.0s]: train==[14.56053 = 0.46384 + 14.09669], recall= [ 0.03288  0.10575  0.16902  0.20739] , precision= [ 0.03587  0.02306  0.01879  0.01549] , auc=[0.82743], sum_recall=[0.51504]
Epoch 18 [33.6s + 11.9s]: train==[14.46205 = 0.44558 + 14.01647], recall= [ 0.02861  0.10362  0.16863  0.20831] , precision= [ 0.03074  0.02272  0.01887  0.01554] , auc=[0.82866], sum_recall=[0.50917]
Epoch 19 [33.3s + 12.9s]: train==[14.39016 = 0.45767 + 13.93249], recall= [ 0.02690  0.10468  0.16696  0.20703] , precision= [ 0.02904  0.02306  0.01870  0.01549] , auc=[0.83016], sum_recall=[0.50557]
Epoch 20 [33.9s + 12.5s]: train==[14.33148 = 0.46531 + 13.86617], recall= [ 0.02605  0.10169  0.16280  0.20549] , precision= [ 0.02818  0.02237  0.01827  0.01543] , auc=[0.83145], sum_recall=[0.49603]
Epoch 21 [33.5s + 12.4s]: train==[14.27535 = 0.46688 + 13.80848], recall= [ 0.02498  0.09956  0.16141  0.20080] , precision= [ 0.02818  0.02186  0.01802  0.01514] , auc=[0.83240], sum_recall=[0.48674]
Epoch 22 [33.8s + 12.2s]: train==[14.22898 = 0.46005 + 13.76893], recall= [ 0.02469  0.09913  0.15569  0.19909] , precision= [ 0.02733  0.02169  0.01759  0.01503] , auc=[0.83277], sum_recall=[0.47860]
Epoch 23 [33.5s + 13.2s]: train==[14.20810 = 0.45789 + 13.75021], recall= [ 0.02299  0.09870  0.15341  0.19628] , precision= [ 0.02562  0.02169  0.01725  0.01469] , auc=[0.83279], sum_recall=[0.47138]
Epoch 24 [33.3s + 12.3s]: train==[14.18672 = 0.43915 + 13.74757], recall= [ 0.02299  0.09785  0.15426  0.19599] , precision= [ 0.02562  0.02152  0.01734  0.01480] , auc=[0.83232], sum_recall=[0.47109]
Epoch 25 [33.6s + 12.6s]: train==[14.18674 = 0.44600 + 13.74074], recall= [ 0.02412  0.09788  0.15341  0.19557] , precision= [ 0.02733  0.02152  0.01725  0.01480] , auc=[0.83217], sum_recall=[0.47098]
Epoch 26 [34.1s + 13.1s]: train==[14.15857 = 0.43829 + 13.72028], recall= [ 0.02412  0.10215  0.15476  0.19867] , precision= [ 0.02733  0.02237  0.01742  0.01492] , auc=[0.83203], sum_recall=[0.47970]
Epoch 27 [33.5s + 12.2s]: train==[14.12178 = 0.40207 + 13.71970], recall= [ 0.02412  0.10183  0.15882  0.20166] , precision= [ 0.02733  0.02254  0.01776  0.01520] , auc=[0.83146], sum_recall=[0.48643]
Epoch 28 [33.5s + 12.9s]: train==[14.10757 = 0.39741 + 13.71016], recall= [ 0.02754  0.10396  0.16437  0.20536] , precision= [ 0.03074  0.02306  0.01836  0.01543] , auc=[0.83075], sum_recall=[0.50123]
Epoch 29 [33.8s + 12.3s]: train==[14.08426 = 0.37492 + 13.70934], recall= [ 0.02896  0.10695  0.16955  0.20792] , precision= [ 0.03160  0.02374  0.01879  0.01554] , auc=[0.83018], sum_recall=[0.51339]
Epoch 30 [34.1s + 13.3s]: train==[14.06131 = 0.36410 + 13.69721], recall= [ 0.02918  0.10866  0.17040  0.20835] , precision= [ 0.03160  0.02408  0.01887  0.01554] , auc=[0.82964], sum_recall=[0.51659]
Epoch 31 [33.7s + 12.6s]: train==[14.03318 = 0.33535 + 13.69783], recall= [ 0.02747  0.11037  0.17160  0.20806] , precision= [ 0.02989  0.02442  0.01896  0.01549] , auc=[0.82899], sum_recall=[0.51750]
Epoch 32 [33.6s + 12.9s]: train==[14.03506 = 0.34395 + 13.69110], recall= [ 0.02847  0.11250  0.17160  0.20818] , precision= [ 0.03074  0.02477  0.01913  0.01554] , auc=[0.82848], sum_recall=[0.52075]
Epoch 33 [33.8s + 13.0s]: train==[13.99980 = 0.32360 + 13.67620], recall= [ 0.02829  0.11136  0.17259  0.20804] , precision= [ 0.03074  0.02425  0.01913  0.01549] , auc=[0.82823], sum_recall=[0.52029]
End of trainning! Best recall= [ 0.02299  0.09870  0.15341  0.19628] , precision= [ 0.02562  0.02169  0.01725  0.01469] , auc=[0.83279]
test.sh: line 49: -gpu_id: command not found
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross1', dropout=0.3, emb_dim=200, gamma=0.8, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, type=3, weight=None)
2022-02-07 21:21:26
loading data...
[n_users, n_items]=[3209, 12211]
[n_train, n_test]=[2636, 1318]
[n_edges]=[280090]
Using GPU 0,  memory_free: 24265
tensor([-0.0288,  0.0176, -0.0101,  0.0343, -0.0268], device='cuda:0')
Loading Model..Number of Model Parameters:  3324802
Epoch 0 [32.6s + 10.2s]: train==[22.98608 = 4.43107 + 18.55501], recall= [ 0.00000  0.00085  0.00171  0.00171] , precision= [ 0.00000  0.00017  0.00017  0.00011] , auc=[0.45016], sum_recall=[0.00427]
Epoch 1 [32.9s + 11.6s]: train==[20.30441 = 1.78465 + 18.51976], recall= [ 0.02092  0.06960  0.10546  0.13976] , precision= [ 0.02220  0.01520  0.01187  0.01030] , auc=[0.70413], sum_recall=[0.33574]
Epoch 2 [33.3s + 12.6s]: train==[19.52567 = 1.10647 + 18.41920], recall= [ 0.02370  0.09023  0.14759  0.18215] , precision= [ 0.02562  0.02032  0.01682  0.01378] , auc=[0.77088], sum_recall=[0.44366]
Epoch 3 [33.0s + 12.9s]: train==[19.16315 = 0.86613 + 18.29701], recall= [ 0.02968  0.09304  0.15655  0.19770] , precision= [ 0.03245  0.02118  0.01768  0.01480] , auc=[0.79006], sum_recall=[0.47697]
Epoch 4 [32.9s + 13.2s]: train==[18.90233 = 0.73291 + 18.16943], recall= [ 0.02953  0.09276  0.15413  0.20151] , precision= [ 0.03245  0.02067  0.01716  0.01492] , auc=[0.79792], sum_recall=[0.47793]
Epoch 5 [32.8s + 13.3s]: train==[18.70560 = 0.66034 + 18.04526], recall= [ 0.02412  0.09276  0.15028  0.19896] , precision= [ 0.02562  0.02067  0.01674  0.01475] , auc=[0.80267], sum_recall=[0.46613]
Epoch 6 [33.3s + 14.4s]: train==[18.54959 = 0.61650 + 17.93309], recall= [ 0.02597  0.09421  0.15085  0.20448] , precision= [ 0.02818  0.02084  0.01691  0.01509] , auc=[0.80631], sum_recall=[0.47552]
Epoch 7 [32.9s + 12.8s]: train==[18.43083 = 0.59565 + 17.83518], recall= [ 0.02683  0.09724  0.15171  0.20477] , precision= [ 0.02904  0.02152  0.01699  0.01520] , auc=[0.80964], sum_recall=[0.48054]
Epoch 8 [32.9s + 13.1s]: train==[18.33345 = 0.58101 + 17.75244], recall= [ 0.02704  0.09439  0.15797  0.20744] , precision= [ 0.02904  0.02118  0.01768  0.01560] , auc=[0.81262], sum_recall=[0.48684]
Epoch 9 [33.3s + 13.4s]: train==[18.21602 = 0.54249 + 17.67353], recall= [ 0.02875  0.09791  0.15718  0.20999] , precision= [ 0.03074  0.02203  0.01759  0.01577] , auc=[0.81513], sum_recall=[0.49383]
Epoch 10 [33.1s + 13.1s]: train==[18.07835 = 0.51601 + 17.56234], recall= [ 0.02790  0.10076  0.15786  0.21292] , precision= [ 0.02989  0.02272  0.01759  0.01605] , auc=[0.81763], sum_recall=[0.49944]
Epoch 11 [32.9s + 12.3s]: train==[17.87266 = 0.49360 + 17.37906], recall= [ 0.02989  0.09991  0.16223  0.21418] , precision= [ 0.03245  0.02254  0.01836  0.01600] , auc=[0.81956], sum_recall=[0.50621]
Epoch 12 [32.3s + 11.9s]: train==[17.55944 = 0.47791 + 17.08153], recall= [ 0.02904  0.09884  0.16377  0.21236] , precision= [ 0.03160  0.02237  0.01845  0.01583] , auc=[0.82067], sum_recall=[0.50401]
Epoch 13 [32.3s + 13.1s]: train==[17.20142 = 0.46560 + 16.73582], recall= [ 0.02818  0.09905  0.16740  0.21001] , precision= [ 0.03074  0.02237  0.01887  0.01577] , auc=[0.82102], sum_recall=[0.50465]
Epoch 14 [32.6s + 13.0s]: train==[16.89145 = 0.46972 + 16.42173], recall= [ 0.02818  0.10119  0.16800  0.20946] , precision= [ 0.03074  0.02306  0.01904  0.01583] , auc=[0.82100], sum_recall=[0.50683]
Epoch 15 [32.7s + 11.9s]: train==[16.71045 = 0.47772 + 16.23273], recall= [ 0.02775  0.10282  0.16458  0.20502] , precision= [ 0.03074  0.02340  0.01870  0.01549] , auc=[0.82083], sum_recall=[0.50017]
Epoch 16 [32.6s + 11.9s]: train==[16.59374 = 0.49672 + 16.09702], recall= [ 0.02818  0.10431  0.16407  0.20369] , precision= [ 0.03074  0.02357  0.01870  0.01549] , auc=[0.82118], sum_recall=[0.50026]
Epoch 17 [32.7s + 11.8s]: train==[16.48890 = 0.50170 + 15.98719], recall= [ 0.02839  0.09876  0.16393  0.20085] , precision= [ 0.03160  0.02254  0.01862  0.01537] , auc=[0.82160], sum_recall=[0.49193]
Epoch 18 [32.5s + 11.7s]: train==[16.38907 = 0.48253 + 15.90654], recall= [ 0.02412  0.09485  0.15774  0.19750] , precision= [ 0.02733  0.02152  0.01802  0.01514] , auc=[0.82207], sum_recall=[0.47421]
Epoch 19 [32.5s + 11.8s]: train==[16.32194 = 0.49835 + 15.82358], recall= [ 0.02327  0.09143  0.15509  0.19772] , precision= [ 0.02647  0.02084  0.01776  0.01520] , auc=[0.82240], sum_recall=[0.46751]
Epoch 20 [32.6s + 11.7s]: train==[16.28625 = 0.50582 + 15.78044], recall= [ 0.01985  0.08602  0.15096  0.19498] , precision= [ 0.02306  0.01998  0.01742  0.01497] , auc=[0.82241], sum_recall=[0.45182]
Epoch 21 [32.3s + 11.9s]: train==[16.24738 = 0.50097 + 15.74641], recall= [ 0.01985  0.08474  0.14573  0.19157] , precision= [ 0.02306  0.01981  0.01674  0.01475] , auc=[0.82209], sum_recall=[0.44190]
Epoch 22 [32.5s + 11.9s]: train==[16.22186 = 0.50165 + 15.72021], recall= [ 0.01900  0.08346  0.14509  0.18986] , precision= [ 0.02220  0.01947  0.01674  0.01463] , auc=[0.82206], sum_recall=[0.43741]
Epoch 23 [32.5s + 11.9s]: train==[16.19556 = 0.49139 + 15.70417], recall= [ 0.02156  0.08731  0.14402  0.18858] , precision= [ 0.02477  0.02032  0.01657  0.01446] , auc=[0.82220], sum_recall=[0.44147]
Epoch 24 [32.4s + 12.1s]: train==[16.16753 = 0.46561 + 15.70191], recall= [ 0.02242  0.08944  0.14197  0.18762] , precision= [ 0.02562  0.02084  0.01640  0.01435] , auc=[0.82251], sum_recall=[0.44145]
Epoch 25 [32.5s + 11.9s]: train==[16.16864 = 0.47537 + 15.69326], recall= [ 0.02220  0.09015  0.14411  0.19132] , precision= [ 0.02477  0.02101  0.01657  0.01457] , auc=[0.82317], sum_recall=[0.44778]
Epoch 26 [32.7s + 11.9s]: train==[16.14609 = 0.46273 + 15.68336], recall= [ 0.02220  0.09343  0.14717  0.18987] , precision= [ 0.02477  0.02152  0.01691  0.01440] , auc=[0.82404], sum_recall=[0.45266]
Epoch 27 [32.4s + 13.7s]: train==[16.10056 = 0.42103 + 15.67953], recall= [ 0.02306  0.09044  0.14952  0.19286] , precision= [ 0.02562  0.02084  0.01708  0.01463] , auc=[0.82463], sum_recall=[0.45587]
Epoch 28 [32.4s + 12.3s]: train==[16.08361 = 0.41448 + 15.66913], recall= [ 0.02391  0.09364  0.15464  0.19513] , precision= [ 0.02647  0.02135  0.01759  0.01475] , auc=[0.82457], sum_recall=[0.46732]
Epoch 29 [32.4s + 12.0s]: train==[16.06956 = 0.39393 + 15.67563], recall= [ 0.02391  0.09449  0.15806  0.19613] , precision= [ 0.02647  0.02152  0.01793  0.01486] , auc=[0.82433], sum_recall=[0.47259]
Epoch 30 [32.5s + 12.1s]: train==[16.03648 = 0.38063 + 15.65585], recall= [ 0.02391  0.09663  0.16169  0.19720] , precision= [ 0.02647  0.02203  0.01819  0.01497] , auc=[0.82402], sum_recall=[0.47942]
Epoch 31 [32.7s + 12.6s]: train==[16.01974 = 0.35184 + 15.66790], recall= [ 0.02562  0.09464  0.16532  0.19784] , precision= [ 0.02818  0.02152  0.01870  0.01497] , auc=[0.82360], sum_recall=[0.48341]
Epoch 32 [32.4s + 12.1s]: train==[16.02096 = 0.36331 + 15.65764], recall= [ 0.02498  0.09506  0.16724  0.19990] , precision= [ 0.02818  0.02169  0.01904  0.01520] , auc=[0.82319], sum_recall=[0.48718]
Epoch 33 [32.4s + 12.0s]: train==[15.98884 = 0.33777 + 15.65107], recall= [ 0.02398  0.09919  0.16468  0.20296] , precision= [ 0.02647  0.02237  0.01879  0.01526] , auc=[0.82304], sum_recall=[0.49081]
Epoch 34 [32.7s + 11.8s]: train==[15.96812 = 0.32318 + 15.64494], recall= [ 0.02498  0.09962  0.16446  0.20232] , precision= [ 0.02733  0.02237  0.01870  0.01526] , auc=[0.82290], sum_recall=[0.49138]
Epoch 35 [32.6s + 12.0s]: train==[15.95747 = 0.31538 + 15.64210], recall= [ 0.02594  0.09962  0.16403  0.20360] , precision= [ 0.02904  0.02237  0.01870  0.01537] , auc=[0.82302], sum_recall=[0.49319]
Epoch 36 [32.5s + 11.6s]: train==[15.91370 = 0.29033 + 15.62336], recall= [ 0.02594  0.09962  0.16375  0.20710] , precision= [ 0.02904  0.02237  0.01862  0.01566] , auc=[0.82321], sum_recall=[0.49641]
Epoch 37 [32.3s + 11.7s]: train==[15.91826 = 0.28734 + 15.63092], recall= [ 0.02679  0.10033  0.16354  0.20894] , precision= [ 0.02989  0.02254  0.01853  0.01571] , auc=[0.82328], sum_recall=[0.49960]
End of trainning! Best recall= [ 0.02306  0.09044  0.14952  0.19286] , precision= [ 0.02562  0.02084  0.01708  0.01463] , auc=[0.82463]
test.sh: line 49: -gpu_id: command not found
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross1', dropout=0.3, emb_dim=200, gamma=0.8, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, type=3, weight=None)
2022-02-07 21:50:01
loading data...
[n_users, n_items]=[3209, 12211]
[n_train, n_test]=[2636, 1318]
[n_edges]=[280090]
Using GPU 0,  memory_free: 24265
tensor([-0.0207,  0.0248,  0.0404, -0.0203,  0.0282], device='cuda:0')
Loading Model..Number of Model Parameters:  3324802
Epoch 0 [32.6s + 9.7s]: train==[22.92273 = 4.40978 + 18.51295], recall= [ 0.00000  0.00000  0.00000  0.00000] , precision= [ 0.00000  0.00000  0.00000  0.00000] , auc=[0.43956], sum_recall=[0.00000]
Epoch 1 [32.9s + 11.0s]: train==[20.33488 = 1.85054 + 18.48434], recall= [ 0.01921  0.07074  0.10276  0.12507] , precision= [ 0.02220  0.01537  0.01119  0.00911] , auc=[0.67933], sum_recall=[0.31778]
Epoch 2 [33.5s + 12.7s]: train==[19.50355 = 1.11308 + 18.39047], recall= [ 0.02277  0.08849  0.14852  0.18268] , precision= [ 0.02477  0.01947  0.01631  0.01327] , auc=[0.76737], sum_recall=[0.44246]
Epoch 3 [33.1s + 11.8s]: train==[19.14254 = 0.86289 + 18.27965], recall= [ 0.02092  0.09479  0.15827  0.19410] , precision= [ 0.02220  0.02050  0.01734  0.01418] , auc=[0.78959], sum_recall=[0.46808]
Epoch 4 [33.5s + 11.9s]: train==[18.89571 = 0.73167 + 18.16404], recall= [ 0.02590  0.10056  0.15731  0.19912] , precision= [ 0.02818  0.02152  0.01716  0.01446] , auc=[0.79747], sum_recall=[0.48288]
Epoch 5 [33.5s + 12.1s]: train==[18.71734 = 0.66756 + 18.04978], recall= [ 0.02633  0.10166  0.16343  0.19919] , precision= [ 0.02818  0.02203  0.01785  0.01452] , auc=[0.80262], sum_recall=[0.49061]
Epoch 6 [33.1s + 12.0s]: train==[18.55945 = 0.61565 + 17.94380], recall= [ 0.02690  0.10621  0.16450  0.20004] , precision= [ 0.02818  0.02306  0.01802  0.01457] , auc=[0.80645], sum_recall=[0.49765]
Epoch 7 [33.3s + 12.0s]: train==[18.44931 = 0.60080 + 17.84852], recall= [ 0.02434  0.10365  0.16734  0.20022] , precision= [ 0.02562  0.02254  0.01827  0.01463] , auc=[0.80951], sum_recall=[0.49555]
Epoch 8 [33.3s + 12.1s]: train==[18.34341 = 0.57819 + 17.76522], recall= [ 0.02391  0.10365  0.17019  0.20306] , precision= [ 0.02477  0.02254  0.01870  0.01492] , auc=[0.81255], sum_recall=[0.50081]
Epoch 9 [33.2s + 11.9s]: train==[18.23001 = 0.54541 + 17.68460], recall= [ 0.02676  0.10109  0.17339  0.20648] , precision= [ 0.02818  0.02203  0.01896  0.01514] , auc=[0.81546], sum_recall=[0.50771]
Epoch 10 [33.2s + 12.3s]: train==[18.08969 = 0.51702 + 17.57268], recall= [ 0.02576  0.10123  0.17425  0.20635] , precision= [ 0.02733  0.02220  0.01904  0.01514] , auc=[0.81822], sum_recall=[0.50759]
Epoch 11 [33.2s + 13.5s]: train==[17.87900 = 0.48873 + 17.39027], recall= [ 0.02832  0.10209  0.17510  0.20652] , precision= [ 0.02989  0.02237  0.01913  0.01526] , auc=[0.82046], sum_recall=[0.51203]
Epoch 12 [33.2s + 12.4s]: train==[17.58345 = 0.47725 + 17.10620], recall= [ 0.02662  0.10241  0.17792  0.20702] , precision= [ 0.02818  0.02237  0.01956  0.01537] , auc=[0.82208], sum_recall=[0.51396]
Epoch 13 [33.2s + 12.5s]: train==[17.21791 = 0.46120 + 16.75671], recall= [ 0.03003  0.10152  0.17802  0.21111] , precision= [ 0.03160  0.02254  0.01973  0.01566] , auc=[0.82298], sum_recall=[0.52068]
Epoch 14 [33.1s + 12.4s]: train==[16.92324 = 0.47237 + 16.45087], recall= [ 0.02960  0.10066  0.17995  0.20981] , precision= [ 0.03160  0.02237  0.01998  0.01560] , auc=[0.82352], sum_recall=[0.52002]
Epoch 15 [32.9s + 12.3s]: train==[16.72730 = 0.47898 + 16.24832], recall= [ 0.02989  0.10547  0.17098  0.21023] , precision= [ 0.03245  0.02357  0.01904  0.01566] , auc=[0.82428], sum_recall=[0.51657]
Epoch 16 [33.1s + 12.5s]: train==[16.60192 = 0.49879 + 16.10313], recall= [ 0.02818  0.10490  0.16756  0.20656] , precision= [ 0.03074  0.02323  0.01879  0.01543] , auc=[0.82535], sum_recall=[0.50720]
Epoch 17 [32.9s + 12.5s]: train==[16.50344 = 0.50225 + 16.00119], recall= [ 0.02647  0.10020  0.16432  0.20400] , precision= [ 0.02904  0.02237  0.01853  0.01526] , auc=[0.82656], sum_recall=[0.49499]
Epoch 18 [32.9s + 12.3s]: train==[16.40215 = 0.49056 + 15.91159], recall= [ 0.02348  0.10020  0.16275  0.20357] , precision= [ 0.02562  0.02237  0.01836  0.01526] , auc=[0.82780], sum_recall=[0.49001]
Epoch 19 [33.0s + 12.2s]: train==[16.32141 = 0.49854 + 15.82287], recall= [ 0.02434  0.09949  0.15635  0.19759] , precision= [ 0.02647  0.02237  0.01768  0.01486] , auc=[0.82872], sum_recall=[0.47777]
Epoch 20 [33.0s + 12.3s]: train==[16.28371 = 0.50688 + 15.77682], recall= [ 0.02605  0.09735  0.15296  0.19567] , precision= [ 0.02818  0.02186  0.01725  0.01475] , auc=[0.82937], sum_recall=[0.47203]
Epoch 21 [32.9s + 12.2s]: train==[16.24923 = 0.50856 + 15.74067], recall= [ 0.02434  0.09212  0.14980  0.19226] , precision= [ 0.02647  0.02050  0.01708  0.01457] , auc=[0.82968], sum_recall=[0.45852]
Epoch 22 [32.9s + 12.2s]: train==[16.22153 = 0.50679 + 15.71474], recall= [ 0.02405  0.09041  0.14845  0.18833] , precision= [ 0.02562  0.02015  0.01691  0.01423] , auc=[0.82999], sum_recall=[0.45125]
Epoch 23 [33.1s + 12.7s]: train==[16.20064 = 0.49732 + 15.70332], recall= [ 0.02277  0.08956  0.14589  0.18470] , precision= [ 0.02477  0.01998  0.01674  0.01401] , auc=[0.83028], sum_recall=[0.44292]
Epoch 24 [33.1s + 12.3s]: train==[16.17965 = 0.48115 + 15.69850], recall= [ 0.02277  0.09255  0.14674  0.18222] , precision= [ 0.02477  0.02067  0.01682  0.01389] , auc=[0.83037], sum_recall=[0.44429]
Epoch 25 [32.9s + 12.4s]: train==[16.17536 = 0.47960 + 15.69577], recall= [ 0.02320  0.09184  0.14731  0.18286] , precision= [ 0.02477  0.02050  0.01682  0.01395] , auc=[0.83065], sum_recall=[0.44521]
Epoch 26 [33.0s + 12.5s]: train==[16.15177 = 0.47039 + 15.68138], recall= [ 0.02605  0.09471  0.14909  0.19055] , precision= [ 0.02818  0.02135  0.01691  0.01446] , auc=[0.83085], sum_recall=[0.46040]
Epoch 27 [33.1s + 12.7s]: train==[16.10372 = 0.42855 + 15.67517], recall= [ 0.02690  0.09962  0.14973  0.19546] , precision= [ 0.02904  0.02254  0.01708  0.01475] , auc=[0.83067], sum_recall=[0.47171]
Epoch 28 [33.1s + 13.2s]: train==[16.08336 = 0.42320 + 15.66017], recall= [ 0.02861  0.10318  0.15336  0.19717] , precision= [ 0.03074  0.02323  0.01751  0.01486] , auc=[0.83017], sum_recall=[0.48232]
Epoch 29 [33.0s + 12.6s]: train==[16.07980 = 0.40714 + 15.67266], recall= [ 0.02775  0.10731  0.15633  0.19802] , precision= [ 0.02989  0.02391  0.01776  0.01492] , auc=[0.82957], sum_recall=[0.48941]
Epoch 30 [33.1s + 12.7s]: train==[16.04642 = 0.39065 + 15.65577], recall= [ 0.03032  0.10778  0.16017  0.20229] , precision= [ 0.03245  0.02408  0.01802  0.01520] , auc=[0.82921], sum_recall=[0.50056]
Epoch 31 [33.0s + 12.5s]: train==[16.02332 = 0.35833 + 15.66499], recall= [ 0.03174  0.10778  0.16113  0.20400] , precision= [ 0.03330  0.02408  0.01819  0.01531] , auc=[0.82896], sum_recall=[0.50465]
Epoch 32 [33.0s + 12.5s]: train==[16.03415 = 0.37013 + 15.66403], recall= [ 0.03131  0.10778  0.16455  0.20656] , precision= [ 0.03330  0.02408  0.01853  0.01549] , auc=[0.82897], sum_recall=[0.51020]
Epoch 33 [33.2s + 12.4s]: train==[15.99439 = 0.34530 + 15.64909], recall= [ 0.03131  0.10479  0.16786  0.20703] , precision= [ 0.03330  0.02340  0.01879  0.01554] , auc=[0.82926], sum_recall=[0.51099]
Epoch 34 [33.2s + 12.9s]: train==[15.97447 = 0.32497 + 15.64949], recall= [ 0.03003  0.10714  0.16529  0.20852] , precision= [ 0.03245  0.02374  0.01853  0.01566] , auc=[0.82964], sum_recall=[0.51098]
Epoch 35 [33.1s + 12.6s]: train==[15.97056 = 0.32205 + 15.64850], recall= [ 0.03089  0.10700  0.16636  0.21080] , precision= [ 0.03330  0.02357  0.01870  0.01577] , auc=[0.83003], sum_recall=[0.51504]
Epoch 36 [33.1s + 12.5s]: train==[15.92862 = 0.29372 + 15.63490], recall= [ 0.02918  0.10856  0.16790  0.21122] , precision= [ 0.03160  0.02374  0.01879  0.01583] , auc=[0.83007], sum_recall=[0.51686]
End of trainning! Best recall= [ 0.02605  0.09471  0.14909  0.19055] , precision= [ 0.02818  0.02135  0.01691  0.01446] , auc=[0.83085]
test.sh: line 49: -gpu_id: command not found
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross1', dropout=0.3, emb_dim=200, gamma=0.8, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, type=3, weight=None)
2022-02-07 22:18:08
loading data...
[n_users, n_items]=[3209, 12211]
[n_train, n_test]=[2636, 1318]
[n_edges]=[280090]
Using GPU 0,  memory_free: 24265
tensor([ 0.0417, -0.0145,  0.0243, -0.0390,  0.0315], device='cuda:0')
Loading Model..Number of Model Parameters:  3324802
Epoch 0 [32.5s + 10.3s]: train==[22.96845 = 4.46110 + 18.50735], recall= [ 0.00000  0.00000  0.00000  0.00000] , precision= [ 0.00000  0.00000  0.00000  0.00000] , auc=[0.45030], sum_recall=[0.00000]
Epoch 1 [32.6s + 12.2s]: train==[20.31471 = 1.82995 + 18.48477], recall= [ 0.01751  0.07119  0.10535  0.12812] , precision= [ 0.01964  0.01588  0.01153  0.00928] , auc=[0.68423], sum_recall=[0.32217]
Epoch 2 [32.8s + 12.9s]: train==[19.51073 = 1.12247 + 18.38827], recall= [ 0.02320  0.09607  0.15207  0.18904] , precision= [ 0.02562  0.02101  0.01674  0.01378] , auc=[0.76300], sum_recall=[0.46038]
Epoch 3 [33.0s + 13.2s]: train==[19.13316 = 0.85844 + 18.27472], recall= [ 0.02619  0.09415  0.16428  0.19527] , precision= [ 0.02904  0.02050  0.01802  0.01429] , auc=[0.78589], sum_recall=[0.47990]
Epoch 4 [32.8s + 13.5s]: train==[18.88164 = 0.72364 + 18.15799], recall= [ 0.02946  0.09629  0.16201  0.19527] , precision= [ 0.03074  0.02084  0.01776  0.01429] , auc=[0.79512], sum_recall=[0.48303]
Epoch 5 [32.8s + 13.5s]: train==[18.69565 = 0.65160 + 18.04405], recall= [ 0.02861  0.09778  0.15987  0.19485] , precision= [ 0.02989  0.02135  0.01759  0.01429] , auc=[0.80023], sum_recall=[0.48111]
Epoch 6 [32.8s + 13.9s]: train==[18.54530 = 0.60589 + 17.93941], recall= [ 0.02434  0.10056  0.16218  0.19111] , precision= [ 0.02562  0.02203  0.01776  0.01418] , auc=[0.80352], sum_recall=[0.47818]
Epoch 7 [33.8s + 18.7s]: train==[18.44188 = 0.59518 + 17.84669], recall= [ 0.02605  0.09899  0.16156  0.19025] , precision= [ 0.02733  0.02186  0.01785  0.01412] , auc=[0.80644], sum_recall=[0.47685]
Epoch 8 [33.7s + 14.5s]: train==[18.34224 = 0.57353 + 17.76871], recall= [ 0.02633  0.10219  0.16497  0.19452] , precision= [ 0.02818  0.02237  0.01819  0.01440] , auc=[0.80923], sum_recall=[0.48802]
Epoch 9 [33.2s + 13.3s]: train==[18.23769 = 0.53789 + 17.69981], recall= [ 0.02605  0.10433  0.16344  0.19948] , precision= [ 0.02733  0.02272  0.01802  0.01486] , auc=[0.81166], sum_recall=[0.49329]
Epoch 10 [33.2s + 14.0s]: train==[18.12973 = 0.51523 + 17.61450], recall= [ 0.02733  0.10165  0.16333  0.20410] , precision= [ 0.02904  0.02220  0.01802  0.01526] , auc=[0.81419], sum_recall=[0.49641]
Epoch 11 [35.3s + 18.1s]: train==[17.96424 = 0.48354 + 17.48071], recall= [ 0.02818  0.10250  0.16100  0.20353] , precision= [ 0.02989  0.02237  0.01793  0.01514] , auc=[0.81647], sum_recall=[0.49521]
Epoch 12 [34.1s + 18.4s]: train==[17.72570 = 0.46771 + 17.25800], recall= [ 0.02904  0.10507  0.16226  0.20488] , precision= [ 0.03074  0.02289  0.01802  0.01526] , auc=[0.81818], sum_recall=[0.50124]
Epoch 13 [33.2s + 18.1s]: train==[17.40018 = 0.44902 + 16.95116], recall= [ 0.02918  0.10357  0.16497  0.20486] , precision= [ 0.03160  0.02254  0.01836  0.01531] , auc=[0.81909], sum_recall=[0.50258]
Epoch 14 [33.4s + 17.2s]: train==[17.07786 = 0.45566 + 16.62220], recall= [ 0.02918  0.10656  0.16676  0.20329] , precision= [ 0.03160  0.02323  0.01862  0.01526] , auc=[0.81945], sum_recall=[0.50579]
Epoch 15 [34.3s + 17.2s]: train==[16.83251 = 0.45813 + 16.37438], recall= [ 0.02832  0.10283  0.16430  0.20500] , precision= [ 0.03074  0.02254  0.01845  0.01537] , auc=[0.81953], sum_recall=[0.50046]
Epoch 16 [35.0s + 18.3s]: train==[16.67968 = 0.47842 + 16.20126], recall= [ 0.02989  0.10453  0.16739  0.20834] , precision= [ 0.03245  0.02289  0.01887  0.01566] , auc=[0.81996], sum_recall=[0.51016]
Epoch 17 [33.9s + 18.0s]: train==[16.56063 = 0.48573 + 16.07491], recall= [ 0.03032  0.10539  0.16658  0.20791] , precision= [ 0.03245  0.02306  0.01879  0.01560] , auc=[0.82077], sum_recall=[0.51020]
Epoch 18 [33.4s + 18.6s]: train==[16.45196 = 0.46973 + 15.98224], recall= [ 0.03032  0.10581  0.16516  0.20535] , precision= [ 0.03245  0.02323  0.01853  0.01543] , auc=[0.82179], sum_recall=[0.50664]
Epoch 19 [33.5s + 17.6s]: train==[16.35894 = 0.48519 + 15.87375], recall= [ 0.03074  0.10311  0.16476  0.19866] , precision= [ 0.03330  0.02272  0.01862  0.01497] , auc=[0.82279], sum_recall=[0.49727]
Epoch 20 [33.7s + 17.3s]: train==[16.30764 = 0.49326 + 15.81438], recall= [ 0.02647  0.10460  0.15909  0.19268] , precision= [ 0.02904  0.02323  0.01785  0.01463] , auc=[0.82344], sum_recall=[0.48286]
Epoch 21 [33.2s + 17.0s]: train==[16.25624 = 0.49405 + 15.76219], recall= [ 0.02477  0.10290  0.15468  0.18970] , precision= [ 0.02733  0.02289  0.01742  0.01440] , auc=[0.82331], sum_recall=[0.47204]
Epoch 22 [33.8s + 17.7s]: train==[16.21845 = 0.48999 + 15.72847], recall= [ 0.02605  0.10033  0.15300  0.18884] , precision= [ 0.02818  0.02237  0.01734  0.01435] , auc=[0.82254], sum_recall=[0.46823]
Epoch 23 [34.2s + 18.0s]: train==[16.20380 = 0.49266 + 15.71114], recall= [ 0.02348  0.09948  0.14735  0.18607] , precision= [ 0.02562  0.02220  0.01665  0.01418] , auc=[0.82228], sum_recall=[0.45638]
Epoch 24 [33.4s + 16.1s]: train==[16.17188 = 0.46808 + 15.70380], recall= [ 0.02178  0.10033  0.14973  0.18521] , precision= [ 0.02391  0.02237  0.01691  0.01412] , auc=[0.82247], sum_recall=[0.45705]
Epoch 25 [33.7s + 17.4s]: train==[16.17823 = 0.47933 + 15.69890], recall= [ 0.02178  0.09978  0.15204  0.18905] , precision= [ 0.02391  0.02254  0.01699  0.01435] , auc=[0.82261], sum_recall=[0.46265]
Epoch 26 [33.8s + 17.0s]: train==[16.14713 = 0.46795 + 15.67917], recall= [ 0.02263  0.09858  0.15384  0.18777] , precision= [ 0.02477  0.02220  0.01725  0.01418] , auc=[0.82307], sum_recall=[0.46282]
Epoch 27 [33.9s + 18.1s]: train==[16.10153 = 0.42411 + 15.67742], recall= [ 0.02263  0.10086  0.15569  0.19290] , precision= [ 0.02477  0.02254  0.01751  0.01452] , auc=[0.82338], sum_recall=[0.47208]
Epoch 28 [33.6s + 17.6s]: train==[16.08985 = 0.42401 + 15.66583], recall= [ 0.02519  0.10001  0.15953  0.19567] , precision= [ 0.02733  0.02237  0.01785  0.01469] , auc=[0.82322], sum_recall=[0.48040]
Epoch 29 [33.4s + 17.8s]: train==[16.07410 = 0.40301 + 15.67109], recall= [ 0.02605  0.10029  0.15996  0.20122] , precision= [ 0.02818  0.02254  0.01785  0.01514] , auc=[0.82291], sum_recall=[0.48752]
Epoch 30 [33.4s + 17.5s]: train==[16.04115 = 0.38628 + 15.65486], recall= [ 0.02644  0.10371  0.16536  0.19913] , precision= [ 0.02904  0.02323  0.01836  0.01492] , auc=[0.82248], sum_recall=[0.49464]
End of trainning! Best recall= [ 0.02647  0.10460  0.15909  0.19268] , precision= [ 0.02904  0.02323  0.01785  0.01463] , auc=[0.82344]
test.sh: line 49: -gpu_id: command not found
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross1', dropout=0.3, emb_dim=200, gamma=0.9, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, type=3, weight=None)
2022-02-07 22:44:03
loading data...
[n_users, n_items]=[3209, 12211]
[n_train, n_test]=[2636, 1318]
[n_edges]=[280090]
Using GPU 0,  memory_free: 24265
tensor([ 0.0185,  0.0207, -0.0324,  0.0372, -0.0177], device='cuda:0')
Loading Model..Number of Model Parameters:  3324802
Epoch 0 [32.7s + 9.7s]: train==[25.42589 = 4.51484 + 20.91106], recall= [ 0.00000  0.00000  0.00000  0.00000] , precision= [ 0.00000  0.00000  0.00000  0.00000] , auc=[0.44762], sum_recall=[0.00000]
Epoch 1 [33.2s + 11.3s]: train==[22.69896 = 1.82156 + 20.87739], recall= [ 0.02092  0.06874  0.10905  0.13132] , precision= [ 0.02306  0.01503  0.01204  0.00974] , auc=[0.69620], sum_recall=[0.33004]
Epoch 2 [32.9s + 12.7s]: train==[21.90132 = 1.14744 + 20.75388], recall= [ 0.02662  0.08049  0.14183  0.17228] , precision= [ 0.02818  0.01759  0.01563  0.01281] , auc=[0.76796], sum_recall=[0.42121]
Epoch 3 [33.8s + 12.1s]: train==[21.50236 = 0.89752 + 20.60484], recall= [ 0.02775  0.08931  0.14501  0.18757] , precision= [ 0.02989  0.01947  0.01614  0.01378] , auc=[0.78877], sum_recall=[0.44965]
Epoch 4 [33.5s + 12.2s]: train==[21.20004 = 0.75114 + 20.44890], recall= [ 0.02946  0.09294  0.15120  0.18953] , precision= [ 0.03074  0.02015  0.01674  0.01389] , auc=[0.79841], sum_recall=[0.46313]
Epoch 5 [33.5s + 12.2s]: train==[20.97473 = 0.67931 + 20.29543], recall= [ 0.03089  0.09367  0.15145  0.19287] , precision= [ 0.03330  0.02067  0.01682  0.01406] , auc=[0.80425], sum_recall=[0.46888]
Epoch 6 [34.1s + 12.7s]: train==[20.78533 = 0.63129 + 20.15403], recall= [ 0.03174  0.09413  0.15088  0.19515] , precision= [ 0.03416  0.02067  0.01665  0.01412] , auc=[0.80752], sum_recall=[0.47190]
Epoch 7 [33.3s + 12.3s]: train==[20.64072 = 0.61248 + 20.02824], recall= [ 0.02918  0.08869  0.15245  0.19641] , precision= [ 0.03160  0.01964  0.01682  0.01429] , auc=[0.81005], sum_recall=[0.46672]
Epoch 8 [33.7s + 12.4s]: train==[20.52195 = 0.60723 + 19.91472], recall= [ 0.03003  0.09182  0.15316  0.19928] , precision= [ 0.03245  0.02032  0.01691  0.01457] , auc=[0.81244], sum_recall=[0.47429]
Epoch 9 [33.6s + 13.0s]: train==[20.35276 = 0.56376 + 19.78900], recall= [ 0.02790  0.09367  0.15743  0.20092] , precision= [ 0.02989  0.02084  0.01734  0.01475] , auc=[0.81463], sum_recall=[0.47991]
Epoch 10 [33.3s + 12.7s]: train==[20.11201 = 0.53918 + 19.57283], recall= [ 0.02960  0.09643  0.16194  0.20451] , precision= [ 0.03160  0.02101  0.01802  0.01503] , auc=[0.81659], sum_recall=[0.49248]
Epoch 11 [33.1s + 13.0s]: train==[19.74323 = 0.52128 + 19.22194], recall= [ 0.02960  0.09828  0.16630  0.20826] , precision= [ 0.03160  0.02152  0.01853  0.01543] , auc=[0.81803], sum_recall=[0.50244]
Epoch 12 [33.1s + 12.7s]: train==[19.31393 = 0.51491 + 18.79902], recall= [ 0.03046  0.09657  0.17000  0.21173] , precision= [ 0.03245  0.02118  0.01904  0.01566] , auc=[0.81872], sum_recall=[0.50876]
Epoch 13 [34.2s + 14.6s]: train==[18.96649 = 0.50835 + 18.45814], recall= [ 0.02989  0.09475  0.16908  0.21344] , precision= [ 0.03245  0.02084  0.01887  0.01577] , auc=[0.81898], sum_recall=[0.50715]
Epoch 14 [34.7s + 12.7s]: train==[18.74505 = 0.52273 + 18.22233], recall= [ 0.02619  0.09475  0.16637  0.20870] , precision= [ 0.02818  0.02084  0.01853  0.01549] , auc=[0.81944], sum_recall=[0.49601]
Epoch 15 [36.2s + 12.1s]: train==[18.61429 = 0.52728 + 18.08702], recall= [ 0.02605  0.09987  0.16951  0.20435] , precision= [ 0.02818  0.02186  0.01879  0.01514] , auc=[0.82029], sum_recall=[0.49977]
Epoch 16 [34.8s + 14.3s]: train==[18.51514 = 0.54965 + 17.96549], recall= [ 0.02747  0.10272  0.16467  0.20648] , precision= [ 0.02904  0.02237  0.01827  0.01543] , auc=[0.82158], sum_recall=[0.50134]
Epoch 17 [35.5s + 14.7s]: train==[18.39762 = 0.54784 + 17.84978], recall= [ 0.02733  0.09973  0.16082  0.20201] , precision= [ 0.02904  0.02186  0.01785  0.01514] , auc=[0.82316], sum_recall=[0.48989]
Epoch 18 [33.9s + 14.9s]: train==[18.30876 = 0.52693 + 17.78183], recall= [ 0.02775  0.09828  0.15843  0.19929] , precision= [ 0.02989  0.02135  0.01768  0.01497] , auc=[0.82430], sum_recall=[0.48375]
Epoch 19 [33.9s + 14.8s]: train==[18.24669 = 0.53602 + 17.71066], recall= [ 0.02775  0.09700  0.15573  0.19715] , precision= [ 0.02989  0.02101  0.01742  0.01486] , auc=[0.82501], sum_recall=[0.47763]
Epoch 20 [33.7s + 15.1s]: train==[18.23580 = 0.53788 + 17.69792], recall= [ 0.02690  0.09273  0.15129  0.19246] , precision= [ 0.02904  0.02015  0.01682  0.01457] , auc=[0.82492], sum_recall=[0.46337]
Epoch 21 [35.2s + 15.2s]: train==[18.21105 = 0.54040 + 17.67065], recall= [ 0.02519  0.09145  0.14905  0.18849] , precision= [ 0.02733  0.01998  0.01657  0.01423] , auc=[0.82434], sum_recall=[0.45418]
Epoch 22 [35.0s + 15.1s]: train==[18.17266 = 0.52515 + 17.64752], recall= [ 0.02178  0.09145  0.14574  0.19105] , precision= [ 0.02391  0.01998  0.01631  0.01440] , auc=[0.82432], sum_recall=[0.45001]
Epoch 23 [33.8s + 15.2s]: train==[18.13956 = 0.50744 + 17.63212], recall= [ 0.02391  0.09337  0.14554  0.19203] , precision= [ 0.02647  0.02050  0.01648  0.01446] , auc=[0.82465], sum_recall=[0.45485]
Epoch 24 [34.8s + 15.4s]: train==[18.11638 = 0.48338 + 17.63300], recall= [ 0.02391  0.09422  0.14782  0.19267] , precision= [ 0.02647  0.02067  0.01657  0.01452] , auc=[0.82507], sum_recall=[0.45862]
Epoch 25 [33.6s + 15.5s]: train==[18.11614 = 0.49117 + 17.62497], recall= [ 0.02434  0.09593  0.15038  0.19338] , precision= [ 0.02647  0.02101  0.01682  0.01457] , auc=[0.82524], sum_recall=[0.46403]
Epoch 26 [33.3s + 15.2s]: train==[18.08425 = 0.47354 + 17.61071], recall= [ 0.02391  0.09849  0.15543  0.19310] , precision= [ 0.02562  0.02152  0.01734  0.01446] , auc=[0.82580], sum_recall=[0.47093]
Epoch 27 [33.4s + 16.2s]: train==[18.03513 = 0.42901 + 17.60612], recall= [ 0.02477  0.09706  0.15543  0.19981] , precision= [ 0.02647  0.02152  0.01734  0.01486] , auc=[0.82602], sum_recall=[0.47706]
Epoch 28 [33.3s + 15.6s]: train==[18.02221 = 0.42366 + 17.59855], recall= [ 0.02690  0.09642  0.15885  0.19938] , precision= [ 0.02904  0.02152  0.01768  0.01486] , auc=[0.82588], sum_recall=[0.48155]
Epoch 29 [35.1s + 17.5s]: train==[17.99880 = 0.39826 + 17.60053], recall= [ 0.02662  0.09642  0.16098  0.20213] , precision= [ 0.02818  0.02152  0.01793  0.01503] , auc=[0.82571], sum_recall=[0.48614]
Epoch 30 [36.6s + 15.8s]: train==[17.97036 = 0.38700 + 17.58336], recall= [ 0.02747  0.09727  0.16405  0.20469] , precision= [ 0.02904  0.02186  0.01819  0.01520] , auc=[0.82557], sum_recall=[0.49349]
Epoch 31 [33.8s + 16.6s]: train==[17.94993 = 0.35604 + 17.59389], recall= [ 0.02790  0.09642  0.16178  0.20747] , precision= [ 0.02904  0.02169  0.01785  0.01543] , auc=[0.82544], sum_recall=[0.49356]
Epoch 32 [34.0s + 16.0s]: train==[17.95307 = 0.36741 + 17.58566], recall= [ 0.02519  0.09856  0.16349  0.20883] , precision= [ 0.02562  0.02203  0.01810  0.01554] , auc=[0.82496], sum_recall=[0.49606]
Epoch 33 [33.8s + 16.3s]: train==[17.91458 = 0.34362 + 17.57095], recall= [ 0.02573  0.10026  0.16562  0.20952] , precision= [ 0.02733  0.02237  0.01845  0.01560] , auc=[0.82418], sum_recall=[0.50113]
Epoch 34 [34.3s + 15.6s]: train==[17.88530 = 0.32754 + 17.55777], recall= [ 0.02615  0.10539  0.16647  0.21379] , precision= [ 0.02818  0.02340  0.01853  0.01588] , auc=[0.82360], sum_recall=[0.51181]
Epoch 35 [34.3s + 15.3s]: train==[17.88628 = 0.32575 + 17.56053], recall= [ 0.02701  0.10731  0.16690  0.21621] , precision= [ 0.02904  0.02391  0.01862  0.01600] , auc=[0.82345], sum_recall=[0.51743]
Epoch 36 [34.0s + 15.2s]: train==[17.83210 = 0.30502 + 17.52709], recall= [ 0.02690  0.10660  0.17032  0.21678] , precision= [ 0.02818  0.02323  0.01896  0.01600] , auc=[0.82351], sum_recall=[0.52060]
Epoch 37 [33.8s + 15.2s]: train==[17.82553 = 0.29814 + 17.52738], recall= [ 0.02690  0.10745  0.17300  0.21536] , precision= [ 0.02818  0.02340  0.01930  0.01583] , auc=[0.82365], sum_recall=[0.52271]
End of trainning! Best recall= [ 0.02477  0.09706  0.15543  0.19981] , precision= [ 0.02647  0.02152  0.01734  0.01486] , auc=[0.82602]
test.sh: line 49: -gpu_id: command not found
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross1', dropout=0.3, emb_dim=200, gamma=0.9, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, type=3, weight=None)
2022-02-07 23:14:42
loading data...
[n_users, n_items]=[3209, 12211]
[n_train, n_test]=[2636, 1318]
[n_edges]=[280090]
Using GPU 0,  memory_free: 24265
tensor([-0.0393,  0.0079, -0.0091, -0.0320, -0.0401], device='cuda:0')
Loading Model..Number of Model Parameters:  3324802
Epoch 0 [33.4s + 9.8s]: train==[25.37196 = 4.45818 + 20.91378], recall= [ 0.00000  0.00000  0.00000  0.00000] , precision= [ 0.00000  0.00000  0.00000  0.00000] , auc=[0.42949], sum_recall=[0.00000]
Epoch 1 [33.5s + 10.7s]: train==[22.72584 = 1.84409 + 20.88175], recall= [ 0.01772  0.06362  0.10781  0.11976] , precision= [ 0.01964  0.01435  0.01204  0.00888] , auc=[0.67191], sum_recall=[0.30891]
Epoch 2 [34.0s + 11.7s]: train==[21.89485 = 1.12957 + 20.76528], recall= [ 0.02569  0.08799  0.14773  0.17897] , precision= [ 0.02818  0.01947  0.01623  0.01309] , auc=[0.75422], sum_recall=[0.44039]
Epoch 3 [33.9s + 12.0s]: train==[21.50229 = 0.88268 + 20.61962], recall= [ 0.02348  0.09540  0.15542  0.19617] , precision= [ 0.02477  0.02118  0.01708  0.01446] , auc=[0.77888], sum_recall=[0.47046]
Epoch 4 [33.7s + 12.0s]: train==[21.20761 = 0.74369 + 20.46393], recall= [ 0.02946  0.09415  0.16472  0.19994] , precision= [ 0.03245  0.02067  0.01793  0.01457] , auc=[0.78975], sum_recall=[0.48828]
Epoch 5 [33.6s + 12.2s]: train==[20.97800 = 0.66958 + 20.30843], recall= [ 0.02861  0.09984  0.16216  0.19642] , precision= [ 0.03160  0.02186  0.01768  0.01435] , auc=[0.79639], sum_recall=[0.48704]
Epoch 6 [33.7s + 12.0s]: train==[20.79641 = 0.63130 + 20.16511], recall= [ 0.02690  0.10418  0.16483  0.19760] , precision= [ 0.02989  0.02272  0.01802  0.01440] , auc=[0.80013], sum_recall=[0.49351]
Epoch 7 [33.8s + 12.6s]: train==[20.65398 = 0.61536 + 20.03862], recall= [ 0.02605  0.10418  0.16825  0.20104] , precision= [ 0.02904  0.02272  0.01836  0.01469] , auc=[0.80321], sum_recall=[0.49952]
Epoch 8 [33.7s + 12.3s]: train==[20.52781 = 0.60063 + 19.92718], recall= [ 0.02405  0.10760  0.16860  0.20125] , precision= [ 0.02647  0.02340  0.01845  0.01475] , auc=[0.80599], sum_recall=[0.50150]
Epoch 9 [33.7s + 12.6s]: train==[20.37827 = 0.56924 + 19.80903], recall= [ 0.02491  0.10881  0.17052  0.20118] , precision= [ 0.02733  0.02391  0.01870  0.01480] , auc=[0.80870], sum_recall=[0.50542]
Epoch 10 [33.8s + 12.6s]: train==[20.17313 = 0.54903 + 19.62410], recall= [ 0.02576  0.10585  0.16955  0.20346] , precision= [ 0.02818  0.02357  0.01870  0.01503] , auc=[0.81134], sum_recall=[0.50462]
Epoch 11 [33.9s + 13.0s]: train==[19.84428 = 0.52307 + 19.32121], recall= [ 0.02854  0.10841  0.16829  0.20478] , precision= [ 0.03160  0.02408  0.01870  0.01520] , auc=[0.81354], sum_recall=[0.51001]
Epoch 12 [33.3s + 12.5s]: train==[19.40460 = 0.52033 + 18.88427], recall= [ 0.02939  0.10912  0.16997  0.20204] , precision= [ 0.03245  0.02425  0.01887  0.01514] , auc=[0.81503], sum_recall=[0.51052]
Epoch 13 [33.7s + 11.8s]: train==[19.01629 = 0.50676 + 18.50953], recall= [ 0.02711  0.11026  0.17129  0.20630] , precision= [ 0.02989  0.02442  0.01921  0.01554] , auc=[0.81600], sum_recall=[0.51496]
Epoch 14 [33.9s + 11.6s]: train==[18.77069 = 0.51507 + 18.25561], recall= [ 0.02861  0.11062  0.17242  0.20459] , precision= [ 0.03074  0.02442  0.01947  0.01554] , auc=[0.81696], sum_recall=[0.51623]
Epoch 15 [33.5s + 11.7s]: train==[18.62405 = 0.52145 + 18.10261], recall= [ 0.02747  0.11036  0.16889  0.20852] , precision= [ 0.02904  0.02442  0.01913  0.01588] , auc=[0.81808], sum_recall=[0.51524]
Epoch 16 [36.8s + 11.7s]: train==[18.52537 = 0.54820 + 17.97717], recall= [ 0.02576  0.10510  0.16662  0.20505] , precision= [ 0.02733  0.02357  0.01879  0.01560] , auc=[0.81929], sum_recall=[0.50252]
Epoch 17 [33.9s + 11.7s]: train==[18.41704 = 0.55131 + 17.86573], recall= [ 0.02405  0.10225  0.16619  0.19992] , precision= [ 0.02647  0.02306  0.01870  0.01526] , auc=[0.82048], sum_recall=[0.49241]
Epoch 18 [33.9s + 11.6s]: train==[18.31288 = 0.52869 + 17.78419], recall= [ 0.02235  0.10381  0.16299  0.19597] , precision= [ 0.02477  0.02323  0.01827  0.01497] , auc=[0.82150], sum_recall=[0.48512]
Epoch 19 [33.8s + 11.8s]: train==[18.25593 = 0.54009 + 17.71585], recall= [ 0.02064  0.09656  0.15616  0.19469] , precision= [ 0.02306  0.02186  0.01759  0.01486] , auc=[0.82188], sum_recall=[0.46804]
Epoch 20 [33.8s + 11.8s]: train==[18.23176 = 0.54344 + 17.68832], recall= [ 0.02149  0.09399  0.15103  0.19311] , precision= [ 0.02391  0.02135  0.01708  0.01457] , auc=[0.82135], sum_recall=[0.45963]
Epoch 21 [34.1s + 11.7s]: train==[18.21016 = 0.54425 + 17.66591], recall= [ 0.02085  0.08972  0.14804  0.18977] , precision= [ 0.02391  0.02050  0.01674  0.01429] , auc=[0.82028], sum_recall=[0.44839]
Epoch 22 [33.9s + 12.1s]: train==[18.17489 = 0.53317 + 17.64172], recall= [ 0.02235  0.09058  0.14740  0.18635] , precision= [ 0.02477  0.02067  0.01674  0.01406] , auc=[0.81961], sum_recall=[0.44668]
Epoch 23 [35.2s + 12.2s]: train==[18.13860 = 0.51807 + 17.62053], recall= [ 0.02064  0.09058  0.14569  0.18649] , precision= [ 0.02306  0.02067  0.01657  0.01412] , auc=[0.81972], sum_recall=[0.44340]
Epoch 24 [35.1s + 12.5s]: train==[18.11534 = 0.49656 + 17.61877], recall= [ 0.01978  0.09157  0.14911  0.18735] , precision= [ 0.02220  0.02101  0.01691  0.01418] , auc=[0.82037], sum_recall=[0.44782]
Epoch 25 [39.3s + 12.2s]: train==[18.11515 = 0.49200 + 17.62315], recall= [ 0.01893  0.09328  0.15066  0.19106] , precision= [ 0.02135  0.02135  0.01699  0.01452] , auc=[0.82156], sum_recall=[0.45393]
Epoch 26 [38.3s + 12.3s]: train==[18.09054 = 0.48549 + 17.60505], recall= [ 0.01822  0.10011  0.15296  0.19405] , precision= [ 0.02135  0.02272  0.01734  0.01469] , auc=[0.82219], sum_recall=[0.46535]
Epoch 27 [33.7s + 12.3s]: train==[18.03540 = 0.43947 + 17.59593], recall= [ 0.01779  0.10132  0.15467  0.19960] , precision= [ 0.02050  0.02306  0.01751  0.01509] , auc=[0.82268], sum_recall=[0.47339]
Epoch 28 [33.5s + 12.3s]: train==[18.01250 = 0.42898 + 17.58353], recall= [ 0.01651  0.10289  0.16001  0.20046] , precision= [ 0.01879  0.02323  0.01810  0.01514] , auc=[0.82288], sum_recall=[0.47986]
Epoch 29 [33.8s + 12.5s]: train==[17.99975 = 0.40606 + 17.59369], recall= [ 0.01907  0.10374  0.16058  0.20302] , precision= [ 0.02135  0.02340  0.01810  0.01531] , auc=[0.82284], sum_recall=[0.48641]
Epoch 30 [34.1s + 12.6s]: train==[17.96760 = 0.39386 + 17.57374], recall= [ 0.02163  0.10374  0.16092  0.20145] , precision= [ 0.02477  0.02340  0.01810  0.01514] , auc=[0.82275], sum_recall=[0.48775]
Epoch 31 [33.8s + 12.6s]: train==[17.94735 = 0.36047 + 17.58688], recall= [ 0.02420  0.10556  0.16265  0.20356] , precision= [ 0.02733  0.02391  0.01819  0.01520] , auc=[0.82248], sum_recall=[0.49596]
Epoch 32 [33.6s + 12.1s]: train==[17.95091 = 0.36900 + 17.58191], recall= [ 0.02441  0.10513  0.16661  0.20826] , precision= [ 0.02818  0.02391  0.01870  0.01554] , auc=[0.82210], sum_recall=[0.50441]
Epoch 33 [33.6s + 12.2s]: train==[17.91378 = 0.34852 + 17.56526], recall= [ 0.02740  0.10129  0.16875  0.20911] , precision= [ 0.03074  0.02306  0.01896  0.01560] , auc=[0.82172], sum_recall=[0.50654]
Epoch 34 [33.6s + 12.4s]: train==[17.89917 = 0.33460 + 17.56458], recall= [ 0.02484  0.10107  0.17122  0.21124] , precision= [ 0.02818  0.02289  0.01913  0.01577] , auc=[0.82152], sum_recall=[0.50838]
Epoch 35 [38.4s + 11.9s]: train==[17.89816 = 0.32692 + 17.57124], recall= [ 0.02569  0.10321  0.17549  0.21459] , precision= [ 0.02904  0.02340  0.01956  0.01600] , auc=[0.82158], sum_recall=[0.51898]
Epoch 36 [33.8s + 12.1s]: train==[17.83986 = 0.30040 + 17.53946], recall= [ 0.02654  0.10492  0.17323  0.21801] , precision= [ 0.02989  0.02374  0.01939  0.01623] , auc=[0.82179], sum_recall=[0.52270]
Epoch 37 [34.0s + 12.8s]: train==[17.84797 = 0.29893 + 17.54904], recall= [ 0.02896  0.10380  0.17195  0.22091] , precision= [ 0.03160  0.02340  0.01921  0.01640] , auc=[0.82204], sum_recall=[0.52562]
Epoch 38 [33.8s + 12.3s]: train==[17.81969 = 0.28488 + 17.53481], recall= [ 0.02726  0.10451  0.17152  0.22162] , precision= [ 0.02989  0.02340  0.01921  0.01640] , auc=[0.82237], sum_recall=[0.52491]
End of trainning! Best recall= [ 0.01651  0.10289  0.16001  0.20046] , precision= [ 0.01879  0.02323  0.01810  0.01514] , auc=[0.82288]
test.sh: line 49: -gpu_id: command not found
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross1', dropout=0.3, emb_dim=200, gamma=0.9, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, type=3, weight=None)
2022-02-07 23:44:56
loading data...
[n_users, n_items]=[3209, 12211]
[n_train, n_test]=[2636, 1318]
[n_edges]=[280090]
Using GPU 0,  memory_free: 24265
tensor([ 0.0167,  0.0393,  0.0401, -0.0378,  0.0176], device='cuda:0')
Loading Model..Number of Model Parameters:  3324802
Epoch 0 [32.4s + 9.5s]: train==[25.30482 = 4.45377 + 20.85105], recall= [ 0.00000  0.00000  0.00000  0.00000] , precision= [ 0.00000  0.00000  0.00000  0.00000] , auc=[0.45457], sum_recall=[0.00000]
Epoch 1 [33.1s + 10.7s]: train==[22.69043 = 1.86704 + 20.82339], recall= [ 0.01793  0.06561  0.10639  0.13116] , precision= [ 0.01964  0.01469  0.01178  0.00962] , auc=[0.68539], sum_recall=[0.32109]
Epoch 2 [33.2s + 11.4s]: train==[21.84920 = 1.14224 + 20.70697], recall= [ 0.02711  0.09429  0.15037  0.19118] , precision= [ 0.03074  0.02118  0.01699  0.01418] , auc=[0.75896], sum_recall=[0.46296]
Epoch 3 [33.2s + 11.4s]: train==[21.45563 = 0.88963 + 20.56600], recall= [ 0.03060  0.10045  0.15902  0.19951] , precision= [ 0.03245  0.02237  0.01768  0.01480] , auc=[0.78225], sum_recall=[0.48957]
Epoch 4 [33.1s + 11.7s]: train==[21.17445 = 0.75464 + 20.41981], recall= [ 0.03145  0.09959  0.16677  0.21040] , precision= [ 0.03330  0.02203  0.01836  0.01531] , auc=[0.79305], sum_recall=[0.50822]
Epoch 5 [33.0s + 11.7s]: train==[20.95823 = 0.68084 + 20.27739], recall= [ 0.02676  0.09863  0.16848  0.20945] , precision= [ 0.02818  0.02186  0.01845  0.01531] , auc=[0.80002], sum_recall=[0.50332]
Epoch 6 [33.1s + 11.8s]: train==[20.78288 = 0.63504 + 20.14784], recall= [ 0.02932  0.10198  0.16442  0.21265] , precision= [ 0.03074  0.02254  0.01810  0.01554] , auc=[0.80398], sum_recall=[0.50838]
Epoch 7 [33.3s + 11.6s]: train==[20.65382 = 0.62033 + 20.03349], recall= [ 0.02989  0.09942  0.16421  0.20967] , precision= [ 0.03074  0.02203  0.01810  0.01537] , auc=[0.80714], sum_recall=[0.50318]
Epoch 8 [33.4s + 16.5s]: train==[20.53345 = 0.60110 + 19.93234], recall= [ 0.02690  0.09757  0.16336  0.20855] , precision= [ 0.02818  0.02152  0.01802  0.01537] , auc=[0.80987], sum_recall=[0.49638]
Epoch 9 [48.3s + 19.2s]: train==[20.38890 = 0.56166 + 19.82723], recall= [ 0.02690  0.10127  0.16336  0.21090] , precision= [ 0.02818  0.02237  0.01810  0.01549] , auc=[0.81242], sum_recall=[0.50243]
Epoch 10 [45.5s + 15.4s]: train==[20.19436 = 0.53495 + 19.65942], recall= [ 0.02825  0.10137  0.16801  0.21207] , precision= [ 0.03074  0.02254  0.01862  0.01566] , auc=[0.81490], sum_recall=[0.50971]
Epoch 11 [39.6s + 12.0s]: train==[19.88708 = 0.50732 + 19.37975], recall= [ 0.02740  0.10159  0.17150  0.21583] , precision= [ 0.02989  0.02272  0.01887  0.01594] , auc=[0.81703], sum_recall=[0.51631]
Epoch 12 [33.3s + 13.6s]: train==[19.46564 = 0.50217 + 18.96348], recall= [ 0.02726  0.10685  0.17335  0.21252] , precision= [ 0.02989  0.02391  0.01913  0.01566] , auc=[0.81858], sum_recall=[0.51998]
Epoch 13 [33.8s + 13.1s]: train==[19.06842 = 0.49155 + 18.57687], recall= [ 0.02733  0.10899  0.17420  0.21477] , precision= [ 0.02989  0.02442  0.01921  0.01600] , auc=[0.81954], sum_recall=[0.52529]
Epoch 14 [33.3s + 12.0s]: train==[18.80220 = 0.49947 + 18.30274], recall= [ 0.02797  0.10942  0.17648  0.21420] , precision= [ 0.03074  0.02442  0.01956  0.01600] , auc=[0.82026], sum_recall=[0.52806]
Epoch 15 [33.4s + 11.9s]: train==[18.65371 = 0.51363 + 18.14009], recall= [ 0.02939  0.10799  0.17306  0.21121] , precision= [ 0.03160  0.02408  0.01921  0.01583] , auc=[0.82132], sum_recall=[0.52166]
Epoch 16 [33.3s + 11.8s]: train==[18.54361 = 0.53546 + 18.00815], recall= [ 0.03053  0.10763  0.16674  0.21270] , precision= [ 0.03330  0.02408  0.01870  0.01594] , auc=[0.82270], sum_recall=[0.51761]
Epoch 17 [33.3s + 12.3s]: train==[18.42606 = 0.53411 + 17.89196], recall= [ 0.02925  0.10179  0.16397  0.20516] , precision= [ 0.03245  0.02272  0.01845  0.01549] , auc=[0.82418], sum_recall=[0.50017]
Epoch 18 [35.6s + 12.7s]: train==[18.32948 = 0.51724 + 17.81224], recall= [ 0.02839  0.10009  0.16204  0.20025] , precision= [ 0.03160  0.02237  0.01836  0.01520] , auc=[0.82536], sum_recall=[0.49077]
Epoch 19 [33.8s + 13.3s]: train==[18.26302 = 0.52959 + 17.73343], recall= [ 0.02839  0.09536  0.15735  0.19587] , precision= [ 0.03160  0.02152  0.01776  0.01486] , auc=[0.82624], sum_recall=[0.47698]
Epoch 20 [32.8s + 11.8s]: train==[18.24133 = 0.53247 + 17.70886], recall= [ 0.02541  0.09750  0.15372  0.19118] , precision= [ 0.02904  0.02203  0.01734  0.01452] , auc=[0.82623], sum_recall=[0.46780]
Epoch 21 [32.9s + 11.8s]: train==[18.21052 = 0.52995 + 17.68058], recall= [ 0.02370  0.09194  0.15159  0.18990] , precision= [ 0.02733  0.02067  0.01708  0.01440] , auc=[0.82578], sum_recall=[0.45712]
Epoch 22 [32.9s + 11.7s]: train==[18.18013 = 0.52662 + 17.65351], recall= [ 0.02370  0.09194  0.15201  0.18822] , precision= [ 0.02733  0.02067  0.01708  0.01429] , auc=[0.82536], sum_recall=[0.45587]
Epoch 23 [33.1s + 11.8s]: train==[18.16268 = 0.51716 + 17.64552], recall= [ 0.02284  0.09237  0.15004  0.18487] , precision= [ 0.02647  0.02084  0.01682  0.01401] , auc=[0.82530], sum_recall=[0.45012]
Epoch 24 [32.8s + 11.9s]: train==[18.13377 = 0.49119 + 17.64257], recall= [ 0.02370  0.09323  0.15063  0.18665] , precision= [ 0.02733  0.02101  0.01699  0.01418] , auc=[0.82586], sum_recall=[0.45421]
Epoch 25 [32.9s + 12.2s]: train==[18.13412 = 0.48976 + 17.64436], recall= [ 0.02327  0.09564  0.15063  0.19177] , precision= [ 0.02647  0.02169  0.01699  0.01452] , auc=[0.82639], sum_recall=[0.46132]
Epoch 26 [36.7s + 11.8s]: train==[18.09909 = 0.47944 + 17.61965], recall= [ 0.02327  0.09816  0.15476  0.19476] , precision= [ 0.02647  0.02220  0.01734  0.01469] , auc=[0.82649], sum_recall=[0.47096]
Epoch 27 [32.9s + 11.9s]: train==[18.05737 = 0.43542 + 17.62195], recall= [ 0.02669  0.09912  0.15604  0.19761] , precision= [ 0.02989  0.02254  0.01742  0.01475] , auc=[0.82615], sum_recall=[0.47946]
Epoch 28 [34.4s + 13.2s]: train==[18.03218 = 0.42851 + 17.60367], recall= [ 0.02512  0.10211  0.15860  0.19761] , precision= [ 0.02904  0.02323  0.01776  0.01475] , auc=[0.82554], sum_recall=[0.48345]
Epoch 29 [35.1s + 12.5s]: train==[18.01743 = 0.40888 + 17.60855], recall= [ 0.02427  0.10638  0.15616  0.20174] , precision= [ 0.02818  0.02408  0.01759  0.01497] , auc=[0.82521], sum_recall=[0.48855]
Epoch 30 [32.8s + 12.5s]: train==[17.99290 = 0.39593 + 17.59697], recall= [ 0.02242  0.10478  0.16171  0.20416] , precision= [ 0.02562  0.02391  0.01819  0.01520] , auc=[0.82489], sum_recall=[0.49306]
Epoch 31 [32.8s + 13.1s]: train==[17.98108 = 0.36750 + 17.61358], recall= [ 0.02156  0.10349  0.16428  0.20309] , precision= [ 0.02477  0.02357  0.01845  0.01514] , auc=[0.82448], sum_recall=[0.49242]
Epoch 32 [37.0s + 12.2s]: train==[17.98439 = 0.37675 + 17.60764], recall= [ 0.02213  0.10264  0.16428  0.20750] , precision= [ 0.02477  0.02340  0.01845  0.01549] , auc=[0.82420], sum_recall=[0.49655]
Epoch 33 [37.1s + 12.7s]: train==[17.94194 = 0.34980 + 17.59214], recall= [ 0.02384  0.10392  0.16705  0.20733] , precision= [ 0.02647  0.02374  0.01879  0.01543] , auc=[0.82372], sum_recall=[0.50214]
Epoch 34 [35.4s + 12.2s]: train==[17.91683 = 0.33608 + 17.58074], recall= [ 0.02384  0.10349  0.16876  0.20648] , precision= [ 0.02647  0.02357  0.01896  0.01537] , auc=[0.82309], sum_recall=[0.50257]
Epoch 35 [33.9s + 11.8s]: train==[17.92063 = 0.33052 + 17.59011], recall= [ 0.02178  0.10546  0.16848  0.20733] , precision= [ 0.02306  0.02374  0.01887  0.01543] , auc=[0.82277], sum_recall=[0.50304]
Epoch 36 [36.7s + 11.8s]: train==[17.87470 = 0.30555 + 17.56915], recall= [ 0.02477  0.10501  0.16976  0.20776] , precision= [ 0.02647  0.02357  0.01896  0.01549] , auc=[0.82269], sum_recall=[0.50729]
End of trainning! Best recall= [ 0.02327  0.09816  0.15476  0.19476] , precision= [ 0.02647  0.02220  0.01734  0.01469] , auc=[0.82649]
test.sh: line 49: -gpu_id: command not found
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross1', dropout=0.3, emb_dim=200, gamma=1.0, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, type=3, weight=None)
2022-02-08 00:14:07
loading data...
[n_users, n_items]=[3209, 12211]
[n_train, n_test]=[2636, 1318]
[n_edges]=[280090]
Using GPU 0,  memory_free: 24265
tensor([ 0.0383,  0.0109,  0.0290, -0.0184, -0.0016], device='cuda:0')
Loading Model..Number of Model Parameters:  3324802
Epoch 0 [32.6s + 9.6s]: train==[27.67573 = 4.44402 + 23.23172], recall= [ 0.00000  0.00000  0.00000  0.00000] , precision= [ 0.00000  0.00000  0.00000  0.00000] , auc=[0.45721], sum_recall=[0.00000]
Epoch 1 [33.7s + 11.1s]: train==[24.98731 = 1.79474 + 23.19257], recall= [ 0.01964  0.07330  0.10552  0.13760] , precision= [ 0.02050  0.01605  0.01187  0.01025] , auc=[0.70413], sum_recall=[0.33605]
Epoch 2 [33.4s + 12.5s]: train==[24.15669 = 1.09691 + 23.05978], recall= [ 0.02434  0.09038  0.15046  0.19023] , precision= [ 0.02562  0.01964  0.01682  0.01412] , auc=[0.76641], sum_recall=[0.45540]
Epoch 3 [37.8s + 12.7s]: train==[23.76758 = 0.87231 + 22.89527], recall= [ 0.02775  0.09205  0.15893  0.19839] , precision= [ 0.02818  0.02032  0.01734  0.01446] , auc=[0.78545], sum_recall=[0.47712]
Epoch 4 [33.3s + 12.2s]: train==[23.46098 = 0.74229 + 22.71869], recall= [ 0.02818  0.09465  0.15964  0.20803] , precision= [ 0.02904  0.02067  0.01734  0.01514] , auc=[0.79530], sum_recall=[0.49049]
Epoch 5 [33.4s + 12.2s]: train==[23.22250 = 0.68101 + 22.54149], recall= [ 0.02733  0.09420  0.16273  0.20589] , precision= [ 0.02989  0.02084  0.01776  0.01497] , auc=[0.80125], sum_recall=[0.49015]
Epoch 6 [33.2s + 13.1s]: train==[23.01071 = 0.63297 + 22.37774], recall= [ 0.02647  0.09576  0.16365  0.20909] , precision= [ 0.02904  0.02152  0.01785  0.01526] , auc=[0.80455], sum_recall=[0.49497]
Epoch 7 [37.4s + 12.6s]: train==[22.85687 = 0.62342 + 22.23345], recall= [ 0.02491  0.09583  0.16472  0.20959] , precision= [ 0.02733  0.02152  0.01793  0.01537] , auc=[0.80702], sum_recall=[0.49504]
Epoch 8 [33.0s + 11.9s]: train==[22.71254 = 0.60991 + 22.10262], recall= [ 0.02491  0.09353  0.16714  0.20638] , precision= [ 0.02733  0.02084  0.01836  0.01520] , auc=[0.80927], sum_recall=[0.49195]
Epoch 9 [33.1s + 11.8s]: train==[22.53360 = 0.58412 + 21.94948], recall= [ 0.02363  0.09363  0.17034  0.20688] , precision= [ 0.02562  0.02084  0.01862  0.01520] , auc=[0.81117], sum_recall=[0.49447]
Epoch 10 [33.2s + 14.0s]: train==[22.23766 = 0.56097 + 21.67669], recall= [ 0.02533  0.09804  0.17427  0.20809] , precision= [ 0.02733  0.02186  0.01904  0.01543] , auc=[0.81274], sum_recall=[0.50574]
Epoch 11 [33.1s + 13.1s]: train==[21.77109 = 0.54338 + 21.22772], recall= [ 0.02619  0.09975  0.17580  0.20604] , precision= [ 0.02818  0.02220  0.01947  0.01543] , auc=[0.81387], sum_recall=[0.50778]
Epoch 12 [37.2s + 13.1s]: train==[21.27203 = 0.54175 + 20.73028], recall= [ 0.02875  0.10189  0.17236  0.20217] , precision= [ 0.03074  0.02272  0.01913  0.01520] , auc=[0.81460], sum_recall=[0.50517]
Epoch 13 [37.2s + 11.8s]: train==[20.90313 = 0.52979 + 20.37333], recall= [ 0.02960  0.10108  0.16951  0.20950] , precision= [ 0.03160  0.02254  0.01887  0.01566] , auc=[0.81535], sum_recall=[0.50970]
Epoch 14 [33.2s + 11.6s]: train==[20.70035 = 0.54692 + 20.15342], recall= [ 0.02832  0.10247  0.16951  0.20896] , precision= [ 0.02989  0.02272  0.01887  0.01566] , auc=[0.81648], sum_recall=[0.50927]
Epoch 15 [33.1s + 11.6s]: train==[20.57342 = 0.55496 + 20.01846], recall= [ 0.02790  0.10201  0.16555  0.20739] , precision= [ 0.02904  0.02254  0.01836  0.01560] , auc=[0.81794], sum_recall=[0.50285]
Epoch 16 [32.9s + 12.1s]: train==[20.46025 = 0.57822 + 19.88203], recall= [ 0.02790  0.09641  0.16000  0.20130] , precision= [ 0.02904  0.02135  0.01776  0.01514] , auc=[0.81962], sum_recall=[0.48560]
Epoch 17 [33.0s + 11.5s]: train==[20.34669 = 0.57761 + 19.76908], recall= [ 0.02491  0.09451  0.15374  0.20016] , precision= [ 0.02647  0.02050  0.01716  0.01514] , auc=[0.82152], sum_recall=[0.47331]
Epoch 18 [33.1s + 11.5s]: train==[20.25452 = 0.55972 + 19.69480], recall= [ 0.02235  0.09479  0.15132  0.19631] , precision= [ 0.02391  0.02067  0.01699  0.01486] , auc=[0.82288], sum_recall=[0.46477]
Epoch 19 [33.2s + 11.8s]: train==[20.22263 = 0.57444 + 19.64820], recall= [ 0.02320  0.09180  0.14816  0.18980] , precision= [ 0.02477  0.01998  0.01665  0.01440] , auc=[0.82349], sum_recall=[0.45296]
Epoch 20 [33.0s + 11.6s]: train==[20.19531 = 0.56990 + 19.62541], recall= [ 0.02149  0.08938  0.14773  0.18518] , precision= [ 0.02306  0.01964  0.01665  0.01401] , auc=[0.82341], sum_recall=[0.44378]
Epoch 21 [33.0s + 12.0s]: train==[20.17311 = 0.56895 + 19.60415], recall= [ 0.02149  0.08682  0.14752  0.18518] , precision= [ 0.02306  0.01913  0.01657  0.01401] , auc=[0.82276], sum_recall=[0.44100]
Epoch 22 [33.0s + 12.0s]: train==[20.13812 = 0.55794 + 19.58019], recall= [ 0.02092  0.08597  0.14666  0.18444] , precision= [ 0.02306  0.01896  0.01648  0.01401] , auc=[0.82298], sum_recall=[0.43800]
Epoch 23 [33.2s + 12.0s]: train==[20.10601 = 0.54456 + 19.56145], recall= [ 0.01921  0.08605  0.14868  0.18617] , precision= [ 0.02135  0.01913  0.01682  0.01412] , auc=[0.82328], sum_recall=[0.44012]
Epoch 24 [33.3s + 12.4s]: train==[20.07781 = 0.51591 + 19.56190], recall= [ 0.01836  0.08896  0.15129  0.18971] , precision= [ 0.02050  0.01964  0.01691  0.01440] , auc=[0.82377], sum_recall=[0.44831]
Epoch 25 [34.9s + 12.9s]: train==[20.07841 = 0.51036 + 19.56806], recall= [ 0.01879  0.08753  0.15300  0.19313] , precision= [ 0.02050  0.01947  0.01708  0.01463] , auc=[0.82429], sum_recall=[0.45244]
Epoch 26 [33.1s + 13.1s]: train==[20.04403 = 0.49648 + 19.54754], recall= [ 0.01879  0.09009  0.15490  0.19345] , precision= [ 0.02050  0.01998  0.01734  0.01457] , auc=[0.82452], sum_recall=[0.45724]
Epoch 27 [37.4s + 12.1s]: train==[20.00142 = 0.45469 + 19.54672], recall= [ 0.01978  0.09308  0.15789  0.19502] , precision= [ 0.02220  0.02050  0.01768  0.01463] , auc=[0.82437], sum_recall=[0.46578]
Epoch 28 [33.3s + 12.5s]: train==[19.97578 = 0.44626 + 19.52953], recall= [ 0.02505  0.09661  0.15789  0.19644] , precision= [ 0.02733  0.02135  0.01768  0.01469] , auc=[0.82418], sum_recall=[0.47599]
Epoch 29 [33.2s + 12.0s]: train==[19.97354 = 0.42616 + 19.54738], recall= [ 0.02533  0.09803  0.15544  0.19673] , precision= [ 0.02818  0.02152  0.01725  0.01469] , auc=[0.82379], sum_recall=[0.47553]
Epoch 30 [33.3s + 12.1s]: train==[19.93487 = 0.41076 + 19.52412], recall= [ 0.02533  0.09811  0.16031  0.19758] , precision= [ 0.02818  0.02169  0.01793  0.01475] , auc=[0.82325], sum_recall=[0.48134]
Epoch 31 [33.3s + 12.7s]: train==[19.91726 = 0.37767 + 19.53959], recall= [ 0.02491  0.09854  0.16458  0.19937] , precision= [ 0.02733  0.02186  0.01836  0.01492] , auc=[0.82254], sum_recall=[0.48740]
Epoch 32 [33.1s + 12.7s]: train==[19.92007 = 0.39102 + 19.52906], recall= [ 0.02576  0.09769  0.16458  0.20279] , precision= [ 0.02818  0.02169  0.01836  0.01514] , auc=[0.82166], sum_recall=[0.49082]
Epoch 33 [33.1s + 12.1s]: train==[19.87969 = 0.36432 + 19.51537], recall= [ 0.02662  0.09897  0.16300  0.20578] , precision= [ 0.02904  0.02203  0.01827  0.01531] , auc=[0.82102], sum_recall=[0.49436]
Epoch 34 [33.3s + 11.8s]: train==[19.84801 = 0.34658 + 19.50143], recall= [ 0.02875  0.10068  0.16356  0.20535] , precision= [ 0.03160  0.02237  0.01827  0.01531] , auc=[0.82066], sum_recall=[0.49834]
Epoch 35 [33.2s + 12.3s]: train==[19.85684 = 0.34375 + 19.51310], recall= [ 0.03046  0.10324  0.16399  0.20621] , precision= [ 0.03330  0.02289  0.01836  0.01537] , auc=[0.82063], sum_recall=[0.50389]
Epoch 36 [37.5s + 12.1s]: train==[19.79981 = 0.31750 + 19.48231], recall= [ 0.03131  0.10025  0.16485  0.20535] , precision= [ 0.03416  0.02220  0.01845  0.01531] , auc=[0.82072], sum_recall=[0.50176]
End of trainning! Best recall= [ 0.01879  0.09009  0.15490  0.19345] , precision= [ 0.02050  0.01998  0.01734  0.01457] , auc=[0.82452]
test.sh: line 49: -gpu_id: command not found
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross1', dropout=0.3, emb_dim=200, gamma=1.0, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, type=3, weight=None)
2022-02-08 00:42:38
loading data...
[n_users, n_items]=[3209, 12211]
[n_train, n_test]=[2636, 1318]
[n_edges]=[280090]
Using GPU 0,  memory_free: 24265
tensor([-0.0332,  0.0305, -0.0300,  0.0194, -0.0069], device='cuda:0')
Loading Model..Number of Model Parameters:  3324802
Epoch 0 [33.0s + 10.2s]: train==[27.51873 = 4.36713 + 23.15159], recall= [ 0.00000  0.00085  0.00085  0.00171] , precision= [ 0.00000  0.00017  0.00009  0.00011] , auc=[0.46444], sum_recall=[0.00342]
Epoch 1 [33.2s + 11.1s]: train==[24.89008 = 1.77898 + 23.11110], recall= [ 0.02235  0.07252  0.10452  0.12740] , precision= [ 0.02477  0.01588  0.01161  0.00945] , auc=[0.70338], sum_recall=[0.32678]
Epoch 2 [33.3s + 11.9s]: train==[24.08173 = 1.09578 + 22.98595], recall= [ 0.02576  0.09477  0.14352  0.17554] , precision= [ 0.02818  0.02118  0.01614  0.01309] , auc=[0.76969], sum_recall=[0.43959]
Epoch 3 [33.2s + 12.1s]: train==[23.68766 = 0.85543 + 22.83223], recall= [ 0.02790  0.09705  0.15092  0.19045] , precision= [ 0.02989  0.02135  0.01665  0.01412] , auc=[0.78987], sum_recall=[0.46631]
Epoch 4 [33.2s + 11.9s]: train==[23.39829 = 0.73123 + 22.66706], recall= [ 0.02690  0.10239  0.16174  0.19547] , precision= [ 0.02989  0.02254  0.01785  0.01440] , auc=[0.79921], sum_recall=[0.48649]
Epoch 5 [33.4s + 13.2s]: train==[23.16892 = 0.66660 + 22.50232], recall= [ 0.02213  0.10292  0.16117  0.19789] , precision= [ 0.02477  0.02289  0.01793  0.01446] , auc=[0.80547], sum_recall=[0.48410]
Epoch 6 [33.7s + 12.2s]: train==[22.97509 = 0.62291 + 22.35218], recall= [ 0.02306  0.10335  0.16643  0.19632] , precision= [ 0.02562  0.02306  0.01845  0.01440] , auc=[0.80933], sum_recall=[0.48916]
Epoch 7 [33.3s + 13.0s]: train==[22.83405 = 0.61210 + 22.22195], recall= [ 0.02434  0.10470  0.16999  0.19654] , precision= [ 0.02647  0.02357  0.01887  0.01452] , auc=[0.81229], sum_recall=[0.49556]
Epoch 8 [33.4s + 12.9s]: train==[22.70076 = 0.59674 + 22.10402], recall= [ 0.02790  0.10357  0.16938  0.20271] , precision= [ 0.02989  0.02306  0.01896  0.01509] , auc=[0.81476], sum_recall=[0.50356]
Epoch 9 [33.5s + 14.2s]: train==[22.53530 = 0.56999 + 21.96531], recall= [ 0.02960  0.10507  0.17018  0.20613] , precision= [ 0.03160  0.02357  0.01896  0.01549] , auc=[0.81673], sum_recall=[0.51098]
Epoch 10 [33.6s + 12.8s]: train==[22.26628 = 0.53744 + 21.72884], recall= [ 0.03074  0.10763  0.17652  0.20835] , precision= [ 0.03330  0.02408  0.01964  0.01554] , auc=[0.81817], sum_recall=[0.52324]
Epoch 11 [33.3s + 12.2s]: train==[21.85648 = 0.51820 + 21.33827], recall= [ 0.02989  0.10649  0.17669  0.21081] , precision= [ 0.03245  0.02374  0.01973  0.01566] , auc=[0.81920], sum_recall=[0.52388]
Epoch 12 [33.4s + 12.0s]: train==[21.35808 = 0.51104 + 20.84704], recall= [ 0.03089  0.10393  0.17455  0.21327] , precision= [ 0.03416  0.02323  0.01956  0.01577] , auc=[0.81982], sum_recall=[0.52263]
Epoch 13 [33.2s + 11.7s]: train==[20.96595 = 0.50107 + 20.46489], recall= [ 0.02960  0.10468  0.17071  0.21420] , precision= [ 0.03245  0.02374  0.01913  0.01594] , auc=[0.82017], sum_recall=[0.51919]
Epoch 14 [33.3s + 12.3s]: train==[20.71056 = 0.51751 + 20.19304], recall= [ 0.02932  0.10243  0.17078  0.21314] , precision= [ 0.03160  0.02306  0.01921  0.01594] , auc=[0.82074], sum_recall=[0.51567]
Epoch 15 [33.3s + 11.7s]: train==[20.58506 = 0.53225 + 20.05281], recall= [ 0.03017  0.09923  0.16847  0.21043] , precision= [ 0.03245  0.02254  0.01887  0.01571] , auc=[0.82191], sum_recall=[0.50831]
Epoch 16 [33.2s + 11.7s]: train==[20.46283 = 0.55437 + 19.90846], recall= [ 0.02797  0.09795  0.16591  0.20783] , precision= [ 0.03074  0.02237  0.01862  0.01566] , auc=[0.82363], sum_recall=[0.49966]
Epoch 17 [33.2s + 12.2s]: train==[20.33912 = 0.55271 + 19.78642], recall= [ 0.02455  0.10056  0.16103  0.19836] , precision= [ 0.02733  0.02254  0.01819  0.01509] , auc=[0.82583], sum_recall=[0.48450]
Epoch 18 [33.3s + 12.1s]: train==[20.24512 = 0.53668 + 19.70844], recall= [ 0.02284  0.09863  0.15428  0.19239] , precision= [ 0.02562  0.02203  0.01751  0.01469] , auc=[0.82792], sum_recall=[0.46815]
Epoch 19 [34.3s + 13.2s]: train==[20.18799 = 0.54585 + 19.64214], recall= [ 0.02114  0.09294  0.15381  0.18641] , precision= [ 0.02391  0.02067  0.01742  0.01429] , auc=[0.82903], sum_recall=[0.45429]
Epoch 20 [34.9s + 17.4s]: train==[20.18442 = 0.55124 + 19.63318], recall= [ 0.02114  0.09123  0.14680  0.18299] , precision= [ 0.02391  0.02032  0.01665  0.01406] , auc=[0.82877], sum_recall=[0.44216]
Epoch 21 [35.4s + 15.8s]: train==[20.15837 = 0.55253 + 19.60584], recall= [ 0.02028  0.08910  0.14567  0.18124] , precision= [ 0.02306  0.01981  0.01648  0.01389] , auc=[0.82825], sum_recall=[0.43628]
Epoch 22 [34.3s + 16.1s]: train==[20.11782 = 0.54126 + 19.57656], recall= [ 0.02028  0.09081  0.14439  0.18081] , precision= [ 0.02306  0.02015  0.01631  0.01389] , auc=[0.82792], sum_recall=[0.43628]
Epoch 23 [36.2s + 15.8s]: train==[20.08258 = 0.52381 + 19.55877], recall= [ 0.02199  0.09237  0.14382  0.18166] , precision= [ 0.02477  0.02067  0.01631  0.01395] , auc=[0.82817], sum_recall=[0.43984]
Epoch 24 [34.0s + 15.0s]: train==[20.06204 = 0.50268 + 19.55936], recall= [ 0.01957  0.09034  0.14581  0.18800] , precision= [ 0.02306  0.02050  0.01648  0.01429] , auc=[0.82771], sum_recall=[0.44372]
Epoch 25 [36.0s + 15.2s]: train==[20.06333 = 0.49956 + 19.56377], recall= [ 0.02000  0.09333  0.14846  0.19440] , precision= [ 0.02391  0.02118  0.01682  0.01469] , auc=[0.82756], sum_recall=[0.45619]
Epoch 26 [34.3s + 16.4s]: train==[20.02828 = 0.48634 + 19.54194], recall= [ 0.01914  0.09675  0.15273  0.19568] , precision= [ 0.02306  0.02186  0.01725  0.01480] , auc=[0.82728], sum_recall=[0.46430]
Epoch 27 [34.3s + 18.3s]: train==[19.98190 = 0.43892 + 19.54298], recall= [ 0.02042  0.09803  0.15443  0.20142] , precision= [ 0.02391  0.02203  0.01742  0.01520] , auc=[0.82704], sum_recall=[0.47431]
Epoch 28 [34.3s + 15.7s]: train==[19.96107 = 0.43348 + 19.52759], recall= [ 0.02106  0.10038  0.15991  0.20441] , precision= [ 0.02391  0.02237  0.01793  0.01537] , auc=[0.82660], sum_recall=[0.48577]
Epoch 29 [34.1s + 16.1s]: train==[19.95383 = 0.41308 + 19.54075], recall= [ 0.02277  0.10080  0.16098  0.20313] , precision= [ 0.02562  0.02254  0.01802  0.01520] , auc=[0.82613], sum_recall=[0.48769]
End of trainning! Best recall= [ 0.02114  0.09294  0.15381  0.18641] , precision= [ 0.02391  0.02067  0.01742  0.01429] , auc=[0.82903]
test.sh: line 49: -gpu_id: command not found
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross1', dropout=0.3, emb_dim=200, gamma=1.0, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, type=3, weight=None)
2022-02-08 01:06:28
loading data...
[n_users, n_items]=[3209, 12211]
[n_train, n_test]=[2636, 1318]
[n_edges]=[280090]
Using GPU 0,  memory_free: 24265
tensor([ 0.0231,  0.0098,  0.0060,  0.0194, -0.0167], device='cuda:0')
Loading Model..Number of Model Parameters:  3324802
Epoch 0 [32.6s + 9.7s]: train==[27.60017 = 4.44959 + 23.15057], recall= [ 0.00000  0.00000  0.00000  0.00085] , precision= [ 0.00000  0.00000  0.00000  0.00006] , auc=[0.47321], sum_recall=[0.00085]
Epoch 1 [32.7s + 10.8s]: train==[24.89507 = 1.78013 + 23.11494], recall= [ 0.02135  0.07526  0.11082  0.13562] , precision= [ 0.02391  0.01674  0.01230  0.01013] , auc=[0.71951], sum_recall=[0.34304]
Epoch 2 [32.9s + 11.7s]: train==[24.07370 = 1.08821 + 22.98549], recall= [ 0.02377  0.09580  0.14868  0.18330] , precision= [ 0.02562  0.02152  0.01657  0.01355] , auc=[0.78117], sum_recall=[0.45155]
Epoch 3 [33.0s + 11.9s]: train==[23.69529 = 0.86744 + 22.82785], recall= [ 0.02804  0.10189  0.16085  0.19312] , precision= [ 0.02989  0.02237  0.01768  0.01418] , auc=[0.79539], sum_recall=[0.48389]
Epoch 4 [37.3s + 12.0s]: train==[23.40166 = 0.73942 + 22.66224], recall= [ 0.02704  0.10416  0.16675  0.19582] , precision= [ 0.02904  0.02272  0.01827  0.01440] , auc=[0.80158], sum_recall=[0.49378]
Epoch 5 [32.8s + 11.9s]: train==[23.18539 = 0.68558 + 22.49982], recall= [ 0.02391  0.10345  0.16794  0.20199] , precision= [ 0.02647  0.02254  0.01853  0.01486] , auc=[0.80509], sum_recall=[0.49730]
Epoch 6 [33.0s + 12.1s]: train==[22.98672 = 0.63383 + 22.35290], recall= [ 0.02662  0.10502  0.16688  0.20103] , precision= [ 0.02818  0.02289  0.01853  0.01480] , auc=[0.80751], sum_recall=[0.49954]
Epoch 7 [33.1s + 12.6s]: train==[22.85129 = 0.62662 + 22.22468], recall= [ 0.02662  0.10319  0.16858  0.20103] , precision= [ 0.02904  0.02237  0.01870  0.01480] , auc=[0.80995], sum_recall=[0.49942]
Epoch 8 [32.9s + 12.4s]: train==[22.72054 = 0.61067 + 22.10987], recall= [ 0.02918  0.10381  0.16986  0.20313] , precision= [ 0.03160  0.02289  0.01887  0.01503] , auc=[0.81242], sum_recall=[0.50598]
Epoch 9 [33.0s + 13.3s]: train==[22.54628 = 0.57616 + 21.97012], recall= [ 0.02747  0.10680  0.17131  0.20399] , precision= [ 0.02989  0.02357  0.01904  0.01509] , auc=[0.81492], sum_recall=[0.50956]
Epoch 10 [34.3s + 12.7s]: train==[22.28701 = 0.55702 + 21.73000], recall= [ 0.02605  0.11064  0.17270  0.20626] , precision= [ 0.02904  0.02442  0.01921  0.01526] , auc=[0.81705], sum_recall=[0.51565]
Epoch 11 [33.0s + 12.4s]: train==[21.86406 = 0.52856 + 21.33550], recall= [ 0.02788  0.10893  0.17372  0.20750] , precision= [ 0.03160  0.02408  0.01947  0.01543] , auc=[0.81863], sum_recall=[0.51803]
Epoch 12 [34.4s + 12.6s]: train==[21.36483 = 0.52026 + 20.84457], recall= [ 0.02989  0.11331  0.17223  0.20750] , precision= [ 0.03245  0.02511  0.01930  0.01543] , auc=[0.81954], sum_recall=[0.52293]
Epoch 13 [33.2s + 12.9s]: train==[20.98138 = 0.51464 + 20.46674], recall= [ 0.02733  0.11591  0.17094  0.20482] , precision= [ 0.02989  0.02562  0.01913  0.01520] , auc=[0.82036], sum_recall=[0.51900]
Epoch 14 [36.5s + 12.1s]: train==[20.73432 = 0.53008 + 20.20424], recall= [ 0.02448  0.11322  0.17311  0.20584] , precision= [ 0.02647  0.02494  0.01939  0.01531] , auc=[0.82155], sum_recall=[0.51665]
Epoch 15 [33.0s + 12.8s]: train==[20.58978 = 0.54112 + 20.04866], recall= [ 0.02647  0.10938  0.17042  0.20308] , precision= [ 0.02904  0.02408  0.01913  0.01526] , auc=[0.82305], sum_recall=[0.50936]
Epoch 16 [34.9s + 14.1s]: train==[20.48264 = 0.57099 + 19.91166], recall= [ 0.02690  0.10554  0.16957  0.19824] , precision= [ 0.02904  0.02340  0.01904  0.01503] , auc=[0.82458], sum_recall=[0.50024]
Epoch 17 [33.0s + 12.2s]: train==[20.35414 = 0.57014 + 19.78399], recall= [ 0.02711  0.10394  0.16551  0.19354] , precision= [ 0.02989  0.02306  0.01870  0.01475] , auc=[0.82598], sum_recall=[0.49010]
Epoch 18 [33.1s + 13.0s]: train==[20.26242 = 0.54975 + 19.71268], recall= [ 0.02519  0.10268  0.15613  0.19354] , precision= [ 0.02733  0.02272  0.01785  0.01475] , auc=[0.82711], sum_recall=[0.47755]
Epoch 19 [33.0s + 12.3s]: train==[20.22968 = 0.56660 + 19.66308], recall= [ 0.02519  0.10005  0.14694  0.19281] , precision= [ 0.02818  0.02220  0.01665  0.01475] , auc=[0.82789], sum_recall=[0.46499]
Epoch 20 [33.0s + 12.4s]: train==[20.21374 = 0.56731 + 19.64642], recall= [ 0.02263  0.09760  0.14535  0.18683] , precision= [ 0.02562  0.02169  0.01657  0.01429] , auc=[0.82811], sum_recall=[0.45241]
Epoch 21 [36.4s + 12.8s]: train==[20.18427 = 0.56962 + 19.61465], recall= [ 0.02178  0.09504  0.14683  0.18726] , precision= [ 0.02477  0.02118  0.01657  0.01429] , auc=[0.82765], sum_recall=[0.45090]
Epoch 22 [37.0s + 12.5s]: train==[20.14505 = 0.55931 + 19.58573], recall= [ 0.02135  0.09504  0.14683  0.18640] , precision= [ 0.02391  0.02118  0.01657  0.01423] , auc=[0.82741], sum_recall=[0.44962]
Epoch 23 [36.8s + 13.0s]: train==[20.10887 = 0.53892 + 19.56994], recall= [ 0.02363  0.09606  0.14610  0.18786] , precision= [ 0.02562  0.02152  0.01657  0.01423] , auc=[0.82753], sum_recall=[0.45365]
Epoch 24 [37.0s + 12.8s]: train==[20.08091 = 0.51485 + 19.56606], recall= [ 0.02363  0.09350  0.14596  0.18914] , precision= [ 0.02733  0.02101  0.01648  0.01440] , auc=[0.82780], sum_recall=[0.45223]
Epoch 25 [36.9s + 13.1s]: train==[20.07787 = 0.51200 + 19.56588], recall= [ 0.02448  0.09606  0.15125  0.19284] , precision= [ 0.02818  0.02152  0.01725  0.01463] , auc=[0.82793], sum_recall=[0.46464]
Epoch 26 [36.9s + 11.9s]: train==[20.05369 = 0.49767 + 19.55602], recall= [ 0.02619  0.09628  0.15510  0.19434] , precision= [ 0.02989  0.02169  0.01768  0.01480] , auc=[0.82829], sum_recall=[0.47190]
Epoch 27 [36.9s + 12.4s]: train==[20.00799 = 0.45966 + 19.54833], recall= [ 0.02847  0.09713  0.15723  0.19673] , precision= [ 0.03160  0.02186  0.01793  0.01492] , auc=[0.82822], sum_recall=[0.47956]
Epoch 28 [37.0s + 12.1s]: train==[19.98575 = 0.44389 + 19.54186], recall= [ 0.02761  0.10055  0.16181  0.19929] , precision= [ 0.03074  0.02254  0.01836  0.01509] , auc=[0.82783], sum_recall=[0.48926]
Epoch 29 [36.9s + 12.0s]: train==[19.97727 = 0.42636 + 19.55090], recall= [ 0.02590  0.10510  0.16266  0.20100] , precision= [ 0.02904  0.02357  0.01845  0.01520] , auc=[0.82745], sum_recall=[0.49466]
Epoch 30 [37.0s + 12.1s]: train==[19.93625 = 0.40770 + 19.52855], recall= [ 0.02590  0.10425  0.16521  0.20356] , precision= [ 0.02904  0.02340  0.01862  0.01537] , auc=[0.82711], sum_recall=[0.49892]
Epoch 31 [37.2s + 12.2s]: train==[19.92405 = 0.37807 + 19.54598], recall= [ 0.02790  0.10596  0.16599  0.20719] , precision= [ 0.03160  0.02374  0.01870  0.01560] , auc=[0.82674], sum_recall=[0.50703]
Epoch 32 [33.2s + 12.3s]: train==[19.91873 = 0.38887 + 19.52986], recall= [ 0.02790  0.10524  0.16633  0.21055] , precision= [ 0.03160  0.02340  0.01870  0.01583] , auc=[0.82639], sum_recall=[0.51001]
Epoch 33 [33.2s + 12.7s]: train==[19.88172 = 0.36247 + 19.51925], recall= [ 0.02619  0.10524  0.17230  0.20820] , precision= [ 0.02989  0.02340  0.01930  0.01566] , auc=[0.82620], sum_recall=[0.51194]
Epoch 34 [35.4s + 14.2s]: train==[19.86052 = 0.35224 + 19.50827], recall= [ 0.02533  0.10892  0.17166  0.21026] , precision= [ 0.02904  0.02408  0.01930  0.01577] , auc=[0.82625], sum_recall=[0.51618]
Epoch 35 [37.0s + 12.3s]: train==[19.85520 = 0.34220 + 19.51300], recall= [ 0.02491  0.10909  0.17209  0.20969] , precision= [ 0.02904  0.02425  0.01921  0.01566] , auc=[0.82643], sum_recall=[0.51578]
Epoch 36 [37.2s + 12.0s]: train==[19.79600 = 0.31500 + 19.48100], recall= [ 0.02576  0.10935  0.16996  0.21097] , precision= [ 0.02989  0.02442  0.01896  0.01577] , auc=[0.82655], sum_recall=[0.51604]
End of trainning! Best recall= [ 0.02619  0.09628  0.15510  0.19434] , precision= [ 0.02989  0.02169  0.01768  0.01480] , auc=[0.82829]
test.sh: line 49: -gpu_id: command not found
