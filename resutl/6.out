Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross0', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200,200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-24 10:05:00
loading data...
[n_users, n_items]=[3209, 12211]
[n_train, n_test]=[2636, 1318]
[n_edges]=[285362]
Using GPU 0,  memory_free: 20119
tensor([-0.0217, -0.0237,  0.0375, -0.0408, -0.0372], device='cuda:0')
Loading Model..Number of Model Parameters:  3485402
Epoch 0 [40.4s + 9.5s]: train==[5.16282 = 2.84894 + 2.31388], recall= [ 0.00384  0.00901  0.01278  0.01452] , precision= [ 0.00522  0.00243  0.00165  0.00122] , auc=[0.47569], sum_recall=[0.04016]
Epoch 1 [39.2s + 9.6s]: train==[3.67361 = 1.36043 + 2.31318], recall= [ 0.01698  0.07126  0.11261  0.13587] , precision= [ 0.02087  0.01635  0.01278  0.01026] , auc=[0.65940], sum_recall=[0.33672]
Epoch 2 [39.2s + 10.0s]: train==[3.11232 = 0.80862 + 2.30370], recall= [ 0.01899  0.09346  0.14871  0.18303] , precision= [ 0.02261  0.02104  0.01670  0.01386] , auc=[0.76187], sum_recall=[0.44419]
Epoch 3 [39.6s + 11.8s]: train==[2.92097 = 0.62819 + 2.29278], recall= [ 0.02246  0.09957  0.16421  0.19460] , precision= [ 0.02609  0.02226  0.01852  0.01461] , auc=[0.78764], sum_recall=[0.48084]
Epoch 4 [39.2s + 11.3s]: train==[2.78984 = 0.50722 + 2.28261], recall= [ 0.02246  0.10438  0.16675  0.20575] , precision= [ 0.02609  0.02348  0.01887  0.01548] , auc=[0.79580], sum_recall=[0.49935]
Epoch 5 [39.1s + 11.2s]: train==[2.71914 = 0.44484 + 2.27430], recall= [ 0.02301  0.10286  0.17029  0.21049] , precision= [ 0.02783  0.02313  0.01939  0.01588] , auc=[0.80083], sum_recall=[0.50664]
Epoch 6 [39.2s + 11.9s]: train==[2.66863 = 0.40037 + 2.26826], recall= [ 0.02518  0.10738  0.17076  0.21271] , precision= [ 0.03043  0.02452  0.01948  0.01600] , auc=[0.80468], sum_recall=[0.51603]
Epoch 7 [39.1s + 11.6s]: train==[2.62581 = 0.36145 + 2.26437], recall= [ 0.02507  0.10473  0.17507  0.21343] , precision= [ 0.02957  0.02383  0.01991  0.01606] , auc=[0.80898], sum_recall=[0.51830]
Epoch 8 [39.1s + 11.2s]: train==[2.59288 = 0.33077 + 2.26211], recall= [ 0.02547  0.10441  0.17301  0.21731] , precision= [ 0.02957  0.02365  0.01965  0.01623] , auc=[0.81191], sum_recall=[0.52021]
Epoch 9 [39.0s + 11.6s]: train==[2.56553 = 0.30477 + 2.26076], recall= [ 0.02286  0.10622  0.17313  0.21166] , precision= [ 0.02696  0.02400  0.01957  0.01588] , auc=[0.81465], sum_recall=[0.51388]
Epoch 10 [39.2s + 11.6s]: train==[2.54162 = 0.28174 + 2.25988], recall= [ 0.02692  0.11176  0.17128  0.20995] , precision= [ 0.03130  0.02504  0.01930  0.01588] , auc=[0.81696], sum_recall=[0.51992]
Epoch 11 [39.4s + 11.4s]: train==[2.52241 = 0.26372 + 2.25869], recall= [ 0.02446  0.11205  0.17128  0.20608] , precision= [ 0.02783  0.02522  0.01930  0.01554] , auc=[0.81867], sum_recall=[0.51387]
Epoch 12 [39.3s + 11.5s]: train==[2.51168 = 0.25426 + 2.25742], recall= [ 0.02315  0.11104  0.17128  0.20725] , precision= [ 0.02696  0.02470  0.01930  0.01565] , auc=[0.81905], sum_recall=[0.51272]
Epoch 13 [39.1s + 11.8s]: train==[2.48655 = 0.23097 + 2.25557], recall= [ 0.02228  0.10799  0.16737  0.20734] , precision= [ 0.02609  0.02417  0.01887  0.01571] , auc=[0.82053], sum_recall=[0.50499]
Epoch 14 [39.2s + 11.4s]: train==[2.47522 = 0.22172 + 2.25350], recall= [ 0.02083  0.10611  0.16592  0.20517] , precision= [ 0.02522  0.02383  0.01878  0.01548] , auc=[0.82134], sum_recall=[0.49803]
Epoch 15 [39.4s + 13.6s]: train==[2.46464 = 0.21339 + 2.25125], recall= [ 0.02257  0.10393  0.16853  0.21082] , precision= [ 0.02696  0.02330  0.01904  0.01588] , auc=[0.82202], sum_recall=[0.50586]
Epoch 16 [39.4s + 11.2s]: train==[2.45491 = 0.20573 + 2.24918], recall= [ 0.02170  0.10393  0.17319  0.20647] , precision= [ 0.02609  0.02330  0.01957  0.01559] , auc=[0.82299], sum_recall=[0.50530]
Epoch 17 [39.4s + 10.8s]: train==[2.43866 = 0.19178 + 2.24688], recall= [ 0.02344  0.10553  0.17210  0.20778] , precision= [ 0.02783  0.02383  0.01957  0.01571] , auc=[0.82469], sum_recall=[0.50885]
Epoch 18 [39.5s + 11.5s]: train==[2.43887 = 0.19406 + 2.24481], recall= [ 0.02431  0.10622  0.17163  0.21195] , precision= [ 0.02870  0.02400  0.01957  0.01594] , auc=[0.82562], sum_recall=[0.51411]
Epoch 19 [39.3s + 11.8s]: train==[2.42284 = 0.18025 + 2.24259], recall= [ 0.02605  0.10999  0.17250  0.21440] , precision= [ 0.03043  0.02487  0.01965  0.01617] , auc=[0.82653], sum_recall=[0.52293]
Epoch 20 [39.3s + 11.8s]: train==[2.41952 = 0.17959 + 2.23993], recall= [ 0.02344  0.10955  0.17336  0.21440] , precision= [ 0.02783  0.02470  0.01974  0.01617] , auc=[0.82699], sum_recall=[0.52075]
Epoch 21 [39.1s + 11.5s]: train==[2.40901 = 0.17182 + 2.23719], recall= [ 0.02431  0.10955  0.17163  0.21440] , precision= [ 0.02870  0.02470  0.01957  0.01617] , auc=[0.82744], sum_recall=[0.51988]
Epoch 22 [39.2s + 11.5s]: train==[2.40179 = 0.16759 + 2.23421], recall= [ 0.02518  0.11187  0.17597  0.21483] , precision= [ 0.02957  0.02504  0.02000  0.01623] , auc=[0.82734], sum_recall=[0.52786]
Epoch 23 [39.3s + 11.3s]: train==[2.39636 = 0.16515 + 2.23121], recall= [ 0.02605  0.10937  0.17380  0.21483] , precision= [ 0.03043  0.02470  0.01974  0.01623] , auc=[0.82701], sum_recall=[0.52405]
Epoch 24 [39.4s + 11.5s]: train==[2.39117 = 0.16293 + 2.22825], recall= [ 0.02344  0.10676  0.17423  0.21734] , precision= [ 0.02783  0.02435  0.01983  0.01635] , auc=[0.82709], sum_recall=[0.52178]
Epoch 25 [39.2s + 11.5s]: train==[2.38185 = 0.15668 + 2.22517], recall= [ 0.02431  0.10749  0.17597  0.21821] , precision= [ 0.02870  0.02470  0.02009  0.01641] , auc=[0.82692], sum_recall=[0.52598]
Epoch 26 [39.4s + 11.4s]: train==[2.38048 = 0.15839 + 2.22209], recall= [ 0.02518  0.10683  0.17989  0.21821] , precision= [ 0.02957  0.02435  0.02043  0.01641] , auc=[0.82729], sum_recall=[0.53011]
Epoch 27 [39.3s + 11.3s]: train==[2.37649 = 0.15750 + 2.21899], recall= [ 0.02228  0.10868  0.17786  0.21843] , precision= [ 0.02609  0.02470  0.02017  0.01641] , auc=[0.82716], sum_recall=[0.52725]
Epoch 28 [39.3s + 12.1s]: train==[2.36763 = 0.15155 + 2.21608], recall= [ 0.02576  0.10774  0.17786  0.22060] , precision= [ 0.02957  0.02417  0.02026  0.01658] , auc=[0.82735], sum_recall=[0.53196]
Epoch 29 [39.5s + 11.1s]: train==[2.36135 = 0.14836 + 2.21299], recall= [ 0.02489  0.11006  0.17655  0.22162] , precision= [ 0.02870  0.02487  0.02009  0.01664] , auc=[0.82709], sum_recall=[0.53312]
Epoch 30 [39.2s + 11.4s]: train==[2.35703 = 0.14698 + 2.21004], recall= [ 0.02489  0.11059  0.17742  0.21814] , precision= [ 0.02870  0.02504  0.02017  0.01641] , auc=[0.82587], sum_recall=[0.53104]
Epoch 31 [39.2s + 11.8s]: train==[2.35464 = 0.14752 + 2.20712], recall= [ 0.02576  0.10900  0.17699  0.21553] , precision= [ 0.02957  0.02470  0.02009  0.01623] , auc=[0.82524], sum_recall=[0.52728]
End of trainning! Best recall= [ 0.02431  0.10955  0.17163  0.21440] , precision= [ 0.02870  0.02470  0.01957  0.01617] , auc=[0.82744]
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross0', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200,200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-24 10:32:23
loading data...
[n_users, n_items]=[3209, 12211]
[n_train, n_test]=[2636, 1318]
[n_edges]=[285362]
Using GPU 0,  memory_free: 20119
tensor([ 0.0229,  0.0336, -0.0387,  0.0376,  0.0074], device='cuda:0')
Loading Model..Number of Model Parameters:  3485402
Epoch 0 [40.1s + 12.1s]: train==[5.21176 = 2.89090 + 2.32085], recall= [ 0.00174  0.01174  0.01536  0.01938] , precision= [ 0.00174  0.00243  0.00165  0.00145] , auc=[0.50279], sum_recall=[0.04822]
Epoch 1 [40.5s + 11.8s]: train==[3.76346 = 1.44248 + 2.32099], recall= [ 0.01087  0.06244  0.10229  0.13021] , precision= [ 0.01217  0.01461  0.01165  0.00980] , auc=[0.64661], sum_recall=[0.30582]
Epoch 2 [43.2s + 11.6s]: train==[3.13723 = 0.82649 + 2.31074], recall= [ 0.01703  0.08517  0.15005  0.18765] , precision= [ 0.02000  0.01965  0.01713  0.01409] , auc=[0.76170], sum_recall=[0.43990]
Epoch 3 [40.1s + 23.4s]: train==[2.95895 = 0.66027 + 2.29867], recall= [ 0.01949  0.09958  0.16168  0.19829] , precision= [ 0.02348  0.02296  0.01835  0.01496] , auc=[0.78584], sum_recall=[0.47905]
Epoch 4 [40.8s + 13.9s]: train==[2.82241 = 0.53544 + 2.28697], recall= [ 0.01971  0.09600  0.16516  0.20410] , precision= [ 0.02435  0.02191  0.01861  0.01542] , auc=[0.79300], sum_recall=[0.48497]
Epoch 5 [43.6s + 12.8s]: train==[2.74635 = 0.46943 + 2.27692], recall= [ 0.02145  0.09655  0.16436  0.20700] , precision= [ 0.02609  0.02209  0.01852  0.01554] , auc=[0.79791], sum_recall=[0.48936]
Epoch 6 [42.0s + 13.3s]: train==[2.70293 = 0.43371 + 2.26922], recall= [ 0.02312  0.09857  0.17193  0.20448] , precision= [ 0.02783  0.02243  0.01939  0.01542] , auc=[0.80182], sum_recall=[0.49810]
Epoch 7 [39.6s + 13.6s]: train==[2.65938 = 0.39550 + 2.26388], recall= [ 0.02399  0.09770  0.16942  0.20318] , precision= [ 0.02870  0.02226  0.01922  0.01536] , auc=[0.80360], sum_recall=[0.49428]
Epoch 8 [40.1s + 13.5s]: train==[2.62297 = 0.36232 + 2.26066], recall= [ 0.02442  0.09835  0.16427  0.20666] , precision= [ 0.02870  0.02226  0.01870  0.01559] , auc=[0.80655], sum_recall=[0.49370]
Epoch 9 [42.9s + 13.6s]: train==[2.58831 = 0.32964 + 2.25868], recall= [ 0.02290  0.10183  0.16525  0.20470] , precision= [ 0.02696  0.02296  0.01887  0.01554] , auc=[0.80940], sum_recall=[0.49468]
Epoch 10 [39.8s + 13.5s]: train==[2.56697 = 0.30940 + 2.25757], recall= [ 0.02225  0.10316  0.16543  0.20948] , precision= [ 0.02696  0.02365  0.01887  0.01583] , auc=[0.81301], sum_recall=[0.50032]
Epoch 11 [39.8s + 13.1s]: train==[2.54345 = 0.28689 + 2.25656], recall= [ 0.02464  0.10011  0.16804  0.21209] , precision= [ 0.02870  0.02313  0.01922  0.01600] , auc=[0.81637], sum_recall=[0.50488]
Epoch 12 [39.6s + 13.1s]: train==[2.52619 = 0.27063 + 2.25556], recall= [ 0.02290  0.10319  0.17021  0.20687] , precision= [ 0.02696  0.02365  0.01948  0.01565] , auc=[0.81886], sum_recall=[0.50318]
Epoch 13 [39.7s + 13.3s]: train==[2.49864 = 0.24452 + 2.25412], recall= [ 0.02293  0.10457  0.17326  0.21035] , precision= [ 0.02783  0.02417  0.01974  0.01588] , auc=[0.82041], sum_recall=[0.51111]
Epoch 14 [39.7s + 13.0s]: train==[2.48787 = 0.23559 + 2.25228], recall= [ 0.02467  0.10643  0.16993  0.21325] , precision= [ 0.02957  0.02435  0.01948  0.01612] , auc=[0.82156], sum_recall=[0.51427]
Epoch 15 [39.5s + 13.1s]: train==[2.47975 = 0.22956 + 2.25020], recall= [ 0.02293  0.10469  0.17340  0.21571] , precision= [ 0.02783  0.02400  0.01983  0.01623] , auc=[0.82226], sum_recall=[0.51674]
Epoch 16 [40.0s + 13.4s]: train==[2.46328 = 0.21531 + 2.24797], recall= [ 0.02133  0.10621  0.17601  0.21340] , precision= [ 0.02522  0.02417  0.02009  0.01612] , auc=[0.82315], sum_recall=[0.51695]
Epoch 17 [39.6s + 13.1s]: train==[2.44624 = 0.20088 + 2.24537], recall= [ 0.02162  0.11208  0.17445  0.21253] , precision= [ 0.02609  0.02557  0.02000  0.01606] , auc=[0.82390], sum_recall=[0.52068]
Epoch 18 [40.8s + 13.3s]: train==[2.44872 = 0.20541 + 2.24330], recall= [ 0.02249  0.11199  0.17430  0.21383] , precision= [ 0.02696  0.02539  0.02000  0.01617] , auc=[0.82420], sum_recall=[0.52261]
Epoch 19 [43.0s + 14.2s]: train==[2.42771 = 0.18661 + 2.24111], recall= [ 0.02232  0.11228  0.17445  0.21311] , precision= [ 0.02609  0.02557  0.01991  0.01617] , auc=[0.82381], sum_recall=[0.52215]
Epoch 20 [40.0s + 12.3s]: train==[2.42639 = 0.18781 + 2.23858], recall= [ 0.02217  0.11228  0.17442  0.21108] , precision= [ 0.02522  0.02557  0.01983  0.01594] , auc=[0.82413], sum_recall=[0.51994]
Epoch 21 [39.7s + 13.3s]: train==[2.41528 = 0.17935 + 2.23593], recall= [ 0.02304  0.11422  0.17572  0.21291] , precision= [ 0.02609  0.02626  0.02000  0.01612] , auc=[0.82381], sum_recall=[0.52590]
Epoch 22 [39.7s + 13.1s]: train==[2.40664 = 0.17339 + 2.23325], recall= [ 0.02319  0.11238  0.17483  0.20770] , precision= [ 0.02609  0.02574  0.02000  0.01577] , auc=[0.82311], sum_recall=[0.51810]
Epoch 23 [39.8s + 12.9s]: train==[2.40366 = 0.17360 + 2.23006], recall= [ 0.02464  0.11622  0.17462  0.20871] , precision= [ 0.02696  0.02626  0.01991  0.01588] , auc=[0.82220], sum_recall=[0.52419]
Epoch 24 [39.7s + 12.7s]: train==[2.39592 = 0.16913 + 2.22678], recall= [ 0.02420  0.11362  0.17159  0.20567] , precision= [ 0.02783  0.02574  0.01957  0.01571] , auc=[0.82182], sum_recall=[0.51508]
Epoch 25 [40.9s + 13.7s]: train==[2.38485 = 0.16141 + 2.22345], recall= [ 0.02333  0.10891  0.17451  0.20770] , precision= [ 0.02696  0.02504  0.01983  0.01577] , auc=[0.82206], sum_recall=[0.51445]
Epoch 26 [41.4s + 13.7s]: train==[2.38436 = 0.16468 + 2.21968], recall= [ 0.02290  0.11228  0.17582  0.20770] , precision= [ 0.02522  0.02557  0.02000  0.01577] , auc=[0.82218], sum_recall=[0.51869]
Epoch 27 [41.4s + 12.7s]: train==[2.37835 = 0.16242 + 2.21594], recall= [ 0.02214  0.11141  0.17442  0.21117] , precision= [ 0.02522  0.02539  0.01983  0.01600] , auc=[0.82160], sum_recall=[0.51914]
Epoch 28 [41.0s + 13.7s]: train==[2.37315 = 0.16080 + 2.21234], recall= [ 0.02388  0.11177  0.17442  0.20914] , precision= [ 0.02696  0.02522  0.01983  0.01594] , auc=[0.82131], sum_recall=[0.51921]
End of trainning! Best recall= [ 0.02249  0.11199  0.17430  0.21383] , precision= [ 0.02696  0.02539  0.02000  0.01617] , auc=[0.82420]
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross0', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200,200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-24 10:58:39
loading data...
[n_users, n_items]=[3209, 12211]
[n_train, n_test]=[2636, 1318]
[n_edges]=[285362]
Using GPU 0,  memory_free: 20119
tensor([-0.0090, -0.0011,  0.0075,  0.0396, -0.0207], device='cuda:0')
Loading Model..Number of Model Parameters:  3485402
Epoch 0 [38.5s + 10.1s]: train==[5.22513 = 2.90322 + 2.32191], recall= [ 0.00652  0.01543  0.01978  0.02337] , precision= [ 0.00696  0.00383  0.00235  0.00186] , auc=[0.47983], sum_recall=[0.06511]
Epoch 1 [38.2s + 10.3s]: train==[3.64435 = 1.32361 + 2.32073], recall= [ 0.01837  0.07764  0.11902  0.14020] , precision= [ 0.02000  0.01757  0.01391  0.01084] , auc=[0.66040], sum_recall=[0.35523]
Epoch 2 [38.3s + 10.1s]: train==[3.09753 = 0.78645 + 2.31109], recall= [ 0.02315  0.09301  0.14806  0.18725] , precision= [ 0.02696  0.02122  0.01687  0.01409] , auc=[0.75487], sum_recall=[0.45147]
Epoch 3 [38.4s + 11.2s]: train==[2.90521 = 0.60531 + 2.29990], recall= [ 0.01967  0.10257  0.16255  0.19744] , precision= [ 0.02348  0.02313  0.01843  0.01484] , auc=[0.78124], sum_recall=[0.48224]
Epoch 4 [38.2s + 11.8s]: train==[2.78019 = 0.49058 + 2.28960], recall= [ 0.02076  0.10243  0.15606  0.20497] , precision= [ 0.02522  0.02330  0.01774  0.01536] , auc=[0.79197], sum_recall=[0.48422]
Epoch 5 [38.5s + 11.4s]: train==[2.71412 = 0.43288 + 2.28125], recall= [ 0.02366  0.10217  0.16565  0.20326] , precision= [ 0.02870  0.02330  0.01887  0.01525] , auc=[0.79891], sum_recall=[0.49474]
Epoch 6 [38.4s + 11.8s]: train==[2.66437 = 0.38911 + 2.27525], recall= [ 0.02122  0.10002  0.16783  0.20826] , precision= [ 0.02696  0.02313  0.01904  0.01548] , auc=[0.80341], sum_recall=[0.49734]
Epoch 7 [38.2s + 12.1s]: train==[2.62067 = 0.34926 + 2.27141], recall= [ 0.02293  0.10857  0.17251  0.20899] , precision= [ 0.02696  0.02487  0.01930  0.01554] , auc=[0.80734], sum_recall=[0.51301]
Epoch 8 [38.5s + 11.2s]: train==[2.59132 = 0.32203 + 2.26929], recall= [ 0.02453  0.10292  0.17034  0.21015] , precision= [ 0.02957  0.02365  0.01913  0.01565] , auc=[0.81079], sum_recall=[0.50794]
Epoch 9 [38.3s + 11.5s]: train==[2.56281 = 0.29482 + 2.26799], recall= [ 0.02380  0.10628  0.17411  0.21185] , precision= [ 0.02870  0.02452  0.01965  0.01588] , auc=[0.81357], sum_recall=[0.51605]
Epoch 10 [38.1s + 11.8s]: train==[2.54442 = 0.27744 + 2.26698], recall= [ 0.02398  0.10586  0.17280  0.21088] , precision= [ 0.02957  0.02417  0.01948  0.01571] , auc=[0.81638], sum_recall=[0.51352]
Epoch 11 [38.4s + 11.7s]: train==[2.52540 = 0.25987 + 2.26553], recall= [ 0.02072  0.10332  0.17193  0.20900] , precision= [ 0.02522  0.02400  0.01939  0.01565] , auc=[0.81867], sum_recall=[0.50497]
Epoch 12 [38.5s + 11.4s]: train==[2.51209 = 0.24846 + 2.26363], recall= [ 0.02188  0.10332  0.16962  0.21016] , precision= [ 0.02696  0.02400  0.01922  0.01583] , auc=[0.82008], sum_recall=[0.50497]
Epoch 13 [38.5s + 12.4s]: train==[2.48759 = 0.22658 + 2.26100], recall= [ 0.02101  0.10351  0.16875  0.21233] , precision= [ 0.02609  0.02365  0.01913  0.01594] , auc=[0.82056], sum_recall=[0.50559]
Epoch 14 [38.3s + 11.4s]: train==[2.47833 = 0.22047 + 2.25786], recall= [ 0.02101  0.10438  0.17121  0.20939] , precision= [ 0.02609  0.02383  0.01939  0.01577] , auc=[0.82139], sum_recall=[0.50598]
Epoch 15 [38.4s + 11.5s]: train==[2.46942 = 0.21486 + 2.25456], recall= [ 0.02202  0.10872  0.16962  0.21417] , precision= [ 0.02696  0.02470  0.01922  0.01612] , auc=[0.82185], sum_recall=[0.51453]
Epoch 16 [38.3s + 12.6s]: train==[2.45224 = 0.20085 + 2.25139], recall= [ 0.02318  0.10380  0.17295  0.21417] , precision= [ 0.02870  0.02383  0.01957  0.01612] , auc=[0.82301], sum_recall=[0.51410]
Epoch 17 [38.4s + 11.3s]: train==[2.43803 = 0.18994 + 2.24809], recall= [ 0.02289  0.10945  0.17386  0.21765] , precision= [ 0.02783  0.02504  0.01957  0.01635] , auc=[0.82374], sum_recall=[0.52384]
Epoch 18 [38.3s + 11.7s]: train==[2.43736 = 0.19227 + 2.24509], recall= [ 0.02304  0.11180  0.17396  0.21797] , precision= [ 0.02696  0.02574  0.01957  0.01635] , auc=[0.82423], sum_recall=[0.52677]
Epoch 19 [38.3s + 12.3s]: train==[2.42273 = 0.18071 + 2.24201], recall= [ 0.02217  0.11119  0.17536  0.21536] , precision= [ 0.02609  0.02539  0.01983  0.01617] , auc=[0.82440], sum_recall=[0.52408]
Epoch 20 [38.3s + 11.9s]: train==[2.41539 = 0.17655 + 2.23885], recall= [ 0.02217  0.10988  0.17406  0.21594] , precision= [ 0.02609  0.02522  0.01974  0.01617] , auc=[0.82364], sum_recall=[0.52206]
Epoch 21 [39.0s + 11.6s]: train==[2.40746 = 0.17167 + 2.23579], recall= [ 0.02243  0.11510  0.17179  0.21464] , precision= [ 0.02609  0.02626  0.01939  0.01612] , auc=[0.82385], sum_recall=[0.52396]
Epoch 22 [38.6s + 11.6s]: train==[2.40022 = 0.16734 + 2.23288], recall= [ 0.02185  0.11554  0.17406  0.21421] , precision= [ 0.02609  0.02626  0.01974  0.01606] , auc=[0.82401], sum_recall=[0.52565]
Epoch 23 [39.0s + 11.5s]: train==[2.39740 = 0.16720 + 2.23021], recall= [ 0.02402  0.11496  0.17667  0.21203] , precision= [ 0.02870  0.02591  0.02000  0.01594] , auc=[0.82403], sum_recall=[0.52768]
Epoch 24 [39.0s + 14.5s]: train==[2.39097 = 0.16331 + 2.22766], recall= [ 0.02402  0.11496  0.17551  0.21247] , precision= [ 0.02870  0.02591  0.01991  0.01600] , auc=[0.82449], sum_recall=[0.52695]
Epoch 25 [38.3s + 11.4s]: train==[2.38324 = 0.15772 + 2.22553], recall= [ 0.02576  0.11728  0.17616  0.21290] , precision= [ 0.03043  0.02609  0.01991  0.01600] , auc=[0.82410], sum_recall=[0.53210]
Epoch 26 [38.5s + 11.6s]: train==[2.38282 = 0.15936 + 2.22346], recall= [ 0.02663  0.11467  0.17515  0.21131] , precision= [ 0.03130  0.02539  0.01991  0.01588] , auc=[0.82356], sum_recall=[0.52775]
Epoch 27 [38.3s + 11.5s]: train==[2.37817 = 0.15666 + 2.22151], recall= [ 0.02576  0.11554  0.17457  0.21055] , precision= [ 0.03043  0.02557  0.01974  0.01588] , auc=[0.82379], sum_recall=[0.52641]
Epoch 28 [38.5s + 11.8s]: train==[2.36994 = 0.15008 + 2.21985], recall= [ 0.02663  0.11771  0.17152  0.21174] , precision= [ 0.03130  0.02609  0.01939  0.01594] , auc=[0.82384], sum_recall=[0.52761]
Epoch 29 [38.3s + 12.0s]: train==[2.36459 = 0.14652 + 2.21807], recall= [ 0.02576  0.11757  0.17421  0.20805] , precision= [ 0.03043  0.02609  0.01965  0.01565] , auc=[0.82370], sum_recall=[0.52558]
Epoch 30 [38.6s + 12.6s]: train==[2.36833 = 0.15173 + 2.21660], recall= [ 0.02663  0.11843  0.17026  0.21063] , precision= [ 0.03130  0.02626  0.01913  0.01571] , auc=[0.82359], sum_recall=[0.52595]
Epoch 31 [39.0s + 11.9s]: train==[2.36238 = 0.14718 + 2.21521], recall= [ 0.02707  0.11539  0.16939  0.21005] , precision= [ 0.03130  0.02574  0.01904  0.01571] , auc=[0.82311], sum_recall=[0.52190]
Epoch 32 [40.5s + 12.7s]: train==[2.35905 = 0.14517 + 2.21388], recall= [ 0.02663  0.11652  0.17348  0.21305] , precision= [ 0.03130  0.02574  0.01957  0.01594] , auc=[0.82338], sum_recall=[0.52968]
Epoch 33 [39.4s + 12.4s]: train==[2.35580 = 0.14321 + 2.21259], recall= [ 0.02707  0.11696  0.17000  0.21391] , precision= [ 0.03130  0.02591  0.01913  0.01606] , auc=[0.82357], sum_recall=[0.52793]
Epoch 34 [39.4s + 12.4s]: train==[2.34853 = 0.13732 + 2.21121], recall= [ 0.02924  0.11565  0.16957  0.21289] , precision= [ 0.03391  0.02574  0.01913  0.01600] , auc=[0.82383], sum_recall=[0.52735]
End of trainning! Best recall= [ 0.02402  0.11496  0.17551  0.21247] , precision= [ 0.02870  0.02591  0.01991  0.01600] , auc=[0.82449]
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross0', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200,200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-24 11:28:09
loading data...
[n_users, n_items]=[3209, 12211]
[n_train, n_test]=[2636, 1318]
[n_edges]=[285362]
Using GPU 0,  memory_free: 18062
tensor([-0.0353,  0.0354,  0.0174,  0.0256, -0.0059], device='cuda:0')
Loading Model..Number of Model Parameters:  3485402
Epoch 0 [40.0s + 10.0s]: train==[5.16570 = 2.85174 + 2.31396], recall= [ 0.00362  0.01188  0.01667  0.02080] , precision= [ 0.00435  0.00278  0.00191  0.00162] , auc=[0.49172], sum_recall=[0.05297]
Epoch 1 [38.7s + 10.4s]: train==[3.64358 = 1.33158 + 2.31199], recall= [ 0.01662  0.06879  0.11083  0.13560] , precision= [ 0.02000  0.01548  0.01261  0.01026] , auc=[0.66065], sum_recall=[0.33184]
Epoch 2 [38.5s + 10.0s]: train==[3.07404 = 0.77167 + 2.30236], recall= [ 0.01891  0.08591  0.15660  0.19125] , precision= [ 0.02261  0.01983  0.01783  0.01449] , auc=[0.75543], sum_recall=[0.45267]
Epoch 3 [38.5s + 12.2s]: train==[2.88354 = 0.59163 + 2.29192], recall= [ 0.01964  0.09799  0.16200  0.19257] , precision= [ 0.02348  0.02261  0.01835  0.01449] , auc=[0.78503], sum_recall=[0.47220]
Epoch 4 [38.6s + 12.0s]: train==[2.75777 = 0.47490 + 2.28288], recall= [ 0.02254  0.10019  0.16447  0.19736] , precision= [ 0.02696  0.02330  0.01878  0.01490] , auc=[0.79722], sum_recall=[0.48455]
Epoch 5 [38.8s + 11.5s]: train==[2.69988 = 0.42390 + 2.27598], recall= [ 0.02844  0.10236  0.16697  0.20188] , precision= [ 0.03304  0.02383  0.01896  0.01525] , auc=[0.80324], sum_recall=[0.49965]
Epoch 6 [38.4s + 12.4s]: train==[2.65802 = 0.38647 + 2.27155], recall= [ 0.03033  0.09845  0.16557  0.21000] , precision= [ 0.03478  0.02313  0.01896  0.01594] , auc=[0.80765], sum_recall=[0.50435]
Epoch 7 [38.8s + 14.7s]: train==[2.61404 = 0.34484 + 2.26920], recall= [ 0.03105  0.10334  0.16992  0.20782] , precision= [ 0.03826  0.02417  0.01939  0.01565] , auc=[0.81151], sum_recall=[0.51214]
Epoch 8 [38.7s + 12.7s]: train==[2.58632 = 0.31795 + 2.26837], recall= [ 0.02815  0.10134  0.17468  0.20768] , precision= [ 0.03478  0.02383  0.01991  0.01571] , auc=[0.81618], sum_recall=[0.51185]
Epoch 9 [39.3s + 13.6s]: train==[2.55587 = 0.28774 + 2.26813], recall= [ 0.02707  0.10417  0.17507  0.20840] , precision= [ 0.03304  0.02417  0.01991  0.01577] , auc=[0.81872], sum_recall=[0.51471]
Epoch 10 [39.3s + 14.8s]: train==[2.53652 = 0.26870 + 2.26782], recall= [ 0.02431  0.10451  0.17681  0.20821] , precision= [ 0.02870  0.02400  0.02000  0.01583] , auc=[0.82189], sum_recall=[0.51384]
Epoch 11 [38.7s + 11.7s]: train==[2.51874 = 0.25199 + 2.26675], recall= [ 0.02417  0.10668  0.17256  0.20919] , precision= [ 0.02957  0.02452  0.01965  0.01588] , auc=[0.82343], sum_recall=[0.51260]
Epoch 12 [38.6s + 11.8s]: train==[2.50531 = 0.24054 + 2.26477], recall= [ 0.02536  0.10625  0.17160  0.20937] , precision= [ 0.03043  0.02452  0.01957  0.01594] , auc=[0.82509], sum_recall=[0.51257]
Epoch 13 [38.4s + 12.1s]: train==[2.47916 = 0.21721 + 2.26194], recall= [ 0.02489  0.10672  0.17073  0.20954] , precision= [ 0.02870  0.02417  0.01948  0.01600] , auc=[0.82550], sum_recall=[0.51188]
Traceback (most recent call last):
  File "main.py", line 92, in <module>
    sc, pos, neg = model(data_generator.adj, entity_embedding, batch=(i, source, pos_target, neg_target))
  File "/home/raojh/anaconda3/envs/IGMC/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/raojh/Workspace/Disease-Gene/model.py", line 224, in forward
    A = sparse_to_tensor(A, self.device)
  File "/home/raojh/Workspace/Disease-Gene/utilty.py", line 89, in sparse_to_tensor
    X = X.tocoo().astype(np.float32)
  File "/home/raojh/anaconda3/envs/IGMC/lib/python3.7/site-packages/scipy/sparse/data.py", line 72, in astype
    self._deduped_data().astype(dtype, casting=casting, copy=copy),
  File "/home/raojh/anaconda3/envs/IGMC/lib/python3.7/site-packages/scipy/sparse/data.py", line 32, in _deduped_data
    self.sum_duplicates()
  File "/home/raojh/anaconda3/envs/IGMC/lib/python3.7/site-packages/scipy/sparse/coo.py", line 533, in sum_duplicates
    summed = self._sum_duplicates(self.row, self.col, self.data)
  File "/home/raojh/anaconda3/envs/IGMC/lib/python3.7/site-packages/scipy/sparse/coo.py", line 541, in _sum_duplicates
    order = np.lexsort((row, col))
  File "<__array_function__ internals>", line 6, in lexsort
KeyboardInterrupt
Traceback (most recent call last):
  File "main.py", line 4, in <module>
    import torch
  File "/home/raojh/anaconda3/envs/IGMC/lib/python3.7/site-packages/torch/__init__.py", line 190, in <module>
    from torch._C import *
RuntimeError: KeyboardInterrupt: 
