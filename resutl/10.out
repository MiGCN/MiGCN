Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross0', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-25 11:37:20
loading data...
[n_users, n_items]=[3209, 12331]
[n_train, n_test]=[2636, 1318]
[n_edges]=[260034]
Using GPU 0,  memory_free: 24265
tensor([ 0.0265,  0.0188, -0.0161, -0.0083,  0.0406], device='cuda:0')
Loading Model..Number of Model Parameters:  3348802
Epoch 0 [32.3s + 9.9s]: train==[5.01223 = 2.69094 + 2.32129], recall= [ 0.00696  0.01754  0.02148  0.02333] , precision= [ 0.00696  0.00365  0.00243  0.00180] , auc=[0.55029], sum_recall=[0.06930]
Epoch 1 [32.7s + 10.2s]: train==[3.35906 = 1.03864 + 2.32041], recall= [ 0.01891  0.06934  0.09211  0.11120] , precision= [ 0.02174  0.01548  0.01043  0.00835] , auc=[0.66764], sum_recall=[0.29156]
Epoch 2 [27.1s + 10.6s]: train==[2.92804 = 0.60914 + 2.31891], recall= [ 0.01942  0.07626  0.10751  0.13240] , precision= [ 0.02261  0.01757  0.01217  0.00997] , auc=[0.70311], sum_recall=[0.33559]
Epoch 3 [26.9s + 11.2s]: train==[2.78457 = 0.46805 + 2.31651], recall= [ 0.01971  0.08321  0.10911  0.14128] , precision= [ 0.02174  0.01913  0.01243  0.01067] , auc=[0.72387], sum_recall=[0.35331]
Epoch 4 [27.0s + 11.5s]: train==[2.70045 = 0.38724 + 2.31321], recall= [ 0.02391  0.08604  0.11432  0.14102] , precision= [ 0.02696  0.01930  0.01304  0.01067] , auc=[0.73702], sum_recall=[0.36529]
Epoch 5 [27.2s + 12.3s]: train==[2.66265 = 0.35364 + 2.30901], recall= [ 0.02531  0.08343  0.11655  0.14232] , precision= [ 0.02957  0.01878  0.01313  0.01078] , auc=[0.74550], sum_recall=[0.36761]
Epoch 6 [27.2s + 11.7s]: train==[2.62499 = 0.32091 + 2.30408], recall= [ 0.02749  0.08179  0.11955  0.14464] , precision= [ 0.03130  0.01861  0.01339  0.01090] , auc=[0.75116], sum_recall=[0.37347]
Epoch 7 [27.1s + 11.3s]: train==[2.59781 = 0.29904 + 2.29878], recall= [ 0.02575  0.08107  0.11940  0.14529] , precision= [ 0.02957  0.01843  0.01330  0.01096] , auc=[0.75485], sum_recall=[0.37151]
Epoch 8 [27.2s + 11.9s]: train==[2.57377 = 0.28023 + 2.29354], recall= [ 0.02604  0.08078  0.11853  0.14500] , precision= [ 0.03043  0.01826  0.01322  0.01090] , auc=[0.75761], sum_recall=[0.37035]
Epoch 9 [27.1s + 12.1s]: train==[2.55594 = 0.26727 + 2.28867], recall= [ 0.02430  0.07991  0.11636  0.14254] , precision= [ 0.02870  0.01809  0.01296  0.01067] , auc=[0.75962], sum_recall=[0.36311]
Epoch 10 [27.0s + 11.6s]: train==[2.54096 = 0.25675 + 2.28422], recall= [ 0.02430  0.07933  0.11752  0.13906] , precision= [ 0.02870  0.01809  0.01313  0.01043] , auc=[0.76127], sum_recall=[0.36021]
Epoch 11 [27.1s + 11.2s]: train==[2.52531 = 0.24542 + 2.27989], recall= [ 0.02246  0.08020  0.11795  0.14124] , precision= [ 0.02609  0.01826  0.01313  0.01061] , auc=[0.76255], sum_recall=[0.36185]
Epoch 12 [27.4s + 11.4s]: train==[2.51126 = 0.23565 + 2.27562], recall= [ 0.02420  0.08020  0.11534  0.14167] , precision= [ 0.02783  0.01826  0.01287  0.01061] , auc=[0.76367], sum_recall=[0.36142]
Epoch 13 [27.2s + 11.9s]: train==[2.49219 = 0.22073 + 2.27145], recall= [ 0.02507  0.08194  0.11491  0.13993] , precision= [ 0.02870  0.01861  0.01287  0.01049] , auc=[0.76490], sum_recall=[0.36185]
Epoch 14 [27.0s + 12.5s]: train==[2.48559 = 0.21812 + 2.26747], recall= [ 0.02594  0.08020  0.11491  0.14269] , precision= [ 0.02957  0.01826  0.01287  0.01072] , auc=[0.76600], sum_recall=[0.36373]
Epoch 15 [27.3s + 12.2s]: train==[2.47735 = 0.21372 + 2.26364], recall= [ 0.02696  0.08049  0.11491  0.14225] , precision= [ 0.03043  0.01843  0.01287  0.01067] , auc=[0.76707], sum_recall=[0.36460]
Epoch 16 [27.1s + 11.7s]: train==[2.46566 = 0.20592 + 2.25973], recall= [ 0.02696  0.07918  0.11602  0.14747] , precision= [ 0.03043  0.01809  0.01313  0.01101] , auc=[0.76822], sum_recall=[0.36963]
Epoch 17 [32.2s + 11.6s]: train==[2.45275 = 0.19724 + 2.25551], recall= [ 0.02609  0.07918  0.11776  0.15062] , precision= [ 0.02957  0.01809  0.01330  0.01130] , auc=[0.76920], sum_recall=[0.37365]
Epoch 18 [26.9s + 11.6s]: train==[2.43941 = 0.18841 + 2.25099], recall= [ 0.02522  0.07901  0.12135  0.15164] , precision= [ 0.02870  0.01791  0.01374  0.01136] , auc=[0.77016], sum_recall=[0.37721]
Epoch 19 [27.2s + 11.8s]: train==[2.43436 = 0.18777 + 2.24658], recall= [ 0.02348  0.08260  0.12308  0.15185] , precision= [ 0.02696  0.01878  0.01391  0.01130] , auc=[0.77112], sum_recall=[0.38101]
Epoch 20 [27.1s + 11.4s]: train==[2.42633 = 0.18411 + 2.24222], recall= [ 0.02174  0.08086  0.12700  0.15098] , precision= [ 0.02522  0.01843  0.01426  0.01125] , auc=[0.77202], sum_recall=[0.38058]
Epoch 21 [27.0s + 11.4s]: train==[2.41643 = 0.17861 + 2.23782], recall= [ 0.02348  0.08347  0.12946  0.15414] , precision= [ 0.02696  0.01896  0.01461  0.01148] , auc=[0.77291], sum_recall=[0.39054]
Epoch 22 [27.3s + 12.3s]: train==[2.41371 = 0.18039 + 2.23332], recall= [ 0.02174  0.08260  0.12830  0.15240] , precision= [ 0.02522  0.01878  0.01443  0.01136] , auc=[0.77367], sum_recall=[0.38503]
Epoch 23 [32.8s + 11.7s]: train==[2.40220 = 0.17358 + 2.22862], recall= [ 0.02261  0.08405  0.12946  0.15500] , precision= [ 0.02609  0.01896  0.01461  0.01154] , auc=[0.77428], sum_recall=[0.39112]
Epoch 24 [32.7s + 12.4s]: train==[2.39118 = 0.16765 + 2.22353], recall= [ 0.02348  0.08752  0.13019  0.15486] , precision= [ 0.02696  0.01965  0.01461  0.01159] , auc=[0.77476], sum_recall=[0.39605]
Epoch 25 [27.5s + 11.6s]: train==[2.38902 = 0.17126 + 2.21776], recall= [ 0.02217  0.08579  0.12932  0.15225] , precision= [ 0.02522  0.01930  0.01452  0.01142] , auc=[0.77524], sum_recall=[0.38953]
Epoch 26 [27.3s + 11.6s]: train==[2.37668 = 0.16556 + 2.21111], recall= [ 0.02217  0.08607  0.12627  0.15312] , precision= [ 0.02522  0.01948  0.01417  0.01148] , auc=[0.77557], sum_recall=[0.38764]
Epoch 27 [27.0s + 12.0s]: train==[2.36351 = 0.15979 + 2.20372], recall= [ 0.02304  0.08825  0.12627  0.15182] , precision= [ 0.02609  0.02000  0.01417  0.01136] , auc=[0.77564], sum_recall=[0.38938]
Epoch 28 [27.1s + 12.5s]: train==[2.35702 = 0.16098 + 2.19605], recall= [ 0.02478  0.09086  0.12566  0.15138] , precision= [ 0.02783  0.02052  0.01409  0.01136] , auc=[0.77571], sum_recall=[0.39269]
Epoch 29 [33.0s + 12.1s]: train==[2.33998 = 0.15244 + 2.18754], recall= [ 0.02652  0.09086  0.12740  0.15515] , precision= [ 0.02957  0.02052  0.01426  0.01165] , auc=[0.77580], sum_recall=[0.39993]
Epoch 30 [27.1s + 11.7s]: train==[2.33520 = 0.15607 + 2.17913], recall= [ 0.02725  0.09042  0.12653  0.15693] , precision= [ 0.02957  0.02035  0.01417  0.01177] , auc=[0.77611], sum_recall=[0.40114]
Epoch 31 [27.1s + 11.3s]: train==[2.31722 = 0.14688 + 2.17034], recall= [ 0.02812  0.08814  0.12740  0.15813] , precision= [ 0.03043  0.01983  0.01426  0.01183] , auc=[0.77690], sum_recall=[0.40179]
Epoch 32 [27.1s + 11.6s]: train==[2.30945 = 0.14717 + 2.16228], recall= [ 0.03072  0.08901  0.12610  0.15965] , precision= [ 0.03304  0.02000  0.01409  0.01200] , auc=[0.77781], sum_recall=[0.40548]
Epoch 33 [27.0s + 11.6s]: train==[2.29581 = 0.14144 + 2.15437], recall= [ 0.03246  0.08901  0.12479  0.15936] , precision= [ 0.03478  0.02000  0.01400  0.01194] , auc=[0.77874], sum_recall=[0.40563]
Epoch 34 [27.1s + 11.9s]: train==[2.28654 = 0.13923 + 2.14731], recall= [ 0.03304  0.08814  0.12458  0.16001] , precision= [ 0.03478  0.01983  0.01409  0.01194] , auc=[0.77946], sum_recall=[0.40577]
Epoch 35 [27.1s + 11.2s]: train==[2.27359 = 0.13323 + 2.14036], recall= [ 0.03478  0.08814  0.12458  0.16059] , precision= [ 0.03652  0.01983  0.01409  0.01194] , auc=[0.77996], sum_recall=[0.40809]
Epoch 36 [26.8s + 11.5s]: train==[2.26406 = 0.12995 + 2.13411], recall= [ 0.03391  0.08553  0.12632  0.15885] , precision= [ 0.03565  0.01930  0.01426  0.01183] , auc=[0.77999], sum_recall=[0.40461]
Epoch 37 [27.0s + 12.0s]: train==[2.26108 = 0.13234 + 2.12874], recall= [ 0.03130  0.08535  0.12588  0.16436] , precision= [ 0.03304  0.01930  0.01417  0.01223] , auc=[0.77964], sum_recall=[0.40690]
Epoch 38 [27.2s + 12.1s]: train==[2.25712 = 0.13306 + 2.12406], recall= [ 0.02879  0.08593  0.12501  0.15972] , precision= [ 0.03130  0.01930  0.01409  0.01188] , auc=[0.77915], sum_recall=[0.39946]
Epoch 39 [31.8s + 11.9s]: train==[2.25769 = 0.13749 + 2.12020], recall= [ 0.02923  0.08767  0.12675  0.15798] , precision= [ 0.03130  0.01965  0.01426  0.01177] , auc=[0.77853], sum_recall=[0.40163]
Epoch 40 [28.1s + 11.7s]: train==[2.24398 = 0.12689 + 2.11710], recall= [ 0.02923  0.08919  0.12854  0.15750] , precision= [ 0.03130  0.02000  0.01443  0.01183] , auc=[0.77823], sum_recall=[0.40446]
Epoch 41 [29.9s + 12.2s]: train==[2.24855 = 0.13436 + 2.11418], recall= [ 0.02923  0.08441  0.12723  0.15620] , precision= [ 0.03130  0.01896  0.01435  0.01177] , auc=[0.77785], sum_recall=[0.39707]
Epoch 42 [31.2s + 12.8s]: train==[2.24840 = 0.13599 + 2.11242], recall= [ 0.02836  0.08528  0.12661  0.15620] , precision= [ 0.03043  0.01913  0.01426  0.01177] , auc=[0.77753], sum_recall=[0.39644]
Epoch 43 [29.7s + 12.6s]: train==[2.24121 = 0.12995 + 2.11126], recall= [ 0.02836  0.08615  0.12864  0.15707] , precision= [ 0.03043  0.01930  0.01452  0.01183] , auc=[0.77693], sum_recall=[0.40021]
Epoch 44 [28.4s + 11.6s]: train==[2.23339 = 0.12354 + 2.10985], recall= [ 0.02792  0.08405  0.12574  0.16011] , precision= [ 0.02957  0.01861  0.01400  0.01206] , auc=[0.77643], sum_recall=[0.39781]
Epoch 45 [28.9s + 11.7s]: train==[2.23363 = 0.12500 + 2.10863], recall= [ 0.02966  0.08992  0.12617  0.15898] , precision= [ 0.03130  0.01965  0.01409  0.01206] , auc=[0.77599], sum_recall=[0.40473]
Epoch 46 [28.5s + 12.3s]: train==[2.22922 = 0.12115 + 2.10808], recall= [ 0.02792  0.08600  0.12443  0.15678] , precision= [ 0.02957  0.01878  0.01391  0.01183] , auc=[0.77561], sum_recall=[0.39513]
End of trainning! Best recall= [ 0.03391  0.08553  0.12632  0.15885] , precision= [ 0.03565  0.01930  0.01426  0.01183] , auc=[0.77999]
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross0', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-25 12:08:47
loading data...
[n_users, n_items]=[3209, 12331]
[n_train, n_test]=[2636, 1318]
[n_edges]=[260034]
Using GPU 0,  memory_free: 24265
tensor([0.0112, 0.0235, 0.0071, 0.0122, 0.0252], device='cuda:0')
Loading Model..Number of Model Parameters:  3348802
Epoch 0 [30.9s + 9.9s]: train==[5.02241 = 2.70856 + 2.31385], recall= [ 0.00696  0.01087  0.01522  0.01783] , precision= [ 0.00696  0.00226  0.00157  0.00122] , auc=[0.56174], sum_recall=[0.05087]
Epoch 1 [26.5s + 9.4s]: train==[3.36689 = 1.05392 + 2.31297], recall= [ 0.01768  0.06442  0.09104  0.11626] , precision= [ 0.01826  0.01391  0.01009  0.00846] , auc=[0.67026], sum_recall=[0.28940]
Epoch 2 [32.7s + 10.0s]: train==[2.93599 = 0.62419 + 2.31180], recall= [ 0.01855  0.07655  0.10756  0.13582] , precision= [ 0.02000  0.01722  0.01209  0.01014] , auc=[0.70170], sum_recall=[0.33848]
Epoch 3 [32.3s + 10.8s]: train==[2.78607 = 0.47620 + 2.30987], recall= [ 0.02449  0.07633  0.11640  0.13930] , precision= [ 0.02696  0.01722  0.01304  0.01038] , auc=[0.72080], sum_recall=[0.35652]
Epoch 4 [26.6s + 11.4s]: train==[2.70256 = 0.39539 + 2.30716], recall= [ 0.02536  0.07829  0.11408  0.13973] , precision= [ 0.02783  0.01757  0.01278  0.01043] , auc=[0.73451], sum_recall=[0.35746]
Epoch 5 [26.5s + 11.7s]: train==[2.66246 = 0.35874 + 2.30372], recall= [ 0.02754  0.07676  0.11481  0.14034] , precision= [ 0.02957  0.01704  0.01296  0.01055] , auc=[0.74348], sum_recall=[0.35945]
Epoch 6 [26.7s + 11.3s]: train==[2.62352 = 0.32385 + 2.29967], recall= [ 0.02763  0.07560  0.11742  0.14382] , precision= [ 0.03043  0.01704  0.01330  0.01078] , auc=[0.74990], sum_recall=[0.36447]
Epoch 7 [26.4s + 10.9s]: train==[2.60492 = 0.30962 + 2.29531], recall= [ 0.02763  0.07952  0.11829  0.14566] , precision= [ 0.03043  0.01791  0.01330  0.01096] , auc=[0.75430], sum_recall=[0.37109]
Epoch 8 [32.3s + 11.5s]: train==[2.58276 = 0.29185 + 2.29092], recall= [ 0.02676  0.08097  0.12002  0.15087] , precision= [ 0.02957  0.01809  0.01348  0.01136] , auc=[0.75761], sum_recall=[0.37863]
Epoch 9 [26.6s + 11.2s]: train==[2.55648 = 0.26974 + 2.28674], recall= [ 0.02676  0.07618  0.11976  0.15025] , precision= [ 0.02957  0.01722  0.01348  0.01130] , auc=[0.75983], sum_recall=[0.37296]
Epoch 10 [28.1s + 11.3s]: train==[2.54379 = 0.26097 + 2.28282], recall= [ 0.02705  0.07966  0.11783  0.15068] , precision= [ 0.03043  0.01791  0.01330  0.01130] , auc=[0.76147], sum_recall=[0.37523]
Epoch 11 [26.5s + 10.9s]: train==[2.52889 = 0.24990 + 2.27899], recall= [ 0.02633  0.07810  0.11500  0.14590] , precision= [ 0.03043  0.01774  0.01296  0.01096] , auc=[0.76263], sum_recall=[0.36533]
Epoch 12 [26.7s + 11.7s]: train==[2.51486 = 0.23969 + 2.27517], recall= [ 0.02633  0.07984  0.11539  0.14851] , precision= [ 0.03043  0.01809  0.01313  0.01113] , auc=[0.76353], sum_recall=[0.37006]
Epoch 13 [30.2s + 11.4s]: train==[2.49672 = 0.22528 + 2.27145], recall= [ 0.02807  0.07766  0.11496  0.14822] , precision= [ 0.03217  0.01757  0.01304  0.01107] , auc=[0.76443], sum_recall=[0.36890]
Epoch 14 [26.4s + 12.3s]: train==[2.49026 = 0.22243 + 2.26784], recall= [ 0.02937  0.07897  0.11930  0.14996] , precision= [ 0.03304  0.01791  0.01348  0.01119] , auc=[0.76523], sum_recall=[0.37760]
Epoch 15 [26.6s + 12.0s]: train==[2.48367 = 0.21937 + 2.26430], recall= [ 0.02937  0.07839  0.11974  0.15300] , precision= [ 0.03304  0.01791  0.01348  0.01136] , auc=[0.76615], sum_recall=[0.38050]
Epoch 16 [26.5s + 11.2s]: train==[2.46884 = 0.20823 + 2.26062], recall= [ 0.03024  0.07860  0.11974  0.15735] , precision= [ 0.03391  0.01809  0.01348  0.01165] , auc=[0.76712], sum_recall=[0.38593]
Epoch 17 [26.3s + 11.3s]: train==[2.45739 = 0.20071 + 2.25669], recall= [ 0.02937  0.07991  0.12148  0.15735] , precision= [ 0.03304  0.01826  0.01365  0.01165] , auc=[0.76814], sum_recall=[0.38811]
Epoch 18 [26.5s + 11.5s]: train==[2.44232 = 0.18977 + 2.25255], recall= [ 0.02850  0.08252  0.12409  0.15561] , precision= [ 0.03217  0.01878  0.01391  0.01148] , auc=[0.76925], sum_recall=[0.39071]
Epoch 19 [26.7s + 11.5s]: train==[2.43817 = 0.18960 + 2.24857], recall= [ 0.02937  0.08339  0.12539  0.16025] , precision= [ 0.03304  0.01896  0.01400  0.01183] , auc=[0.77037], sum_recall=[0.39840]
Epoch 20 [26.4s + 11.1s]: train==[2.43086 = 0.18636 + 2.24449], recall= [ 0.03024  0.08339  0.12626  0.16068] , precision= [ 0.03391  0.01896  0.01409  0.01183] , auc=[0.77142], sum_recall=[0.40057]
Epoch 21 [26.5s + 11.0s]: train==[2.42279 = 0.18256 + 2.24023], recall= [ 0.02763  0.08252  0.12757  0.15938] , precision= [ 0.03217  0.01878  0.01426  0.01177] , auc=[0.77242], sum_recall=[0.39709]
Epoch 22 [26.4s + 11.1s]: train==[2.41805 = 0.18227 + 2.23578], recall= [ 0.02850  0.08426  0.12573  0.15981] , precision= [ 0.03304  0.01913  0.01400  0.01183] , auc=[0.77329], sum_recall=[0.39830]
Epoch 23 [26.4s + 12.3s]: train==[2.40333 = 0.17242 + 2.23091], recall= [ 0.02531  0.08208  0.12486  0.16079] , precision= [ 0.03043  0.01878  0.01391  0.01194] , auc=[0.77406], sum_recall=[0.39305]
Epoch 24 [26.7s + 12.3s]: train==[2.39250 = 0.16718 + 2.22532], recall= [ 0.02618  0.08295  0.12573  0.16195] , precision= [ 0.03130  0.01896  0.01400  0.01206] , auc=[0.77470], sum_recall=[0.39681]
Epoch 25 [26.5s + 11.3s]: train==[2.38842 = 0.16967 + 2.21875], recall= [ 0.02618  0.08404  0.12573  0.16021] , precision= [ 0.03130  0.01930  0.01400  0.01194] , auc=[0.77527], sum_recall=[0.39616]
Epoch 26 [26.4s + 11.5s]: train==[2.37856 = 0.16719 + 2.21138], recall= [ 0.02589  0.08375  0.12747  0.16021] , precision= [ 0.03043  0.01913  0.01417  0.01194] , auc=[0.77585], sum_recall=[0.39732]
Epoch 27 [30.7s + 11.4s]: train==[2.36373 = 0.16058 + 2.20315], recall= [ 0.02662  0.08288  0.12747  0.15978] , precision= [ 0.03043  0.01896  0.01417  0.01188] , auc=[0.77624], sum_recall=[0.39674]
Epoch 28 [26.4s + 12.5s]: train==[2.35523 = 0.16064 + 2.19458], recall= [ 0.02546  0.08271  0.12776  0.15804] , precision= [ 0.02870  0.01878  0.01426  0.01177] , auc=[0.77659], sum_recall=[0.39396]
Epoch 29 [26.5s + 11.3s]: train==[2.33902 = 0.15383 + 2.18519], recall= [ 0.02546  0.08531  0.12776  0.15673] , precision= [ 0.02870  0.01930  0.01426  0.01165] , auc=[0.77689], sum_recall=[0.39526]
Epoch 30 [26.5s + 11.3s]: train==[2.33184 = 0.15601 + 2.17583], recall= [ 0.02589  0.08401  0.12863  0.16064] , precision= [ 0.02870  0.01896  0.01435  0.01194] , auc=[0.77723], sum_recall=[0.39918]
Epoch 31 [26.6s + 11.5s]: train==[2.31564 = 0.14897 + 2.16667], recall= [ 0.02676  0.08430  0.12602  0.16097] , precision= [ 0.02957  0.01913  0.01409  0.01194] , auc=[0.77789], sum_recall=[0.39805]
Epoch 32 [26.4s + 11.2s]: train==[2.30696 = 0.14861 + 2.15835], recall= [ 0.02749  0.08256  0.12863  0.16195] , precision= [ 0.02957  0.01878  0.01435  0.01206] , auc=[0.77861], sum_recall=[0.40063]
Epoch 33 [26.5s + 12.0s]: train==[2.29375 = 0.14313 + 2.15062], recall= [ 0.02836  0.08430  0.12776  0.16217] , precision= [ 0.03043  0.01913  0.01426  0.01217] , auc=[0.77948], sum_recall=[0.40258]
Epoch 34 [30.2s + 11.9s]: train==[2.28413 = 0.14039 + 2.14374], recall= [ 0.02966  0.08546  0.12732  0.16456] , precision= [ 0.03130  0.01948  0.01426  0.01229] , auc=[0.78026], sum_recall=[0.40700]
Epoch 35 [26.7s + 11.2s]: train==[2.27327 = 0.13585 + 2.13741], recall= [ 0.03227  0.08633  0.12541  0.16304] , precision= [ 0.03391  0.01965  0.01400  0.01223] , auc=[0.78072], sum_recall=[0.40705]
Epoch 36 [26.8s + 11.9s]: train==[2.26391 = 0.13209 + 2.13182], recall= [ 0.03140  0.08546  0.12671  0.16547] , precision= [ 0.03304  0.01948  0.01417  0.01241] , auc=[0.78080], sum_recall=[0.40905]
Epoch 37 [28.6s + 12.1s]: train==[2.26232 = 0.13496 + 2.12736], recall= [ 0.03053  0.08546  0.12498  0.16330] , precision= [ 0.03217  0.01948  0.01400  0.01223] , auc=[0.78058], sum_recall=[0.40426]
Epoch 38 [30.2s + 11.9s]: train==[2.26013 = 0.13637 + 2.12376], recall= [ 0.02923  0.08611  0.12780  0.16581] , precision= [ 0.03043  0.01948  0.01435  0.01235] , auc=[0.78020], sum_recall=[0.40895]
Epoch 39 [29.4s + 12.0s]: train==[2.25978 = 0.13898 + 2.12080], recall= [ 0.02836  0.08669  0.12606  0.16232] , precision= [ 0.02957  0.01948  0.01417  0.01212] , auc=[0.77987], sum_recall=[0.40343]
Epoch 40 [30.9s + 11.5s]: train==[2.24863 = 0.13012 + 2.11850], recall= [ 0.02575  0.08640  0.12258  0.15721] , precision= [ 0.02696  0.01930  0.01383  0.01183] , auc=[0.77990], sum_recall=[0.39194]
Epoch 41 [30.7s + 11.6s]: train==[2.25304 = 0.13684 + 2.11620], recall= [ 0.02575  0.08553  0.12574  0.15489] , precision= [ 0.02696  0.01913  0.01417  0.01171] , auc=[0.77982], sum_recall=[0.39191]
Epoch 42 [30.7s + 12.4s]: train==[2.25167 = 0.13685 + 2.11482], recall= [ 0.02502  0.08535  0.12791  0.15315] , precision= [ 0.02696  0.01913  0.01443  0.01159] , auc=[0.77973], sum_recall=[0.39144]
Epoch 43 [31.5s + 12.4s]: train==[2.24552 = 0.13175 + 2.11377], recall= [ 0.02415  0.08173  0.12704  0.15388] , precision= [ 0.02609  0.01826  0.01435  0.01171] , auc=[0.77942], sum_recall=[0.38680]
Epoch 44 [29.8s + 11.5s]: train==[2.23668 = 0.12461 + 2.11207], recall= [ 0.02676  0.08194  0.12559  0.15335] , precision= [ 0.02870  0.01826  0.01417  0.01165] , auc=[0.77896], sum_recall=[0.38764]
Epoch 45 [28.2s + 12.0s]: train==[2.23767 = 0.12729 + 2.11039], recall= [ 0.02850  0.08586  0.12646  0.14909] , precision= [ 0.03043  0.01896  0.01426  0.01136] , auc=[0.77832], sum_recall=[0.38992]
Epoch 46 [29.3s + 12.1s]: train==[2.23430 = 0.12497 + 2.10932], recall= [ 0.02937  0.08731  0.12574  0.14813] , precision= [ 0.03130  0.01913  0.01409  0.01125] , auc=[0.77776], sum_recall=[0.39054]
End of trainning! Best recall= [ 0.03140  0.08546  0.12671  0.16547] , precision= [ 0.03304  0.01948  0.01417  0.01241] , auc=[0.78080]
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross0', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-25 12:39:50
loading data...
[n_users, n_items]=[3209, 12331]
[n_train, n_test]=[2636, 1318]
[n_edges]=[260034]
Using GPU 0,  memory_free: 24265
tensor([ 0.0390, -0.0169, -0.0219,  0.0133,  0.0364], device='cuda:0')
Loading Model..Number of Model Parameters:  3348802
Epoch 0 [27.4s + 11.4s]: train==[5.00577 = 2.69090 + 2.31487], recall= [ 0.00348  0.01304  0.01413  0.02109] , precision= [ 0.00348  0.00278  0.00157  0.00151] , auc=[0.56256], sum_recall=[0.05174]
Epoch 1 [28.2s + 11.6s]: train==[3.38253 = 1.06857 + 2.31397], recall= [ 0.02138  0.06899  0.08657  0.10875] , precision= [ 0.02348  0.01496  0.00965  0.00794] , auc=[0.67272], sum_recall=[0.28569]
Epoch 2 [28.4s + 10.9s]: train==[2.91865 = 0.60612 + 2.31253], recall= [ 0.02051  0.07355  0.11058  0.13459] , precision= [ 0.02261  0.01652  0.01243  0.01009] , auc=[0.70481], sum_recall=[0.33924]
Epoch 3 [28.5s + 12.7s]: train==[2.78259 = 0.47228 + 2.31031], recall= [ 0.01674  0.08237  0.12126  0.14691] , precision= [ 0.01826  0.01878  0.01374  0.01090] , auc=[0.72409], sum_recall=[0.36729]
Epoch 4 [28.4s + 12.9s]: train==[2.69612 = 0.38886 + 2.30726], recall= [ 0.01928  0.08234  0.11711  0.14735] , precision= [ 0.02087  0.01861  0.01313  0.01101] , auc=[0.73872], sum_recall=[0.36607]
Epoch 5 [28.4s + 13.1s]: train==[2.65889 = 0.35549 + 2.30340], recall= [ 0.01841  0.07843  0.11817  0.14595] , precision= [ 0.02000  0.01774  0.01322  0.01090] , auc=[0.74871], sum_recall=[0.36095]
Epoch 6 [28.0s + 13.1s]: train==[2.62338 = 0.32446 + 2.29892], recall= [ 0.01884  0.07831  0.12066  0.14791] , precision= [ 0.02087  0.01774  0.01357  0.01096] , auc=[0.75566], sum_recall=[0.36572]
Epoch 7 [28.5s + 13.5s]: train==[2.59773 = 0.30353 + 2.29420], recall= [ 0.01754  0.08397  0.12718  0.14663] , precision= [ 0.01913  0.01896  0.01426  0.01096] , auc=[0.76018], sum_recall=[0.37531]
Epoch 8 [28.3s + 12.6s]: train==[2.57639 = 0.28677 + 2.28962], recall= [ 0.01754  0.08669  0.12762  0.14996] , precision= [ 0.01913  0.01948  0.01426  0.01125] , auc=[0.76338], sum_recall=[0.38181]
Epoch 9 [27.9s + 13.5s]: train==[2.55808 = 0.27272 + 2.28536], recall= [ 0.01797  0.08300  0.12849  0.15049] , precision= [ 0.02000  0.01861  0.01435  0.01125] , auc=[0.76545], sum_recall=[0.37995]
Epoch 10 [28.4s + 13.3s]: train==[2.54482 = 0.26340 + 2.28142], recall= [ 0.01797  0.08527  0.12936  0.15136] , precision= [ 0.02000  0.01896  0.01443  0.01130] , auc=[0.76698], sum_recall=[0.38396]
Epoch 11 [27.7s + 13.2s]: train==[2.52753 = 0.25000 + 2.27753], recall= [ 0.01928  0.08353  0.12718  0.15397] , precision= [ 0.02087  0.01861  0.01426  0.01148] , auc=[0.76812], sum_recall=[0.38396]
Epoch 12 [27.4s + 12.9s]: train==[2.51119 = 0.23749 + 2.27369], recall= [ 0.01754  0.08266  0.12429  0.15136] , precision= [ 0.01913  0.01843  0.01391  0.01130] , auc=[0.76898], sum_recall=[0.37585]
Epoch 13 [27.2s + 12.5s]: train==[2.49536 = 0.22537 + 2.26999], recall= [ 0.01841  0.08266  0.12269  0.15223] , precision= [ 0.02000  0.01843  0.01365  0.01136] , auc=[0.76983], sum_recall=[0.37599]
Epoch 14 [27.3s + 13.4s]: train==[2.48680 = 0.22035 + 2.26644], recall= [ 0.01928  0.08382  0.12257  0.15049] , precision= [ 0.02087  0.01878  0.01365  0.01125] , auc=[0.77067], sum_recall=[0.37616]
Epoch 15 [27.6s + 12.8s]: train==[2.47845 = 0.21551 + 2.26294], recall= [ 0.02101  0.08382  0.12421  0.15107] , precision= [ 0.02261  0.01878  0.01374  0.01136] , auc=[0.77152], sum_recall=[0.38012]
Epoch 16 [27.5s + 13.7s]: train==[2.46724 = 0.20803 + 2.25921], recall= [ 0.02275  0.08295  0.12750  0.15334] , precision= [ 0.02435  0.01861  0.01426  0.01159] , auc=[0.77238], sum_recall=[0.38655]
Epoch 17 [27.9s + 13.1s]: train==[2.45514 = 0.19991 + 2.25523], recall= [ 0.02275  0.08382  0.13247  0.15537] , precision= [ 0.02435  0.01878  0.01470  0.01177] , auc=[0.77322], sum_recall=[0.39442]
Epoch 18 [27.9s + 14.2s]: train==[2.44248 = 0.19134 + 2.25114], recall= [ 0.02406  0.08295  0.13203  0.15798] , precision= [ 0.02609  0.01861  0.01461  0.01194] , auc=[0.77410], sum_recall=[0.39702]
Epoch 19 [28.2s + 13.2s]: train==[2.43723 = 0.18995 + 2.24728], recall= [ 0.02406  0.08295  0.13102  0.15668] , precision= [ 0.02609  0.01861  0.01452  0.01188] , auc=[0.77506], sum_recall=[0.39471]
Epoch 20 [28.2s + 13.4s]: train==[2.43106 = 0.18771 + 2.24335], recall= [ 0.02329  0.08324  0.12940  0.15885] , precision= [ 0.02609  0.01878  0.01435  0.01206] , auc=[0.77601], sum_recall=[0.39478]
Epoch 21 [27.7s + 12.6s]: train==[2.42183 = 0.18246 + 2.23937], recall= [ 0.02242  0.08411  0.12853  0.15798] , precision= [ 0.02522  0.01896  0.01426  0.01200] , auc=[0.77701], sum_recall=[0.39304]
Epoch 22 [27.7s + 13.0s]: train==[2.41557 = 0.18030 + 2.23527], recall= [ 0.02242  0.08585  0.12950  0.16015] , precision= [ 0.02522  0.01930  0.01443  0.01212] , auc=[0.77787], sum_recall=[0.39792]
Epoch 23 [27.9s + 13.5s]: train==[2.40473 = 0.17385 + 2.23088], recall= [ 0.02415  0.08346  0.12993  0.16189] , precision= [ 0.02696  0.01896  0.01452  0.01223] , auc=[0.77867], sum_recall=[0.39944]
Epoch 24 [28.1s + 13.4s]: train==[2.39412 = 0.16829 + 2.22583], recall= [ 0.02618  0.08737  0.12984  0.16354] , precision= [ 0.02957  0.01983  0.01443  0.01229] , auc=[0.77940], sum_recall=[0.40693]
Epoch 25 [27.7s + 13.8s]: train==[2.39114 = 0.17105 + 2.22010], recall= [ 0.02662  0.08824  0.12788  0.16528] , precision= [ 0.03043  0.02000  0.01435  0.01241] , auc=[0.78007], sum_recall=[0.40801]
Epoch 26 [28.0s + 13.0s]: train==[2.37765 = 0.16384 + 2.21380], recall= [ 0.02662  0.08911  0.13114  0.16354] , precision= [ 0.03043  0.02017  0.01461  0.01229] , auc=[0.78076], sum_recall=[0.41041]
Epoch 27 [27.7s + 12.4s]: train==[2.36785 = 0.16099 + 2.20686], recall= [ 0.02662  0.08911  0.13027  0.16354] , precision= [ 0.03043  0.02017  0.01452  0.01229] , auc=[0.78128], sum_recall=[0.40954]
Epoch 28 [27.5s + 13.3s]: train==[2.36017 = 0.16060 + 2.19958], recall= [ 0.02836  0.08882  0.13037  0.16354] , precision= [ 0.03217  0.02000  0.01461  0.01229] , auc=[0.78162], sum_recall=[0.41108]
Epoch 29 [28.4s + 13.2s]: train==[2.34595 = 0.15465 + 2.19130], recall= [ 0.02739  0.08691  0.12950  0.16267] , precision= [ 0.03043  0.01948  0.01452  0.01223] , auc=[0.78186], sum_recall=[0.40646]
Epoch 30 [28.6s + 12.7s]: train==[2.33842 = 0.15585 + 2.18257], recall= [ 0.02739  0.08633  0.13080  0.16296] , precision= [ 0.03043  0.01948  0.01461  0.01229] , auc=[0.78209], sum_recall=[0.40748]
Epoch 31 [28.0s + 12.7s]: train==[2.32096 = 0.14742 + 2.17354], recall= [ 0.02739  0.08763  0.12976  0.16643] , precision= [ 0.03043  0.01983  0.01443  0.01252] , auc=[0.78257], sum_recall=[0.41122]
Epoch 32 [27.5s + 13.2s]: train==[2.31250 = 0.14765 + 2.16486], recall= [ 0.02826  0.08691  0.12976  0.16687] , precision= [ 0.03130  0.01948  0.01452  0.01258] , auc=[0.78324], sum_recall=[0.41180]
Epoch 33 [27.7s + 13.9s]: train==[2.29821 = 0.14183 + 2.15638], recall= [ 0.02681  0.08720  0.12976  0.16691] , precision= [ 0.02870  0.01965  0.01452  0.01258] , auc=[0.78396], sum_recall=[0.41068]
Epoch 34 [28.3s + 13.2s]: train==[2.28834 = 0.13982 + 2.14852], recall= [ 0.02778  0.08720  0.12976  0.16539] , precision= [ 0.03043  0.01965  0.01452  0.01246] , auc=[0.78452], sum_recall=[0.41013]
Epoch 35 [27.5s + 12.4s]: train==[2.27514 = 0.13395 + 2.14119], recall= [ 0.02865  0.08850  0.12932  0.16365] , precision= [ 0.03130  0.02000  0.01452  0.01235] , auc=[0.78490], sum_recall=[0.41013]
Epoch 36 [27.7s + 12.9s]: train==[2.26475 = 0.13032 + 2.13443], recall= [ 0.02734  0.08560  0.13019  0.16529] , precision= [ 0.02957  0.01930  0.01461  0.01241] , auc=[0.78493], sum_recall=[0.40843]
Epoch 37 [28.0s + 13.1s]: train==[2.26167 = 0.13288 + 2.12879], recall= [ 0.02821  0.08473  0.13193  0.16356] , precision= [ 0.03043  0.01913  0.01478  0.01229] , auc=[0.78461], sum_recall=[0.40843]
Epoch 38 [28.3s + 13.7s]: train==[2.25664 = 0.13274 + 2.12391], recall= [ 0.03082  0.08575  0.13237  0.15964] , precision= [ 0.03304  0.01948  0.01487  0.01200] , auc=[0.78418], sum_recall=[0.40858]
Epoch 39 [28.3s + 12.7s]: train==[2.25612 = 0.13615 + 2.11996], recall= [ 0.03082  0.08401  0.12889  0.15638] , precision= [ 0.03304  0.01913  0.01452  0.01171] , auc=[0.78366], sum_recall=[0.40010]
Epoch 40 [28.5s + 12.8s]: train==[2.24408 = 0.12726 + 2.11682], recall= [ 0.03169  0.08459  0.12802  0.15377] , precision= [ 0.03391  0.01913  0.01435  0.01154] , auc=[0.78340], sum_recall=[0.39807]
Epoch 41 [27.9s + 13.3s]: train==[2.25062 = 0.13653 + 2.11410], recall= [ 0.02966  0.08437  0.12802  0.15691] , precision= [ 0.03130  0.01896  0.01435  0.01183] , auc=[0.78302], sum_recall=[0.39897]
Epoch 42 [28.2s + 13.2s]: train==[2.24905 = 0.13656 + 2.11249], recall= [ 0.03053  0.08307  0.12776  0.15691] , precision= [ 0.03217  0.01861  0.01443  0.01183] , auc=[0.78273], sum_recall=[0.39827]
Epoch 43 [27.8s + 13.2s]: train==[2.24378 = 0.13231 + 2.11147], recall= [ 0.03010  0.08046  0.12824  0.15800] , precision= [ 0.03130  0.01774  0.01435  0.01200] , auc=[0.78229], sum_recall=[0.39680]
Epoch 44 [27.5s + 13.1s]: train==[2.23369 = 0.12337 + 2.11032], recall= [ 0.03010  0.08068  0.12636  0.15778] , precision= [ 0.03130  0.01774  0.01400  0.01194] , auc=[0.78174], sum_recall=[0.39491]
Epoch 45 [27.8s + 12.9s]: train==[2.23712 = 0.12789 + 2.10923], recall= [ 0.03271  0.08024  0.12444  0.15300] , precision= [ 0.03391  0.01757  0.01374  0.01159] , auc=[0.78098], sum_recall=[0.39039]
Epoch 46 [27.7s + 13.6s]: train==[2.23206 = 0.12328 + 2.10878], recall= [ 0.03184  0.08271  0.12271  0.15399] , precision= [ 0.03304  0.01809  0.01357  0.01165] , auc=[0.78037], sum_recall=[0.39124]
End of trainning! Best recall= [ 0.02734  0.08560  0.13019  0.16529] , precision= [ 0.02957  0.01930  0.01461  0.01241] , auc=[0.78493]
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross0', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-25 13:12:03
loading data...
[n_users, n_items]=[3209, 12331]
[n_train, n_test]=[2636, 1318]
[n_edges]=[260034]
Using GPU 0,  memory_free: 24265
tensor([-0.0235, -0.0034, -0.0139, -0.0224, -0.0090], device='cuda:0')
Loading Model..Number of Model Parameters:  3348802
Epoch 0 [26.5s + 9.0s]: train==[5.02739 = 2.71434 + 2.31304], recall= [ 0.00565  0.01739  0.02152  0.02326] , precision= [ 0.00609  0.00365  0.00235  0.00168] , auc=[0.56395], sum_recall=[0.06783]
Epoch 1 [26.3s + 9.3s]: train==[3.35137 = 1.03912 + 2.31226], recall= [ 0.01775  0.06768  0.09543  0.11928] , precision= [ 0.02000  0.01461  0.01043  0.00870] , auc=[0.67382], sum_recall=[0.30015]
Epoch 2 [30.5s + 10.1s]: train==[2.93082 = 0.61966 + 2.31116], recall= [ 0.01993  0.07075  0.10466  0.12976] , precision= [ 0.02261  0.01600  0.01165  0.00962] , auc=[0.70311], sum_recall=[0.32510]
Epoch 3 [32.6s + 10.9s]: train==[2.79024 = 0.48088 + 2.30935], recall= [ 0.02239  0.07800  0.11041  0.13614] , precision= [ 0.02348  0.01757  0.01243  0.01014] , auc=[0.72051], sum_recall=[0.34693]
Epoch 4 [27.8s + 11.3s]: train==[2.70346 = 0.39670 + 2.30677], recall= [ 0.01804  0.08089  0.11611  0.13950] , precision= [ 0.01913  0.01826  0.01304  0.01049] , auc=[0.73242], sum_recall=[0.35455]
Epoch 5 [26.2s + 11.5s]: train==[2.66947 = 0.36607 + 2.30341], recall= [ 0.01988  0.08394  0.11672  0.14211] , precision= [ 0.02174  0.01896  0.01322  0.01072] , auc=[0.74112], sum_recall=[0.36264]
Epoch 6 [29.4s + 12.6s]: train==[2.62590 = 0.32656 + 2.29934], recall= [ 0.02053  0.08597  0.11759  0.14244] , precision= [ 0.02261  0.01965  0.01330  0.01067] , auc=[0.74749], sum_recall=[0.36653]
Epoch 7 [26.7s + 10.8s]: train==[2.59863 = 0.30385 + 2.29478], recall= [ 0.02024  0.08744  0.11976  0.14505] , precision= [ 0.02261  0.02000  0.01357  0.01084] , auc=[0.75197], sum_recall=[0.37250]
Epoch 8 [26.2s + 10.7s]: train==[2.57602 = 0.28596 + 2.29006], recall= [ 0.02024  0.08744  0.12324  0.14679] , precision= [ 0.02261  0.02000  0.01391  0.01096] , auc=[0.75530], sum_recall=[0.37772]
Epoch 9 [28.8s + 11.8s]: train==[2.55317 = 0.26767 + 2.28550], recall= [ 0.02024  0.08868  0.12310  0.14875] , precision= [ 0.02261  0.02000  0.01391  0.01101] , auc=[0.75766], sum_recall=[0.38076]
Epoch 10 [29.3s + 11.6s]: train==[2.54052 = 0.25922 + 2.28130], recall= [ 0.01937  0.08737  0.12339  0.15049] , precision= [ 0.02174  0.01983  0.01383  0.01113] , auc=[0.75962], sum_recall=[0.38062]
Epoch 11 [26.5s + 10.6s]: train==[2.52633 = 0.24902 + 2.27731], recall= [ 0.01894  0.08607  0.12208  0.14759] , precision= [ 0.02087  0.01965  0.01365  0.01090] , auc=[0.76115], sum_recall=[0.37468]
Epoch 12 [27.7s + 10.8s]: train==[2.51327 = 0.23987 + 2.27340], recall= [ 0.01894  0.08172  0.12295  0.14715] , precision= [ 0.02087  0.01878  0.01374  0.01084] , auc=[0.76237], sum_recall=[0.37076]
Epoch 13 [26.4s + 10.7s]: train==[2.49281 = 0.22329 + 2.26952], recall= [ 0.01894  0.08215  0.12382  0.14686] , precision= [ 0.02087  0.01878  0.01383  0.01078] , auc=[0.76353], sum_recall=[0.37178]
Epoch 14 [26.4s + 12.1s]: train==[2.48759 = 0.22188 + 2.26571], recall= [ 0.01981  0.08295  0.12266  0.14947] , precision= [ 0.02174  0.01861  0.01365  0.01096] , auc=[0.76464], sum_recall=[0.37489]
Epoch 15 [28.5s + 11.9s]: train==[2.47835 = 0.21626 + 2.26210], recall= [ 0.02010  0.08426  0.12136  0.15131] , precision= [ 0.02261  0.01896  0.01348  0.01113] , auc=[0.76576], sum_recall=[0.37702]
Epoch 16 [32.1s + 11.1s]: train==[2.46833 = 0.20984 + 2.25849], recall= [ 0.02097  0.08513  0.12223  0.15261] , precision= [ 0.02348  0.01913  0.01357  0.01125] , auc=[0.76687], sum_recall=[0.38093]
Epoch 17 [27.3s + 10.8s]: train==[2.45471 = 0.19996 + 2.25475], recall= [ 0.02227  0.08513  0.12310  0.15370] , precision= [ 0.02522  0.01913  0.01365  0.01136] , auc=[0.76789], sum_recall=[0.38419]
Epoch 18 [26.3s + 12.2s]: train==[2.44380 = 0.19305 + 2.25074], recall= [ 0.02314  0.08686  0.12484  0.15196] , precision= [ 0.02609  0.01948  0.01383  0.01125] , auc=[0.76889], sum_recall=[0.38680]
Epoch 19 [29.0s + 11.6s]: train==[2.43639 = 0.18961 + 2.24678], recall= [ 0.02357  0.08930  0.12397  0.15109] , precision= [ 0.02696  0.01983  0.01374  0.01119] , auc=[0.77001], sum_recall=[0.38793]
Epoch 20 [27.7s + 11.7s]: train==[2.42672 = 0.18379 + 2.24293], recall= [ 0.02256  0.08756  0.12527  0.15327] , precision= [ 0.02522  0.01948  0.01391  0.01136] , auc=[0.77112], sum_recall=[0.38866]
Epoch 21 [26.9s + 13.4s]: train==[2.42139 = 0.18215 + 2.23924], recall= [ 0.02343  0.08843  0.12744  0.15500] , precision= [ 0.02609  0.01965  0.01417  0.01148] , auc=[0.77245], sum_recall=[0.39431]
Epoch 22 [26.6s + 13.3s]: train==[2.41639 = 0.18072 + 2.23567], recall= [ 0.02343  0.08807  0.12918  0.15848] , precision= [ 0.02609  0.01983  0.01435  0.01171] , auc=[0.77358], sum_recall=[0.39916]
Epoch 23 [27.1s + 13.4s]: train==[2.40469 = 0.17252 + 2.23217], recall= [ 0.02343  0.08517  0.12918  0.15848] , precision= [ 0.02609  0.01913  0.01435  0.01171] , auc=[0.77467], sum_recall=[0.39627]
Epoch 24 [30.0s + 14.4s]: train==[2.39648 = 0.16776 + 2.22872], recall= [ 0.02343  0.08691  0.13058  0.15772] , precision= [ 0.02609  0.01948  0.01461  0.01171] , auc=[0.77549], sum_recall=[0.39864]
Epoch 25 [26.7s + 14.0s]: train==[2.39603 = 0.17090 + 2.22513], recall= [ 0.02372  0.08604  0.12954  0.15714] , precision= [ 0.02696  0.01930  0.01443  0.01171] , auc=[0.77618], sum_recall=[0.39644]
Epoch 26 [26.6s + 12.8s]: train==[2.38598 = 0.16474 + 2.22124], recall= [ 0.02372  0.08517  0.12693  0.15714] , precision= [ 0.02696  0.01913  0.01417  0.01171] , auc=[0.77675], sum_recall=[0.39296]
Epoch 27 [26.9s + 13.9s]: train==[2.37759 = 0.16058 + 2.21701], recall= [ 0.02372  0.08430  0.12983  0.15606] , precision= [ 0.02696  0.01896  0.01452  0.01171] , auc=[0.77708], sum_recall=[0.39391]
Epoch 28 [27.5s + 14.8s]: train==[2.37363 = 0.16094 + 2.21269], recall= [ 0.02372  0.08386  0.12878  0.15708] , precision= [ 0.02696  0.01896  0.01443  0.01183] , auc=[0.77733], sum_recall=[0.39344]
Epoch 29 [26.7s + 14.5s]: train==[2.36261 = 0.15482 + 2.20780], recall= [ 0.02343  0.08300  0.12864  0.15653] , precision= [ 0.02609  0.01878  0.01443  0.01171] , auc=[0.77761], sum_recall=[0.39159]
Epoch 30 [28.8s + 13.6s]: train==[2.35958 = 0.15720 + 2.20238], recall= [ 0.02343  0.08386  0.13037  0.16023] , precision= [ 0.02609  0.01896  0.01461  0.01200] , auc=[0.77805], sum_recall=[0.39790]
Epoch 31 [27.4s + 13.8s]: train==[2.34463 = 0.14850 + 2.19613], recall= [ 0.02517  0.08386  0.12690  0.15943] , precision= [ 0.02783  0.01896  0.01426  0.01194] , auc=[0.77876], sum_recall=[0.39536]
Epoch 32 [26.8s + 13.3s]: train==[2.33692 = 0.14802 + 2.18890], recall= [ 0.02604  0.08213  0.12646  0.16168] , precision= [ 0.02870  0.01861  0.01426  0.01217] , auc=[0.77957], sum_recall=[0.39630]
Epoch 33 [27.9s + 13.7s]: train==[2.32264 = 0.14175 + 2.18090], recall= [ 0.02734  0.08386  0.12950  0.16211] , precision= [ 0.02957  0.01896  0.01461  0.01223] , auc=[0.78050], sum_recall=[0.40283]
Epoch 34 [26.8s + 13.9s]: train==[2.31052 = 0.13819 + 2.17233], recall= [ 0.02647  0.08734  0.12940  0.16037] , precision= [ 0.02870  0.01965  0.01452  0.01206] , auc=[0.78125], sum_recall=[0.40359]
Epoch 35 [27.5s + 13.5s]: train==[2.29689 = 0.13325 + 2.16364], recall= [ 0.02734  0.08908  0.13027  0.15921] , precision= [ 0.02957  0.02000  0.01461  0.01194] , auc=[0.78185], sum_recall=[0.40591]
Epoch 36 [27.0s + 13.0s]: train==[2.28458 = 0.12953 + 2.15505], recall= [ 0.02792  0.08937  0.13135  0.15998] , precision= [ 0.02957  0.02017  0.01470  0.01194] , auc=[0.78198], sum_recall=[0.40862]
Epoch 37 [27.2s + 14.1s]: train==[2.27784 = 0.13072 + 2.14711], recall= [ 0.02749  0.08807  0.13063  0.16114] , precision= [ 0.02870  0.02000  0.01452  0.01206] , auc=[0.78179], sum_recall=[0.40732]
Epoch 38 [26.6s + 14.1s]: train==[2.27046 = 0.13079 + 2.13967], recall= [ 0.02836  0.08778  0.12932  0.15679] , precision= [ 0.02957  0.01983  0.01435  0.01177] , auc=[0.78127], sum_recall=[0.40225]
Epoch 39 [27.3s + 13.7s]: train==[2.26605 = 0.13310 + 2.13295], recall= [ 0.03097  0.08966  0.12932  0.15831] , precision= [ 0.03217  0.02000  0.01435  0.01188] , auc=[0.78069], sum_recall=[0.40826]
Epoch 40 [26.7s + 13.3s]: train==[2.25141 = 0.12437 + 2.12704], recall= [ 0.03010  0.08792  0.13106  0.15585] , precision= [ 0.03130  0.01965  0.01452  0.01171] , auc=[0.78056], sum_recall=[0.40493]
Epoch 41 [26.3s + 13.8s]: train==[2.25342 = 0.13168 + 2.12174], recall= [ 0.03097  0.08618  0.12845  0.15845] , precision= [ 0.03217  0.01930  0.01426  0.01188] , auc=[0.78041], sum_recall=[0.40406]
Epoch 42 [26.4s + 14.4s]: train==[2.24897 = 0.13082 + 2.11815], recall= [ 0.02923  0.08401  0.12816  0.15595] , precision= [ 0.03043  0.01878  0.01417  0.01177] , auc=[0.78043], sum_recall=[0.39736]
Epoch 43 [26.7s + 14.1s]: train==[2.24490 = 0.12939 + 2.11551], recall= [ 0.02749  0.08517  0.12557  0.15755] , precision= [ 0.02870  0.01896  0.01391  0.01188] , auc=[0.78009], sum_recall=[0.39577]
Epoch 44 [26.8s + 14.6s]: train==[2.23607 = 0.12305 + 2.11303], recall= [ 0.02923  0.08300  0.12499  0.15646] , precision= [ 0.03043  0.01843  0.01374  0.01177] , auc=[0.77952], sum_recall=[0.39367]
Epoch 45 [27.2s + 14.6s]: train==[2.23610 = 0.12487 + 2.11123], recall= [ 0.03097  0.08636  0.12484  0.15190] , precision= [ 0.03217  0.01913  0.01383  0.01142] , auc=[0.77854], sum_recall=[0.39407]
Epoch 46 [26.6s + 14.2s]: train==[2.23078 = 0.12041 + 2.11037], recall= [ 0.03184  0.08419  0.12513  0.15711] , precision= [ 0.03304  0.01861  0.01391  0.01177] , auc=[0.77753], sum_recall=[0.39827]
End of trainning! Best recall= [ 0.02792  0.08937  0.13135  0.15998] , precision= [ 0.02957  0.02017  0.01470  0.01194] , auc=[0.78198]
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross0', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-25 13:43:38
loading data...
[n_users, n_items]=[3209, 12331]
[n_train, n_test]=[2636, 1318]
[n_edges]=[260034]
Using GPU 0,  memory_free: 24265
tensor([-0.0254,  0.0077, -0.0368,  0.0096, -0.0343], device='cuda:0')
Loading Model..Number of Model Parameters:  3348802
Epoch 0 [26.3s + 11.8s]: train==[5.02795 = 2.70431 + 2.32364], recall= [ 0.00696  0.01275  0.01667  0.02058] , precision= [ 0.00696  0.00296  0.00191  0.00157] , auc=[0.56368], sum_recall=[0.05696]
Epoch 1 [26.8s + 12.2s]: train==[3.38213 = 1.05947 + 2.32266], recall= [ 0.02268  0.06657  0.09070  0.10949] , precision= [ 0.02522  0.01513  0.01009  0.00806] , auc=[0.66469], sum_recall=[0.28944]
Epoch 2 [26.5s + 13.0s]: train==[2.93974 = 0.61835 + 2.32140], recall= [ 0.01703  0.07577  0.10548  0.12849] , precision= [ 0.01913  0.01722  0.01191  0.00962] , auc=[0.70445], sum_recall=[0.32678]
Epoch 3 [26.8s + 13.2s]: train==[2.79353 = 0.47422 + 2.31930], recall= [ 0.02370  0.07418  0.11143  0.14110] , precision= [ 0.02696  0.01722  0.01252  0.01055] , auc=[0.72744], sum_recall=[0.35040]
Epoch 4 [26.5s + 12.9s]: train==[2.70784 = 0.39163 + 2.31622], recall= [ 0.02080  0.08403  0.11748  0.14617] , precision= [ 0.02348  0.01913  0.01330  0.01090] , auc=[0.74187], sum_recall=[0.36848]
Epoch 5 [26.8s + 13.7s]: train==[2.66536 = 0.35326 + 2.31210], recall= [ 0.02319  0.08524  0.11965  0.14588] , precision= [ 0.02609  0.01930  0.01348  0.01090] , auc=[0.75093], sum_recall=[0.37396]
Epoch 6 [26.7s + 13.9s]: train==[2.63413 = 0.32706 + 2.30707], recall= [ 0.02493  0.08350  0.11965  0.14530] , precision= [ 0.02783  0.01896  0.01357  0.01090] , auc=[0.75721], sum_recall=[0.37338]
Epoch 7 [26.9s + 13.7s]: train==[2.60502 = 0.30352 + 2.30150], recall= [ 0.02406  0.08155  0.11820  0.14243] , precision= [ 0.02696  0.01826  0.01348  0.01078] , auc=[0.76111], sum_recall=[0.36624]
Epoch 8 [26.7s + 14.3s]: train==[2.58212 = 0.28625 + 2.29587], recall= [ 0.02406  0.08184  0.11866  0.14287] , precision= [ 0.02696  0.01843  0.01357  0.01084] , auc=[0.76379], sum_recall=[0.36743]
Epoch 9 [26.8s + 14.5s]: train==[2.55792 = 0.26734 + 2.29058], recall= [ 0.02188  0.08034  0.12127  0.14330] , precision= [ 0.02435  0.01826  0.01383  0.01084] , auc=[0.76561], sum_recall=[0.36680]
Epoch 10 [27.8s + 14.3s]: train==[2.54476 = 0.25904 + 2.28572], recall= [ 0.01971  0.08469  0.12040  0.14591] , precision= [ 0.02174  0.01913  0.01374  0.01096] , auc=[0.76694], sum_recall=[0.37071]
Epoch 11 [30.7s + 16.0s]: train==[2.53001 = 0.24902 + 2.28099], recall= [ 0.02145  0.08368  0.11971  0.14635] , precision= [ 0.02348  0.01896  0.01348  0.01096] , auc=[0.76781], sum_recall=[0.37119]
Epoch 12 [30.8s + 13.7s]: train==[2.51417 = 0.23788 + 2.27629], recall= [ 0.02406  0.08107  0.12015  0.14519] , precision= [ 0.02609  0.01843  0.01348  0.01084] , auc=[0.76840], sum_recall=[0.37046]
Epoch 13 [28.2s + 14.6s]: train==[2.49499 = 0.22332 + 2.27167], recall= [ 0.02406  0.08455  0.12189  0.14519] , precision= [ 0.02609  0.01913  0.01365  0.01084] , auc=[0.76910], sum_recall=[0.37568]
Epoch 14 [33.1s + 14.9s]: train==[2.48825 = 0.22099 + 2.26726], recall= [ 0.02493  0.08194  0.12341  0.14866] , precision= [ 0.02696  0.01861  0.01374  0.01107] , auc=[0.76973], sum_recall=[0.37894]
Epoch 15 [35.1s + 14.2s]: train==[2.47989 = 0.21675 + 2.26314], recall= [ 0.02493  0.08107  0.12254  0.14827] , precision= [ 0.02696  0.01843  0.01365  0.01107] , auc=[0.77049], sum_recall=[0.37680]
Epoch 16 [30.6s + 13.1s]: train==[2.46911 = 0.21007 + 2.25904], recall= [ 0.02493  0.08049  0.12515  0.15131] , precision= [ 0.02696  0.01843  0.01391  0.01130] , auc=[0.77126], sum_recall=[0.38187]
Epoch 17 [32.5s + 12.7s]: train==[2.45467 = 0.20002 + 2.25465], recall= [ 0.02623  0.08194  0.12616  0.15218] , precision= [ 0.02870  0.01861  0.01409  0.01136] , auc=[0.77208], sum_recall=[0.38651]
Epoch 18 [33.1s + 13.2s]: train==[2.44178 = 0.19181 + 2.24998], recall= [ 0.02633  0.08089  0.12834  0.15055] , precision= [ 0.02957  0.01826  0.01435  0.01130] , auc=[0.77305], sum_recall=[0.38611]
Epoch 19 [31.2s + 15.4s]: train==[2.43668 = 0.19119 + 2.24549], recall= [ 0.02459  0.07959  0.12921  0.15066] , precision= [ 0.02783  0.01791  0.01443  0.01136] , auc=[0.77413], sum_recall=[0.38404]
Epoch 20 [34.1s + 14.2s]: train==[2.42687 = 0.18563 + 2.24124], recall= [ 0.02459  0.07872  0.13236  0.15109] , precision= [ 0.02783  0.01774  0.01478  0.01136] , auc=[0.77520], sum_recall=[0.38676]
Epoch 21 [27.0s + 12.1s]: train==[2.42036 = 0.18324 + 2.23712], recall= [ 0.02575  0.08144  0.13236  0.15370] , precision= [ 0.02957  0.01843  0.01478  0.01154] , auc=[0.77638], sum_recall=[0.39325]
Epoch 22 [26.8s + 12.1s]: train==[2.41360 = 0.18049 + 2.23310], recall= [ 0.02488  0.08144  0.13149  0.15370] , precision= [ 0.02870  0.01843  0.01470  0.01154] , auc=[0.77751], sum_recall=[0.39151]
Epoch 23 [26.7s + 12.3s]: train==[2.40240 = 0.17332 + 2.22907], recall= [ 0.02444  0.08013  0.13178  0.15577] , precision= [ 0.02783  0.01826  0.01478  0.01165] , auc=[0.77863], sum_recall=[0.39212]
Epoch 24 [26.9s + 12.7s]: train==[2.39230 = 0.16724 + 2.22506], recall= [ 0.02444  0.08118  0.13004  0.15736] , precision= [ 0.02783  0.01861  0.01461  0.01183] , auc=[0.77944], sum_recall=[0.39302]
Epoch 25 [26.9s + 11.9s]: train==[2.39179 = 0.17108 + 2.22071], recall= [ 0.02444  0.08031  0.13091  0.15910] , precision= [ 0.02783  0.01843  0.01470  0.01188] , auc=[0.78013], sum_recall=[0.39476]
Epoch 26 [26.9s + 12.5s]: train==[2.38438 = 0.16859 + 2.21579], recall= [ 0.02531  0.08118  0.13178  0.15975] , precision= [ 0.02870  0.01861  0.01478  0.01200] , auc=[0.78074], sum_recall=[0.39802]
Epoch 27 [26.9s + 12.6s]: train==[2.37220 = 0.16176 + 2.21044], recall= [ 0.02357  0.08161  0.12961  0.15801] , precision= [ 0.02696  0.01878  0.01452  0.01188] , auc=[0.78093], sum_recall=[0.39280]
Epoch 28 [29.3s + 12.8s]: train==[2.36581 = 0.16094 + 2.20486], recall= [ 0.02343  0.08492  0.12845  0.15758] , precision= [ 0.02609  0.01930  0.01435  0.01183] , auc=[0.78097], sum_recall=[0.39437]
Epoch 29 [27.0s + 13.6s]: train==[2.35298 = 0.15452 + 2.19846], recall= [ 0.02256  0.08665  0.12961  0.15888] , precision= [ 0.02522  0.01965  0.01452  0.01188] , auc=[0.78105], sum_recall=[0.39770]
Epoch 30 [27.3s + 12.8s]: train==[2.34832 = 0.15674 + 2.19159], recall= [ 0.02256  0.08742  0.12769  0.16219] , precision= [ 0.02522  0.01965  0.01426  0.01206] , auc=[0.78130], sum_recall=[0.39986]
Epoch 31 [31.7s + 12.2s]: train==[2.33213 = 0.14835 + 2.18379], recall= [ 0.02285  0.08394  0.12900  0.16132] , precision= [ 0.02609  0.01896  0.01443  0.01206] , auc=[0.78189], sum_recall=[0.39710]
Epoch 32 [26.9s + 12.7s]: train==[2.32617 = 0.15052 + 2.17565], recall= [ 0.02256  0.08437  0.13059  0.16001] , precision= [ 0.02522  0.01896  0.01452  0.01200] , auc=[0.78258], sum_recall=[0.39754]
Epoch 33 [26.8s + 13.0s]: train==[2.30895 = 0.14171 + 2.16724], recall= [ 0.02517  0.08372  0.13030  0.16074] , precision= [ 0.02783  0.01896  0.01461  0.01212] , auc=[0.78331], sum_recall=[0.39993]
Epoch 34 [26.8s + 12.7s]: train==[2.29891 = 0.14001 + 2.15890], recall= [ 0.02473  0.08383  0.13030  0.15987] , precision= [ 0.02696  0.01913  0.01461  0.01206] , auc=[0.78393], sum_recall=[0.39873]
Epoch 35 [27.2s + 12.2s]: train==[2.28470 = 0.13395 + 2.15075], recall= [ 0.02517  0.08383  0.12987  0.16052] , precision= [ 0.02696  0.01913  0.01461  0.01206] , auc=[0.78437], sum_recall=[0.39938]
Epoch 36 [28.1s + 12.3s]: train==[2.27267 = 0.12961 + 2.14306], recall= [ 0.02604  0.08441  0.13248  0.16052] , precision= [ 0.02783  0.01913  0.01487  0.01206] , auc=[0.78439], sum_recall=[0.40344]
Epoch 37 [32.5s + 12.8s]: train==[2.26811 = 0.13197 + 2.13614], recall= [ 0.02778  0.08484  0.13161  0.16008] , precision= [ 0.02957  0.01930  0.01478  0.01200] , auc=[0.78403], sum_recall=[0.40431]
Epoch 38 [27.0s + 13.0s]: train==[2.26224 = 0.13225 + 2.12998], recall= [ 0.02778  0.08281  0.13001  0.15719] , precision= [ 0.02957  0.01878  0.01461  0.01177] , auc=[0.78345], sum_recall=[0.39779]
Epoch 39 [27.1s + 12.4s]: train==[2.25828 = 0.13388 + 2.12440], recall= [ 0.02662  0.08260  0.12566  0.15559] , precision= [ 0.02783  0.01861  0.01417  0.01165] , auc=[0.78289], sum_recall=[0.39047]
Epoch 40 [26.8s + 12.5s]: train==[2.24396 = 0.12411 + 2.11985], recall= [ 0.02749  0.08347  0.12513  0.15327] , precision= [ 0.02870  0.01878  0.01400  0.01159] , auc=[0.78250], sum_recall=[0.38936]
Epoch 41 [26.9s + 13.0s]: train==[2.25046 = 0.13470 + 2.11577], recall= [ 0.02749  0.08477  0.12306  0.15197] , precision= [ 0.02870  0.01930  0.01391  0.01148] , auc=[0.78200], sum_recall=[0.38728]
Epoch 42 [27.0s + 13.3s]: train==[2.24650 = 0.13328 + 2.11322], recall= [ 0.02401  0.08607  0.12407  0.15284] , precision= [ 0.02522  0.01948  0.01400  0.01154] , auc=[0.78173], sum_recall=[0.38699]
Epoch 43 [27.1s + 13.1s]: train==[2.24123 = 0.12987 + 2.11136], recall= [ 0.02401  0.08738  0.12306  0.15255] , precision= [ 0.02522  0.01965  0.01400  0.01148] , auc=[0.78129], sum_recall=[0.38699]
Epoch 44 [26.9s + 12.5s]: train==[2.23348 = 0.12383 + 2.10965], recall= [ 0.02836  0.08434  0.12209  0.15211] , precision= [ 0.02957  0.01878  0.01383  0.01148] , auc=[0.78077], sum_recall=[0.38690]
Epoch 45 [26.8s + 12.9s]: train==[2.23650 = 0.12796 + 2.10854], recall= [ 0.02836  0.08738  0.12107  0.15047] , precision= [ 0.02957  0.01948  0.01365  0.01142] , auc=[0.78006], sum_recall=[0.38728]
Epoch 46 [26.9s + 13.6s]: train==[2.23184 = 0.12353 + 2.10831], recall= [ 0.02836  0.08912  0.12238  0.14772] , precision= [ 0.02957  0.01983  0.01365  0.01125] , auc=[0.77926], sum_recall=[0.38757]
End of trainning! Best recall= [ 0.02604  0.08441  0.13248  0.16052] , precision= [ 0.02783  0.01913  0.01487  0.01206] , auc=[0.78439]
