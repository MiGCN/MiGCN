Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross2', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-24 11:41:03
loading data...
[n_users, n_items]=[3209, 12211]
[n_train, n_test]=[2636, 1318]
[n_edges]=[285362]
Using GPU 0,  memory_free: 20119
tensor([ 0.0346, -0.0019,  0.0132,  0.0153, -0.0127], device='cuda:0')
Loading Model..Number of Model Parameters:  3324802
Epoch 0 [39.0s + 9.8s]: train==[5.19147 = 2.88109 + 2.31039], recall= [ 0.00255  0.01119  0.01395  0.01736] , precision= [ 0.00255  0.00238  0.00153  0.00125] , auc=[0.50409], sum_recall=[0.04505]
Epoch 1 [39.0s + 10.0s]: train==[3.51232 = 1.20398 + 2.30834], recall= [ 0.02200  0.07375  0.11578  0.14651] , precision= [ 0.02383  0.01668  0.01319  0.01101] , auc=[0.69271], sum_recall=[0.35804]
Epoch 2 [39.4s + 10.5s]: train==[3.04386 = 0.74384 + 2.30002], recall= [ 0.02794  0.08277  0.15734  0.19407] , precision= [ 0.03149  0.01872  0.01762  0.01458] , auc=[0.76091], sum_recall=[0.46213]
Epoch 3 [39.3s + 11.6s]: train==[2.86542 = 0.57443 + 2.29100], recall= [ 0.02666  0.09866  0.16628  0.20872] , precision= [ 0.03064  0.02179  0.01855  0.01566] , auc=[0.77924], sum_recall=[0.50032]
Epoch 4 [38.8s + 12.3s]: train==[2.75824 = 0.47493 + 2.28332], recall= [ 0.02326  0.09909  0.17514  0.21030] , precision= [ 0.02723  0.02196  0.01957  0.01583] , auc=[0.78896], sum_recall=[0.50778]
Epoch 5 [38.6s + 12.2s]: train==[2.69654 = 0.41880 + 2.27774], recall= [ 0.02425  0.09866  0.17697  0.21157] , precision= [ 0.02809  0.02196  0.01991  0.01594] , auc=[0.79517], sum_recall=[0.51145]
Epoch 6 [39.3s + 12.1s]: train==[2.64395 = 0.36951 + 2.27443], recall= [ 0.02638  0.10034  0.17583  0.20753] , precision= [ 0.03149  0.02264  0.01974  0.01572] , auc=[0.79935], sum_recall=[0.51008]
Epoch 7 [39.1s + 12.1s]: train==[2.61507 = 0.34200 + 2.27307], recall= [ 0.02893  0.09793  0.17676  0.21030] , precision= [ 0.03404  0.02196  0.01974  0.01589] , auc=[0.80305], sum_recall=[0.51391]
Epoch 8 [38.9s + 15.7s]: train==[2.59716 = 0.32410 + 2.27305], recall= [ 0.03148  0.10164  0.17718  0.21135] , precision= [ 0.03660  0.02264  0.01974  0.01589] , auc=[0.80604], sum_recall=[0.52165]
Epoch 9 [39.2s + 19.8s]: train==[2.57660 = 0.30309 + 2.27351], recall= [ 0.03191  0.10065  0.17910  0.21312] , precision= [ 0.03660  0.02264  0.01991  0.01606] , auc=[0.80810], sum_recall=[0.52477]
Epoch 10 [39.2s + 12.9s]: train==[2.55489 = 0.28119 + 2.27370], recall= [ 0.03219  0.09992  0.17555  0.21340] , precision= [ 0.03745  0.02264  0.01966  0.01611] , auc=[0.80999], sum_recall=[0.52106]
Epoch 11 [39.1s + 11.4s]: train==[2.55021 = 0.27734 + 2.27287], recall= [ 0.03219  0.10190  0.17853  0.21306] , precision= [ 0.03745  0.02315  0.02000  0.01611] , auc=[0.81159], sum_recall=[0.52569]
Epoch 12 [39.3s + 11.7s]: train==[2.53672 = 0.26625 + 2.27048], recall= [ 0.03304  0.10288  0.17477  0.21462] , precision= [ 0.03830  0.02349  0.01974  0.01628] , auc=[0.81295], sum_recall=[0.52531]
Epoch 13 [39.4s + 12.7s]: train==[2.51847 = 0.25138 + 2.26708], recall= [ 0.03389  0.10373  0.17621  0.21483] , precision= [ 0.04000  0.02366  0.01991  0.01628] , auc=[0.81449], sum_recall=[0.52866]
Epoch 14 [39.2s + 12.5s]: train==[2.50767 = 0.24477 + 2.26290], recall= [ 0.03389  0.10741  0.17692  0.21952] , precision= [ 0.04000  0.02451  0.02000  0.01674] , auc=[0.81626], sum_recall=[0.53774]
Epoch 15 [39.4s + 11.9s]: train==[2.49651 = 0.23798 + 2.25853], recall= [ 0.03475  0.10642  0.17512  0.22037] , precision= [ 0.04085  0.02451  0.02000  0.01679] , auc=[0.81775], sum_recall=[0.53666]
Epoch 16 [39.2s + 11.6s]: train==[2.48730 = 0.23302 + 2.25429], recall= [ 0.03475  0.10897  0.18023  0.22207] , precision= [ 0.04085  0.02502  0.02060  0.01691] , auc=[0.81912], sum_recall=[0.54602]
Epoch 17 [39.6s + 12.6s]: train==[2.46723 = 0.21680 + 2.25043], recall= [ 0.03475  0.10897  0.17853  0.22356] , precision= [ 0.04085  0.02502  0.02043  0.01708] , auc=[0.82026], sum_recall=[0.54581]
Epoch 18 [39.0s + 11.4s]: train==[2.46541 = 0.21855 + 2.24686], recall= [ 0.03475  0.10997  0.17810  0.22483] , precision= [ 0.04085  0.02519  0.02034  0.01713] , auc=[0.82104], sum_recall=[0.54765]
Epoch 19 [38.5s + 10.9s]: train==[2.45291 = 0.20944 + 2.24347], recall= [ 0.03475  0.10954  0.18224  0.22186] , precision= [ 0.04085  0.02502  0.02068  0.01691] , auc=[0.82170], sum_recall=[0.54838]
Epoch 20 [38.7s + 11.7s]: train==[2.44481 = 0.20434 + 2.24047], recall= [ 0.03304  0.11124  0.18266  0.22207] , precision= [ 0.03915  0.02536  0.02085  0.01696] , auc=[0.82225], sum_recall=[0.54902]
Epoch 21 [38.5s + 11.2s]: train==[2.43603 = 0.19838 + 2.23766], recall= [ 0.03347  0.11295  0.18266  0.22249] , precision= [ 0.03915  0.02570  0.02085  0.01696] , auc=[0.82246], sum_recall=[0.55157]
Epoch 22 [38.4s + 11.3s]: train==[2.42597 = 0.19067 + 2.23530], recall= [ 0.03304  0.11252  0.18358  0.22329] , precision= [ 0.03830  0.02570  0.02102  0.01696] , auc=[0.82251], sum_recall=[0.55244]
Epoch 23 [38.5s + 11.4s]: train==[2.42084 = 0.18758 + 2.23326], recall= [ 0.03475  0.11422  0.18273  0.22257] , precision= [ 0.04000  0.02604  0.02094  0.01696] , auc=[0.82239], sum_recall=[0.55427]
Epoch 24 [38.5s + 11.2s]: train==[2.41996 = 0.18837 + 2.23159], recall= [ 0.03389  0.11507  0.18486  0.22214] , precision= [ 0.03915  0.02621  0.02111  0.01691] , auc=[0.82252], sum_recall=[0.55597]
Epoch 25 [38.4s + 11.4s]: train==[2.41039 = 0.18033 + 2.23007], recall= [ 0.03560  0.11635  0.18699  0.22143] , precision= [ 0.04085  0.02655  0.02136  0.01691] , auc=[0.82267], sum_recall=[0.56037]
Epoch 26 [38.4s + 12.2s]: train==[2.40377 = 0.17509 + 2.22868], recall= [ 0.03560  0.11465  0.18763  0.22058] , precision= [ 0.04085  0.02621  0.02145  0.01685] , auc=[0.82283], sum_recall=[0.55845]
Epoch 27 [38.7s + 10.5s]: train==[2.39979 = 0.17246 + 2.22733], recall= [ 0.03475  0.11422  0.18975  0.22101] , precision= [ 0.04000  0.02604  0.02170  0.01691] , auc=[0.82291], sum_recall=[0.55973]
Epoch 28 [38.5s + 11.0s]: train==[2.39282 = 0.16653 + 2.22629], recall= [ 0.03389  0.11444  0.18763  0.22373] , precision= [ 0.03915  0.02621  0.02145  0.01719] , auc=[0.82284], sum_recall=[0.55969]
Epoch 29 [38.5s + 11.9s]: train==[2.39314 = 0.16765 + 2.22548], recall= [ 0.03304  0.11401  0.18771  0.22505] , precision= [ 0.03830  0.02621  0.02153  0.01725] , auc=[0.82271], sum_recall=[0.55982]
Epoch 30 [38.6s + 11.3s]: train==[2.38696 = 0.16202 + 2.22494], recall= [ 0.03347  0.11593  0.18814  0.22573] , precision= [ 0.03915  0.02672  0.02153  0.01725] , auc=[0.82245], sum_recall=[0.56327]
Epoch 31 [38.7s + 11.4s]: train==[2.38119 = 0.15657 + 2.22462], recall= [ 0.03304  0.11678  0.18601  0.22616] , precision= [ 0.03830  0.02689  0.02128  0.01725] , auc=[0.82214], sum_recall=[0.56199]
Epoch 32 [38.6s + 11.5s]: train==[2.38042 = 0.15599 + 2.22444], recall= [ 0.03475  0.11550  0.18346  0.22642] , precision= [ 0.04000  0.02655  0.02102  0.01725] , auc=[0.82198], sum_recall=[0.56012]
Epoch 33 [39.1s + 11.2s]: train==[2.37894 = 0.15460 + 2.22434], recall= [ 0.03517  0.11656  0.18592  0.22556] , precision= [ 0.04000  0.02689  0.02128  0.01719] , auc=[0.82217], sum_recall=[0.56322]
Epoch 34 [38.6s + 11.1s]: train==[2.37115 = 0.14684 + 2.22431], recall= [ 0.03900  0.11444  0.18592  0.22556] , precision= [ 0.04426  0.02638  0.02128  0.01719] , auc=[0.82236], sum_recall=[0.56492]
Epoch 35 [38.5s + 11.9s]: train==[2.37560 = 0.15129 + 2.22431], recall= [ 0.04070  0.11507  0.18762  0.22727] , precision= [ 0.04596  0.02638  0.02145  0.01730] , auc=[0.82245], sum_recall=[0.57066]
Epoch 36 [38.6s + 11.6s]: train==[2.36915 = 0.14481 + 2.22434], recall= [ 0.04070  0.11486  0.18634  0.22812] , precision= [ 0.04596  0.02655  0.02128  0.01736] , auc=[0.82208], sum_recall=[0.57003]
Epoch 37 [38.5s + 11.0s]: train==[2.36168 = 0.13734 + 2.22434], recall= [ 0.03985  0.11571  0.18549  0.22989] , precision= [ 0.04511  0.02655  0.02119  0.01748] , auc=[0.82173], sum_recall=[0.57095]
End of trainning! Best recall= [ 0.03475  0.11422  0.18975  0.22101] , precision= [ 0.04000  0.02604  0.02170  0.01691] , auc=[0.82291]
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross2', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-24 12:13:18
loading data...
[n_users, n_items]=[3209, 12211]
[n_train, n_test]=[2636, 1318]
[n_edges]=[285362]
Using GPU 1,  memory_free: 24265
tensor([-0.0016, -0.0406,  0.0339, -0.0334, -0.0054], device='cuda:1')
Loading Model..Number of Model Parameters:  3324802
Epoch 0 [38.7s + 9.4s]: train==[5.11616 = 2.79532 + 2.32084], recall= [ 0.00596  0.01062  0.01530  0.01785] , precision= [ 0.00596  0.00238  0.00170  0.00130] , auc=[0.49743], sum_recall=[0.04973]
Epoch 1 [38.8s + 9.6s]: train==[3.53971 = 1.22119 + 2.31853], recall= [ 0.02347  0.07385  0.11910  0.13844] , precision= [ 0.02723  0.01702  0.01353  0.01050] , auc=[0.69024], sum_recall=[0.35487]
Epoch 2 [39.1s + 9.7s]: train==[3.04557 = 0.73523 + 2.31034], recall= [ 0.02892  0.09068  0.15454  0.18871] , precision= [ 0.03234  0.02026  0.01736  0.01401] , auc=[0.76140], sum_recall=[0.46285]
Epoch 3 [39.3s + 11.3s]: train==[2.86149 = 0.56028 + 2.30121], recall= [ 0.03041  0.09454  0.16013  0.20776] , precision= [ 0.03489  0.02162  0.01804  0.01549] , auc=[0.78226], sum_recall=[0.49284]
Epoch 4 [39.3s + 11.4s]: train==[2.75129 = 0.45806 + 2.29323], recall= [ 0.03730  0.09910  0.16471  0.21523] , precision= [ 0.04255  0.02247  0.01821  0.01600] , auc=[0.78963], sum_recall=[0.51634]
Epoch 5 [39.5s + 10.9s]: train==[2.69005 = 0.40284 + 2.28721], recall= [ 0.03645  0.09995  0.17038  0.21512] , precision= [ 0.04170  0.02230  0.01889  0.01611] , auc=[0.79519], sum_recall=[0.52190]
Epoch 6 [39.0s + 11.6s]: train==[2.64572 = 0.36232 + 2.28341], recall= [ 0.03276  0.10123  0.16918  0.21491] , precision= [ 0.03745  0.02247  0.01898  0.01623] , auc=[0.79934], sum_recall=[0.51808]
Epoch 7 [39.0s + 11.5s]: train==[2.60991 = 0.32844 + 2.28147], recall= [ 0.03276  0.10357  0.17010  0.21512] , precision= [ 0.03745  0.02315  0.01915  0.01623] , auc=[0.80243], sum_recall=[0.52155]
Epoch 8 [39.4s + 11.0s]: train==[2.59583 = 0.31505 + 2.28078], recall= [ 0.03276  0.09995  0.17074  0.21597] , precision= [ 0.03745  0.02230  0.01906  0.01628] , auc=[0.80465], sum_recall=[0.51942]
Epoch 9 [39.3s + 11.2s]: train==[2.57928 = 0.29891 + 2.28038], recall= [ 0.03276  0.09825  0.17159  0.21796] , precision= [ 0.03830  0.02213  0.01923  0.01634] , auc=[0.80601], sum_recall=[0.52056]
Epoch 10 [39.0s + 12.3s]: train==[2.56036 = 0.28094 + 2.27942], recall= [ 0.03389  0.09898  0.17093  0.21696] , precision= [ 0.04000  0.02213  0.01923  0.01645] , auc=[0.80721], sum_recall=[0.52077]
Epoch 11 [39.2s + 11.7s]: train==[2.54972 = 0.27248 + 2.27725], recall= [ 0.03503  0.10168  0.17228  0.21739] , precision= [ 0.04170  0.02298  0.01940  0.01645] , auc=[0.80824], sum_recall=[0.52637]
Epoch 12 [39.0s + 10.9s]: train==[2.53646 = 0.26302 + 2.27344], recall= [ 0.03503  0.10137  0.16944  0.21696] , precision= [ 0.04170  0.02315  0.01906  0.01634] , auc=[0.80936], sum_recall=[0.52281]
Epoch 13 [38.8s + 11.6s]: train==[2.51800 = 0.24936 + 2.26864], recall= [ 0.03588  0.10095  0.17051  0.21547] , precision= [ 0.04255  0.02298  0.01932  0.01617] , auc=[0.81092], sum_recall=[0.52281]
Epoch 14 [39.6s + 11.2s]: train==[2.50248 = 0.23916 + 2.26332], recall= [ 0.03503  0.10103  0.17306  0.21505] , precision= [ 0.04085  0.02315  0.01957  0.01617] , auc=[0.81280], sum_recall=[0.52417]
Epoch 15 [39.4s + 11.1s]: train==[2.49385 = 0.23558 + 2.25827], recall= [ 0.03333  0.10188  0.17221  0.21505] , precision= [ 0.03915  0.02332  0.01949  0.01617] , auc=[0.81446], sum_recall=[0.52247]
Epoch 16 [39.2s + 11.7s]: train==[2.47947 = 0.22600 + 2.25347], recall= [ 0.03333  0.10018  0.17298  0.21505] , precision= [ 0.03915  0.02281  0.01949  0.01617] , auc=[0.81607], sum_recall=[0.52153]
Epoch 17 [39.0s + 11.4s]: train==[2.45979 = 0.21059 + 2.24920], recall= [ 0.03333  0.10115  0.17391  0.21767] , precision= [ 0.03915  0.02298  0.01966  0.01645] , auc=[0.81663], sum_recall=[0.52606]
Epoch 18 [39.6s + 11.4s]: train==[2.46131 = 0.21604 + 2.24527], recall= [ 0.03333  0.09988  0.17335  0.21824] , precision= [ 0.03915  0.02281  0.01966  0.01645] , auc=[0.81719], sum_recall=[0.52479]
Epoch 19 [39.1s + 11.4s]: train==[2.44890 = 0.20731 + 2.24160], recall= [ 0.03375  0.09975  0.17493  0.22037] , precision= [ 0.03915  0.02264  0.01974  0.01662] , auc=[0.81749], sum_recall=[0.52880]
Epoch 20 [39.0s + 12.0s]: train==[2.44008 = 0.20162 + 2.23846], recall= [ 0.03375  0.10146  0.17493  0.21909] , precision= [ 0.03915  0.02315  0.01974  0.01651] , auc=[0.81758], sum_recall=[0.52923]
Epoch 21 [39.1s + 11.0s]: train==[2.42937 = 0.19364 + 2.23574], recall= [ 0.03460  0.09933  0.17663  0.21824] , precision= [ 0.04000  0.02264  0.01991  0.01645] , auc=[0.81743], sum_recall=[0.52880]
Epoch 22 [39.2s + 11.1s]: train==[2.42394 = 0.19044 + 2.23351], recall= [ 0.03545  0.09890  0.17748  0.21947] , precision= [ 0.04085  0.02247  0.02000  0.01662] , auc=[0.81729], sum_recall=[0.53131]
Epoch 23 [39.5s + 12.0s]: train==[2.41553 = 0.18392 + 2.23161], recall= [ 0.03716  0.09967  0.17620  0.21990] , precision= [ 0.04255  0.02247  0.01983  0.01668] , auc=[0.81714], sum_recall=[0.53293]
Epoch 24 [39.0s + 11.3s]: train==[2.41705 = 0.18707 + 2.22997], recall= [ 0.03886  0.10103  0.17535  0.22172] , precision= [ 0.04426  0.02281  0.01974  0.01685] , auc=[0.81727], sum_recall=[0.53696]
Epoch 25 [39.1s + 11.6s]: train==[2.40595 = 0.17758 + 2.22837], recall= [ 0.03971  0.09890  0.17578  0.22279] , precision= [ 0.04511  0.02230  0.01983  0.01696] , auc=[0.81750], sum_recall=[0.53718]
Epoch 26 [39.0s + 12.0s]: train==[2.39987 = 0.17296 + 2.22692], recall= [ 0.03971  0.09805  0.18049  0.22321] , precision= [ 0.04511  0.02196  0.02043  0.01696] , auc=[0.81771], sum_recall=[0.54146]
Epoch 27 [39.3s + 11.7s]: train==[2.39526 = 0.16970 + 2.22556], recall= [ 0.03843  0.09890  0.17947  0.22123] , precision= [ 0.04340  0.02230  0.02026  0.01691] , auc=[0.81802], sum_recall=[0.53803]
Epoch 28 [39.0s + 11.2s]: train==[2.38726 = 0.16258 + 2.22469], recall= [ 0.03843  0.09848  0.18070  0.21952] , precision= [ 0.04340  0.02230  0.02051  0.01679] , auc=[0.81820], sum_recall=[0.53713]
Epoch 29 [39.3s + 11.7s]: train==[2.38855 = 0.16447 + 2.22408], recall= [ 0.03645  0.10316  0.18015  0.21853] , precision= [ 0.04085  0.02332  0.02034  0.01668] , auc=[0.81855], sum_recall=[0.53829]
Epoch 30 [39.3s + 11.4s]: train==[2.38368 = 0.15996 + 2.22372], recall= [ 0.03730  0.10401  0.18223  0.21798] , precision= [ 0.04170  0.02349  0.02051  0.01657] , auc=[0.81865], sum_recall=[0.54152]
Epoch 31 [39.0s + 10.9s]: train==[2.37887 = 0.15542 + 2.22345], recall= [ 0.03900  0.10316  0.18181  0.21501] , precision= [ 0.04340  0.02332  0.02043  0.01634] , auc=[0.81863], sum_recall=[0.53897]
Epoch 32 [39.2s + 11.8s]: train==[2.37696 = 0.15376 + 2.22320], recall= [ 0.03985  0.10231  0.18266  0.21628] , precision= [ 0.04426  0.02315  0.02051  0.01640] , auc=[0.81900], sum_recall=[0.54110]
Epoch 33 [39.1s + 11.7s]: train==[2.37504 = 0.15215 + 2.22288], recall= [ 0.03815  0.10316  0.18138  0.21964] , precision= [ 0.04340  0.02332  0.02034  0.01674] , auc=[0.81968], sum_recall=[0.54233]
Epoch 34 [39.0s + 11.1s]: train==[2.36417 = 0.14157 + 2.22260], recall= [ 0.03645  0.10273  0.18407  0.22207] , precision= [ 0.04170  0.02315  0.02068  0.01685] , auc=[0.81988], sum_recall=[0.54533]
Epoch 35 [38.9s + 11.0s]: train==[2.37259 = 0.15029 + 2.22230], recall= [ 0.03730  0.10358  0.18108  0.22122] , precision= [ 0.04255  0.02332  0.02043  0.01685] , auc=[0.81999], sum_recall=[0.54318]
Epoch 36 [38.8s + 11.3s]: train==[2.36616 = 0.14427 + 2.22189], recall= [ 0.03985  0.10231  0.18236  0.22025] , precision= [ 0.04511  0.02298  0.02060  0.01674] , auc=[0.81967], sum_recall=[0.54476]
Epoch 37 [39.0s + 10.9s]: train==[2.35621 = 0.13506 + 2.22114], recall= [ 0.03815  0.10529  0.18193  0.21798] , precision= [ 0.04340  0.02366  0.02051  0.01651] , auc=[0.81930], sum_recall=[0.54335]
Epoch 38 [39.0s + 11.0s]: train==[2.35463 = 0.13452 + 2.22011], recall= [ 0.03985  0.10656  0.18023  0.21968] , precision= [ 0.04511  0.02400  0.02034  0.01662] , auc=[0.81928], sum_recall=[0.54632]
Epoch 39 [39.2s + 11.3s]: train==[2.35193 = 0.13312 + 2.21881], recall= [ 0.03687  0.10699  0.18023  0.22099] , precision= [ 0.04170  0.02400  0.02034  0.01674] , auc=[0.81951], sum_recall=[0.54508]
Epoch 40 [39.2s + 12.2s]: train==[2.35090 = 0.13354 + 2.21736], recall= [ 0.03602  0.10358  0.17938  0.22113] , precision= [ 0.04085  0.02332  0.02017  0.01679] , auc=[0.81954], sum_recall=[0.54012]
Epoch 41 [39.0s + 12.3s]: train==[2.34255 = 0.12680 + 2.21574], recall= [ 0.03602  0.10614  0.17981  0.21941] , precision= [ 0.04085  0.02383  0.02026  0.01668] , auc=[0.81910], sum_recall=[0.54138]
Epoch 42 [39.2s + 11.5s]: train==[2.34574 = 0.13196 + 2.21379], recall= [ 0.03432  0.10358  0.18023  0.21718] , precision= [ 0.03915  0.02332  0.02034  0.01634] , auc=[0.81852], sum_recall=[0.53532]
Epoch 43 [39.2s + 11.1s]: train==[2.34410 = 0.13281 + 2.21129], recall= [ 0.03517  0.10444  0.18023  0.21846] , precision= [ 0.04000  0.02349  0.02034  0.01640] , auc=[0.81846], sum_recall=[0.53830]
Epoch 44 [38.9s + 11.2s]: train==[2.33308 = 0.12511 + 2.20797], recall= [ 0.03602  0.10358  0.18193  0.22028] , precision= [ 0.04085  0.02332  0.02051  0.01657] , auc=[0.81785], sum_recall=[0.54182]
Epoch 45 [39.5s + 11.8s]: train==[2.32678 = 0.12324 + 2.20353], recall= [ 0.03687  0.10401  0.18023  0.21986] , precision= [ 0.04170  0.02315  0.02034  0.01657] , auc=[0.81705], sum_recall=[0.54097]
End of trainning! Best recall= [ 0.03730  0.10358  0.18108  0.22122] , precision= [ 0.04255  0.02332  0.02043  0.01685] , auc=[0.81999]
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross2', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-24 12:52:08
loading data...
[n_users, n_items]=[3209, 12211]
[n_train, n_test]=[2636, 1318]
[n_edges]=[285362]
Using GPU 1,  memory_free: 24265
tensor([ 0.0003,  0.0199, -0.0344, -0.0028,  0.0391], device='cuda:1')
Loading Model..Number of Model Parameters:  3324802
Epoch 0 [38.5s + 9.8s]: train==[5.11506 = 2.79428 + 2.32078], recall= [ 0.00523  0.00863  0.01544  0.01897] , precision= [ 0.00596  0.00187  0.00170  0.00142] , auc=[0.51306], sum_recall=[0.04827]
Epoch 1 [39.0s + 10.3s]: train==[3.55731 = 1.23809 + 2.31922], recall= [ 0.02276  0.06992  0.11691  0.14344] , precision= [ 0.02638  0.01617  0.01345  0.01089] , auc=[0.69598], sum_recall=[0.35303]
Epoch 2 [38.5s + 9.8s]: train==[3.06019 = 0.74907 + 2.31112], recall= [ 0.02950  0.09190  0.14452  0.18313] , precision= [ 0.03489  0.02094  0.01643  0.01396] , auc=[0.76731], sum_recall=[0.44905]
Epoch 3 [38.4s + 10.9s]: train==[2.88538 = 0.58343 + 2.30194], recall= [ 0.02865  0.10126  0.15622  0.20251] , precision= [ 0.03489  0.02298  0.01762  0.01538] , auc=[0.78292], sum_recall=[0.48865]
Epoch 4 [39.0s + 11.9s]: train==[2.76170 = 0.46794 + 2.29376], recall= [ 0.02780  0.10410  0.16317  0.20847] , precision= [ 0.03404  0.02383  0.01864  0.01577] , auc=[0.78932], sum_recall=[0.50354]
Epoch 5 [38.9s + 11.0s]: train==[2.70067 = 0.41318 + 2.28749], recall= [ 0.02652  0.10304  0.16544  0.21351] , precision= [ 0.03319  0.02349  0.01881  0.01606] , auc=[0.79403], sum_recall=[0.50851]
Epoch 6 [38.5s + 11.4s]: train==[2.64879 = 0.36541 + 2.28338], recall= [ 0.02431  0.09637  0.16644  0.21464] , precision= [ 0.03064  0.02213  0.01889  0.01611] , auc=[0.79836], sum_recall=[0.50175]
Epoch 7 [38.4s + 12.4s]: train==[2.62105 = 0.33985 + 2.28120], recall= [ 0.02453  0.09935  0.16537  0.21677] , precision= [ 0.03064  0.02281  0.01872  0.01628] , auc=[0.80267], sum_recall=[0.50602]
Epoch 8 [38.5s + 11.3s]: train==[2.60271 = 0.32222 + 2.28049], recall= [ 0.02411  0.09816  0.16736  0.21322] , precision= [ 0.02979  0.02264  0.01889  0.01600] , auc=[0.80577], sum_recall=[0.50285]
Epoch 9 [38.8s + 11.6s]: train==[2.58289 = 0.30260 + 2.28029], recall= [ 0.02666  0.10156  0.16934  0.21398] , precision= [ 0.03234  0.02332  0.01923  0.01606] , auc=[0.80827], sum_recall=[0.51155]
Epoch 10 [38.3s + 11.6s]: train==[2.56330 = 0.28345 + 2.27985], recall= [ 0.02907  0.10041  0.17019  0.21235] , precision= [ 0.03489  0.02298  0.01932  0.01606] , auc=[0.81035], sum_recall=[0.51203]
Epoch 11 [38.5s + 11.2s]: train==[2.55252 = 0.27418 + 2.27834], recall= [ 0.02907  0.09885  0.17317  0.21136] , precision= [ 0.03489  0.02298  0.01966  0.01606] , auc=[0.81200], sum_recall=[0.51245]
Epoch 12 [38.1s + 11.2s]: train==[2.53936 = 0.26410 + 2.27526], recall= [ 0.02907  0.09856  0.17161  0.20838] , precision= [ 0.03489  0.02281  0.01957  0.01583] , auc=[0.81331], sum_recall=[0.50763]
Epoch 13 [38.4s + 11.6s]: train==[2.52375 = 0.25273 + 2.27103], recall= [ 0.03077  0.10239  0.17204  0.21251] , precision= [ 0.03660  0.02349  0.01957  0.01606] , auc=[0.81450], sum_recall=[0.51772]
Epoch 14 [38.8s + 11.5s]: train==[2.50714 = 0.24118 + 2.26596], recall= [ 0.03035  0.10112  0.17417  0.21351] , precision= [ 0.03660  0.02315  0.01974  0.01606] , auc=[0.81587], sum_recall=[0.51914]
Epoch 15 [39.0s + 11.5s]: train==[2.50231 = 0.24167 + 2.26064], recall= [ 0.03120  0.10367  0.17714  0.21533] , precision= [ 0.03745  0.02366  0.02000  0.01628] , auc=[0.81689], sum_recall=[0.52735]
Epoch 16 [39.0s + 12.1s]: train==[2.48669 = 0.23118 + 2.25552], recall= [ 0.02992  0.10410  0.17927  0.21874] , precision= [ 0.03574  0.02383  0.02026  0.01657] , auc=[0.81800], sum_recall=[0.53203]
Epoch 17 [38.5s + 11.8s]: train==[2.46580 = 0.21494 + 2.25086], recall= [ 0.02992  0.10495  0.17927  0.22044] , precision= [ 0.03574  0.02400  0.02026  0.01668] , auc=[0.81893], sum_recall=[0.53458]
Epoch 18 [39.0s + 11.6s]: train==[2.46753 = 0.22088 + 2.24665], recall= [ 0.03163  0.10585  0.17885  0.22327] , precision= [ 0.03745  0.02383  0.02026  0.01691] , auc=[0.81977], sum_recall=[0.53960]
Epoch 19 [38.8s + 11.9s]: train==[2.45372 = 0.21101 + 2.24271], recall= [ 0.03163  0.10415  0.17672  0.22342] , precision= [ 0.03745  0.02349  0.02000  0.01685] , auc=[0.82041], sum_recall=[0.53591]
Epoch 20 [39.2s + 12.3s]: train==[2.44402 = 0.20460 + 2.23942], recall= [ 0.03248  0.10642  0.17707  0.22320] , precision= [ 0.03830  0.02417  0.02009  0.01685] , auc=[0.82091], sum_recall=[0.53918]
Epoch 21 [41.1s + 12.1s]: train==[2.43171 = 0.19538 + 2.23633], recall= [ 0.03248  0.10642  0.17920  0.22193] , precision= [ 0.03830  0.02417  0.02026  0.01674] , auc=[0.82116], sum_recall=[0.54003]
Epoch 22 [39.1s + 11.8s]: train==[2.42704 = 0.19321 + 2.23383], recall= [ 0.03333  0.10685  0.17835  0.22223] , precision= [ 0.03915  0.02434  0.02017  0.01674] , auc=[0.82139], sum_recall=[0.54076]
Epoch 23 [39.9s + 12.2s]: train==[2.42025 = 0.18852 + 2.23172], recall= [ 0.03545  0.10783  0.18005  0.22195] , precision= [ 0.04170  0.02451  0.02034  0.01668] , auc=[0.82156], sum_recall=[0.54528]
Epoch 24 [38.8s + 12.1s]: train==[2.41967 = 0.18966 + 2.23001], recall= [ 0.03801  0.11018  0.18090  0.22152] , precision= [ 0.04426  0.02502  0.02043  0.01668] , auc=[0.82209], sum_recall=[0.55061]
Epoch 25 [39.5s + 11.8s]: train==[2.40904 = 0.18049 + 2.22855], recall= [ 0.03758  0.11261  0.18133  0.22280] , precision= [ 0.04340  0.02553  0.02043  0.01679] , auc=[0.82296], sum_recall=[0.55432]
Epoch 26 [39.3s + 12.1s]: train==[2.40406 = 0.17682 + 2.22724], recall= [ 0.03928  0.11090  0.17963  0.22438] , precision= [ 0.04511  0.02519  0.02026  0.01685] , auc=[0.82359], sum_recall=[0.55419]
Epoch 27 [38.9s + 11.7s]: train==[2.39941 = 0.17337 + 2.22604], recall= [ 0.03928  0.11090  0.18175  0.22462] , precision= [ 0.04511  0.02519  0.02051  0.01696] , auc=[0.82388], sum_recall=[0.55657]
Epoch 28 [38.5s + 11.6s]: train==[2.39172 = 0.16652 + 2.22521], recall= [ 0.03971  0.11231  0.18346  0.22564] , precision= [ 0.04596  0.02536  0.02068  0.01702] , auc=[0.82401], sum_recall=[0.56111]
Epoch 29 [39.0s + 12.2s]: train==[2.39074 = 0.16615 + 2.22459], recall= [ 0.04141  0.11188  0.18048  0.22351] , precision= [ 0.04766  0.02519  0.02043  0.01685] , auc=[0.82406], sum_recall=[0.55728]
Epoch 30 [38.5s + 11.9s]: train==[2.38596 = 0.16180 + 2.22416], recall= [ 0.04241  0.11380  0.17963  0.22223] , precision= [ 0.04766  0.02553  0.02026  0.01674] , auc=[0.82389], sum_recall=[0.55806]
Epoch 31 [39.0s + 11.8s]: train==[2.38141 = 0.15754 + 2.22387], recall= [ 0.04198  0.11188  0.17899  0.21712] , precision= [ 0.04681  0.02519  0.02026  0.01640] , auc=[0.82363], sum_recall=[0.54998]
Epoch 32 [39.8s + 12.2s]: train==[2.37951 = 0.15582 + 2.22369], recall= [ 0.04113  0.11188  0.18069  0.21670] , precision= [ 0.04596  0.02519  0.02051  0.01634] , auc=[0.82371], sum_recall=[0.55040]
Epoch 33 [40.0s + 13.2s]: train==[2.37760 = 0.15409 + 2.22351], recall= [ 0.03943  0.11018  0.17814  0.22237] , precision= [ 0.04426  0.02502  0.02026  0.01679] , auc=[0.82414], sum_recall=[0.55012]
Epoch 34 [38.7s + 11.7s]: train==[2.36840 = 0.14503 + 2.22337], recall= [ 0.03943  0.10975  0.17920  0.22181] , precision= [ 0.04426  0.02485  0.02026  0.01679] , auc=[0.82451], sum_recall=[0.55019]
Epoch 35 [39.9s + 11.9s]: train==[2.37469 = 0.15143 + 2.22326], recall= [ 0.03900  0.10890  0.18324  0.22280] , precision= [ 0.04426  0.02468  0.02085  0.01685] , auc=[0.82455], sum_recall=[0.55395]
Epoch 36 [40.0s + 12.0s]: train==[2.36984 = 0.14662 + 2.22322], recall= [ 0.03985  0.10593  0.18239  0.22393] , precision= [ 0.04511  0.02400  0.02068  0.01696] , auc=[0.82437], sum_recall=[0.55210]
Epoch 37 [40.5s + 11.5s]: train==[2.36078 = 0.13778 + 2.22300], recall= [ 0.04113  0.10635  0.17686  0.22287] , precision= [ 0.04596  0.02417  0.02009  0.01691] , auc=[0.82395], sum_recall=[0.54721]
Epoch 38 [39.0s + 11.2s]: train==[2.36016 = 0.13766 + 2.22251], recall= [ 0.04028  0.10635  0.17656  0.22230] , precision= [ 0.04511  0.02417  0.02009  0.01685] , auc=[0.82349], sum_recall=[0.54549]
Epoch 39 [38.7s + 12.0s]: train==[2.35539 = 0.13371 + 2.22168], recall= [ 0.03943  0.10465  0.17718  0.22337] , precision= [ 0.04426  0.02383  0.02017  0.01696] , auc=[0.82363], sum_recall=[0.54462]
Epoch 40 [39.2s + 11.5s]: train==[2.35426 = 0.13358 + 2.22068], recall= [ 0.03943  0.10550  0.17605  0.22266] , precision= [ 0.04426  0.02400  0.01991  0.01685] , auc=[0.82399], sum_recall=[0.54363]
Epoch 41 [38.8s + 11.8s]: train==[2.34596 = 0.12623 + 2.21973], recall= [ 0.03943  0.10422  0.17718  0.21961] , precision= [ 0.04426  0.02383  0.02009  0.01679] , auc=[0.82412], sum_recall=[0.54044]
Epoch 42 [39.7s + 12.2s]: train==[2.35211 = 0.13337 + 2.21874], recall= [ 0.03858  0.10337  0.17676  0.21812] , precision= [ 0.04340  0.02366  0.02009  0.01662] , auc=[0.82425], sum_recall=[0.53682]
Epoch 43 [39.1s + 12.0s]: train==[2.35192 = 0.13417 + 2.21775], recall= [ 0.03687  0.10635  0.17456  0.21904] , precision= [ 0.04170  0.02417  0.01974  0.01674] , auc=[0.82417], sum_recall=[0.53682]
Epoch 44 [40.9s + 12.4s]: train==[2.34179 = 0.12514 + 2.21665], recall= [ 0.03517  0.10465  0.17612  0.21847] , precision= [ 0.04000  0.02383  0.02000  0.01668] , auc=[0.82372], sum_recall=[0.53441]
Epoch 45 [39.9s + 12.3s]: train==[2.33993 = 0.12462 + 2.21531], recall= [ 0.03602  0.10493  0.17456  0.21613] , precision= [ 0.04085  0.02417  0.01974  0.01645] , auc=[0.82317], sum_recall=[0.53164]
End of trainning! Best recall= [ 0.03900  0.10890  0.18324  0.22280] , precision= [ 0.04426  0.02468  0.02085  0.01685] , auc=[0.82455]
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross2', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-24 13:31:11
loading data...
[n_users, n_items]=[3209, 12211]
[n_train, n_test]=[2636, 1318]
[n_edges]=[285362]
Using GPU 1,  memory_free: 24265
tensor([ 0.0340, -0.0328, -0.0243, -0.0286,  0.0002], device='cuda:1')
Loading Model..Number of Model Parameters:  3324802
Epoch 0 [40.0s + 10.3s]: train==[5.11667 = 2.79887 + 2.31779], recall= [ 0.00608  0.01033  0.01556  0.01684] , precision= [ 0.00681  0.00238  0.00179  0.00130] , auc=[0.50630], sum_recall=[0.04881]
Epoch 1 [39.7s + 11.2s]: train==[3.52491 = 1.20937 + 2.31554], recall= [ 0.02267  0.08237  0.11836  0.13851] , precision= [ 0.02468  0.01855  0.01336  0.01044] , auc=[0.70003], sum_recall=[0.36192]
Epoch 2 [39.0s + 10.3s]: train==[3.04020 = 0.73334 + 2.30687], recall= [ 0.02743  0.09458  0.14549  0.18011] , precision= [ 0.03064  0.02162  0.01668  0.01379] , auc=[0.76472], sum_recall=[0.44760]
Epoch 3 [39.4s + 11.8s]: train==[2.86857 = 0.57106 + 2.29750], recall= [ 0.02828  0.09699  0.15743  0.19502] , precision= [ 0.03149  0.02196  0.01804  0.01481] , auc=[0.78330], sum_recall=[0.47772]
Epoch 4 [39.0s + 12.5s]: train==[2.75021 = 0.46053 + 2.28967], recall= [ 0.02411  0.09955  0.16376  0.19865] , precision= [ 0.02809  0.02264  0.01847  0.01504] , auc=[0.79184], sum_recall=[0.48607]
Epoch 5 [39.1s + 12.3s]: train==[2.68662 = 0.40251 + 2.28412], recall= [ 0.02879  0.09669  0.17264  0.20222] , precision= [ 0.03319  0.02213  0.01957  0.01526] , auc=[0.79786], sum_recall=[0.50034]
Epoch 6 [40.0s + 11.9s]: train==[2.64376 = 0.36283 + 2.28093], recall= [ 0.02858  0.09655  0.17193  0.20520] , precision= [ 0.03404  0.02196  0.01940  0.01538] , auc=[0.80274], sum_recall=[0.50225]
Epoch 7 [39.2s + 12.4s]: train==[2.61085 = 0.33119 + 2.27966], recall= [ 0.02787  0.09783  0.17286  0.20420] , precision= [ 0.03234  0.02213  0.01949  0.01543] , auc=[0.80688], sum_recall=[0.50275]
Epoch 8 [39.1s + 11.7s]: train==[2.59295 = 0.31346 + 2.27950], recall= [ 0.02921  0.09783  0.17030  0.20654] , precision= [ 0.03404  0.02213  0.01923  0.01555] , auc=[0.80970], sum_recall=[0.50388]
Epoch 9 [39.9s + 12.1s]: train==[2.57981 = 0.30033 + 2.27948], recall= [ 0.02964  0.09697  0.17583  0.20959] , precision= [ 0.03489  0.02196  0.01991  0.01589] , auc=[0.81128], sum_recall=[0.51204]
Epoch 10 [39.9s + 12.3s]: train==[2.55717 = 0.27853 + 2.27865], recall= [ 0.02907  0.10024  0.17668  0.21300] , precision= [ 0.03489  0.02281  0.01991  0.01617] , auc=[0.81275], sum_recall=[0.51899]
Epoch 11 [40.7s + 13.4s]: train==[2.55272 = 0.27645 + 2.27628], recall= [ 0.02907  0.09853  0.17754  0.21385] , precision= [ 0.03489  0.02247  0.02000  0.01623] , auc=[0.81405], sum_recall=[0.51899]
Epoch 12 [44.1s + 14.4s]: train==[2.53417 = 0.26212 + 2.27204], recall= [ 0.02992  0.10002  0.17782  0.21556] , precision= [ 0.03574  0.02281  0.02017  0.01645] , auc=[0.81513], sum_recall=[0.52333]
Epoch 13 [39.2s + 14.3s]: train==[2.51698 = 0.25013 + 2.26686], recall= [ 0.02950  0.10109  0.17910  0.21542] , precision= [ 0.03574  0.02315  0.02034  0.01651] , auc=[0.81650], sum_recall=[0.52510]
Epoch 14 [44.9s + 14.4s]: train==[2.50163 = 0.24053 + 2.26110], recall= [ 0.02865  0.10151  0.18080  0.21798] , precision= [ 0.03489  0.02332  0.02060  0.01668] , auc=[0.81766], sum_recall=[0.52893]
Epoch 15 [44.9s + 13.6s]: train==[2.49338 = 0.23764 + 2.25574], recall= [ 0.02865  0.10244  0.18088  0.21968] , precision= [ 0.03489  0.02349  0.02060  0.01685] , auc=[0.81865], sum_recall=[0.53164]
Epoch 16 [44.7s + 14.2s]: train==[2.48252 = 0.23157 + 2.25094], recall= [ 0.03077  0.10456  0.17989  0.22152] , precision= [ 0.03745  0.02400  0.02051  0.01702] , auc=[0.81953], sum_recall=[0.53675]
Epoch 17 [38.7s + 14.5s]: train==[2.46282 = 0.21598 + 2.24684], recall= [ 0.03035  0.10754  0.18275  0.22173] , precision= [ 0.03660  0.02468  0.02077  0.01696] , auc=[0.81984], sum_recall=[0.54237]
Epoch 18 [38.6s + 14.0s]: train==[2.46273 = 0.21955 + 2.24318], recall= [ 0.02865  0.10733  0.18388  0.22301] , precision= [ 0.03489  0.02451  0.02094  0.01702] , auc=[0.82028], sum_recall=[0.54287]
Epoch 19 [38.6s + 14.4s]: train==[2.45181 = 0.21202 + 2.23978], recall= [ 0.02865  0.10733  0.17991  0.22271] , precision= [ 0.03489  0.02451  0.02060  0.01708] , auc=[0.82061], sum_recall=[0.53859]
Epoch 20 [38.8s + 14.4s]: train==[2.43837 = 0.20145 + 2.23692], recall= [ 0.02865  0.10690  0.18076  0.22271] , precision= [ 0.03489  0.02434  0.02068  0.01702] , auc=[0.82096], sum_recall=[0.53902]
Epoch 21 [38.6s + 13.6s]: train==[2.43065 = 0.19631 + 2.23433], recall= [ 0.02907  0.10775  0.17885  0.22249] , precision= [ 0.03574  0.02451  0.02051  0.01702] , auc=[0.82099], sum_recall=[0.53817]
Epoch 22 [38.6s + 13.4s]: train==[2.42267 = 0.19038 + 2.23229], recall= [ 0.02992  0.10648  0.18067  0.22065] , precision= [ 0.03660  0.02417  0.02077  0.01685] , auc=[0.82102], sum_recall=[0.53772]
Epoch 23 [38.5s + 14.9s]: train==[2.41572 = 0.18505 + 2.23068], recall= [ 0.02950  0.10946  0.18046  0.22164] , precision= [ 0.03574  0.02485  0.02068  0.01691] , auc=[0.82098], sum_recall=[0.54106]
Epoch 24 [38.6s + 13.9s]: train==[2.41433 = 0.18483 + 2.22950], recall= [ 0.03077  0.11073  0.18131  0.22228] , precision= [ 0.03745  0.02519  0.02077  0.01691] , auc=[0.82114], sum_recall=[0.54510]
Epoch 25 [38.5s + 14.4s]: train==[2.40569 = 0.17718 + 2.22851], recall= [ 0.03077  0.11073  0.18152  0.22228] , precision= [ 0.03745  0.02519  0.02085  0.01691] , auc=[0.82149], sum_recall=[0.54531]
Epoch 26 [44.8s + 14.4s]: train==[2.39899 = 0.17143 + 2.22757], recall= [ 0.03333  0.10988  0.18209  0.22313] , precision= [ 0.04000  0.02502  0.02085  0.01696] , auc=[0.82203], sum_recall=[0.54843]
Epoch 27 [38.7s + 13.6s]: train==[2.39753 = 0.17102 + 2.22651], recall= [ 0.03333  0.11073  0.18230  0.22242] , precision= [ 0.03915  0.02519  0.02077  0.01696] , auc=[0.82254], sum_recall=[0.54879]
Epoch 28 [38.6s + 14.2s]: train==[2.38926 = 0.16363 + 2.22563], recall= [ 0.03375  0.11116  0.18358  0.22514] , precision= [ 0.03915  0.02536  0.02094  0.01713] , auc=[0.82295], sum_recall=[0.55363]
Epoch 29 [38.5s + 14.0s]: train==[2.38915 = 0.16414 + 2.22500], recall= [ 0.03716  0.10988  0.18301  0.22705] , precision= [ 0.04255  0.02519  0.02094  0.01730] , auc=[0.82329], sum_recall=[0.55710]
Epoch 30 [38.5s + 14.1s]: train==[2.38524 = 0.16066 + 2.22459], recall= [ 0.03716  0.11031  0.18088  0.22386] , precision= [ 0.04255  0.02519  0.02068  0.01708] , auc=[0.82340], sum_recall=[0.55221]
Epoch 31 [38.7s + 13.8s]: train==[2.37810 = 0.15372 + 2.22437], recall= [ 0.03886  0.11031  0.18173  0.22514] , precision= [ 0.04426  0.02519  0.02077  0.01713] , auc=[0.82347], sum_recall=[0.55604]
Epoch 32 [40.4s + 14.0s]: train==[2.37648 = 0.15227 + 2.22421], recall= [ 0.03801  0.10946  0.18088  0.22471] , precision= [ 0.04340  0.02485  0.02060  0.01702] , auc=[0.82365], sum_recall=[0.55306]
Epoch 33 [38.8s + 14.0s]: train==[2.37467 = 0.15069 + 2.22398], recall= [ 0.03801  0.10775  0.17876  0.22386] , precision= [ 0.04340  0.02451  0.02043  0.01696] , auc=[0.82422], sum_recall=[0.54838]
Epoch 34 [38.6s + 13.9s]: train==[2.36785 = 0.14410 + 2.22375], recall= [ 0.03801  0.11073  0.18046  0.22549] , precision= [ 0.04340  0.02519  0.02060  0.01719] , auc=[0.82474], sum_recall=[0.55469]
Epoch 35 [38.6s + 13.8s]: train==[2.37285 = 0.14929 + 2.22356], recall= [ 0.03900  0.10954  0.18110  0.22805] , precision= [ 0.04426  0.02502  0.02060  0.01736] , auc=[0.82512], sum_recall=[0.55769]
Epoch 36 [38.5s + 13.9s]: train==[2.36642 = 0.14293 + 2.22349], recall= [ 0.04028  0.11039  0.18365  0.22379] , precision= [ 0.04511  0.02519  0.02085  0.01708] , auc=[0.82514], sum_recall=[0.55811]
Epoch 37 [38.7s + 14.0s]: train==[2.35663 = 0.13339 + 2.22324], recall= [ 0.04028  0.11210  0.18067  0.22519] , precision= [ 0.04511  0.02553  0.02051  0.01725] , auc=[0.82507], sum_recall=[0.55823]
Epoch 38 [38.7s + 14.2s]: train==[2.35748 = 0.13474 + 2.22275], recall= [ 0.03900  0.11210  0.18067  0.22441] , precision= [ 0.04340  0.02553  0.02051  0.01708] , auc=[0.82498], sum_recall=[0.55618]
Epoch 39 [45.1s + 14.8s]: train==[2.35488 = 0.13300 + 2.22188], recall= [ 0.03815  0.11167  0.18322  0.22441] , precision= [ 0.04255  0.02536  0.02085  0.01708] , auc=[0.82529], sum_recall=[0.55745]
Epoch 40 [39.0s + 13.8s]: train==[2.35440 = 0.13342 + 2.22098], recall= [ 0.03815  0.11337  0.17982  0.22739] , precision= [ 0.04255  0.02570  0.02051  0.01730] , auc=[0.82550], sum_recall=[0.55873]
Epoch 41 [39.0s + 14.9s]: train==[2.34572 = 0.12554 + 2.22019], recall= [ 0.03815  0.11210  0.18386  0.22994] , precision= [ 0.04255  0.02553  0.02102  0.01748] , auc=[0.82557], sum_recall=[0.56405]
Epoch 42 [39.7s + 15.6s]: train==[2.35286 = 0.13337 + 2.21948], recall= [ 0.03900  0.10997  0.18131  0.22952] , precision= [ 0.04340  0.02502  0.02077  0.01742] , auc=[0.82563], sum_recall=[0.55979]
Epoch 43 [40.5s + 15.4s]: train==[2.35210 = 0.13327 + 2.21883], recall= [ 0.03985  0.10699  0.18228  0.23136] , precision= [ 0.04426  0.02434  0.02094  0.01759] , auc=[0.82542], sum_recall=[0.56048]
Epoch 44 [41.6s + 13.7s]: train==[2.34392 = 0.12565 + 2.21827], recall= [ 0.03985  0.10827  0.18015  0.22753] , precision= [ 0.04426  0.02451  0.02068  0.01730] , auc=[0.82441], sum_recall=[0.55580]
Epoch 45 [38.8s + 14.5s]: train==[2.34124 = 0.12370 + 2.21754], recall= [ 0.03900  0.10720  0.17930  0.22696] , precision= [ 0.04340  0.02434  0.02068  0.01730] , auc=[0.82422], sum_recall=[0.55247]
Epoch 46 [39.4s + 18.8s]: train==[2.34198 = 0.12557 + 2.21641], recall= [ 0.03815  0.10890  0.17973  0.22696] , precision= [ 0.04255  0.02485  0.02068  0.01730] , auc=[0.82428], sum_recall=[0.55374]
Epoch 47 [54.2s + 21.5s]: train==[2.33400 = 0.11887 + 2.21513], recall= [ 0.03475  0.10791  0.17803  0.22895] , precision= [ 0.03915  0.02468  0.02051  0.01736] , auc=[0.82341], sum_recall=[0.54963]
Epoch 48 [42.8s + 15.4s]: train==[2.33352 = 0.12027 + 2.21325], recall= [ 0.03645  0.10663  0.17760  0.22554] , precision= [ 0.04085  0.02434  0.02043  0.01713] , auc=[0.82214], sum_recall=[0.54623]
Epoch 49 [40.4s + 12.2s]: train==[2.33053 = 0.11972 + 2.21081], recall= [ 0.03730  0.10451  0.18015  0.22597] , precision= [ 0.04170  0.02383  0.02068  0.01725] , auc=[0.82156], sum_recall=[0.54793]
Epoch 50 [39.7s + 12.5s]: train==[2.32492 = 0.11737 + 2.20756], recall= [ 0.03389  0.10706  0.17910  0.22547] , precision= [ 0.03830  0.02468  0.02043  0.01725] , auc=[0.82045], sum_recall=[0.54552]
Epoch 51 [41.4s + 12.0s]: train==[2.32316 = 0.11982 + 2.20334], recall= [ 0.03304  0.10706  0.17496  0.22569] , precision= [ 0.03745  0.02468  0.02009  0.01725] , auc=[0.81885], sum_recall=[0.54075]
Epoch 52 [40.2s + 13.5s]: train==[2.31929 = 0.12170 + 2.19760], recall= [ 0.03304  0.10749  0.17730  0.22037] , precision= [ 0.03745  0.02485  0.02043  0.01685] , auc=[0.81667], sum_recall=[0.53820]
End of trainning! Best recall= [ 0.03900  0.10997  0.18131  0.22952] , precision= [ 0.04340  0.02502  0.02077  0.01742] , auc=[0.82563]
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross2', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-24 14:19:03
loading data...
[n_users, n_items]=[3209, 12211]
[n_train, n_test]=[2636, 1318]
[n_edges]=[285362]
Using GPU 1,  memory_free: 24265
tensor([ 0.0118,  0.0373, -0.0013, -0.0208, -0.0361], device='cuda:1')
Loading Model..Number of Model Parameters:  3324802
Epoch 0 [40.4s + 10.6s]: train==[5.15914 = 2.84872 + 2.31042], recall= [ 0.00608  0.00948  0.01502  0.01757] , precision= [ 0.00681  0.00204  0.00162  0.00125] , auc=[0.49887], sum_recall=[0.04815]
Epoch 1 [41.6s + 11.4s]: train==[3.53085 = 1.22165 + 2.30920], recall= [ 0.01553  0.07687  0.11490  0.13823] , precision= [ 0.01787  0.01753  0.01319  0.01044] , auc=[0.68954], sum_recall=[0.34552]
Epoch 2 [41.6s + 10.7s]: train==[3.02230 = 0.72051 + 2.30178], recall= [ 0.02319  0.08850  0.14722  0.19266] , precision= [ 0.02553  0.02060  0.01694  0.01447] , auc=[0.75968], sum_recall=[0.45156]
Epoch 3 [40.2s + 12.7s]: train==[2.85020 = 0.55640 + 2.29380], recall= [ 0.02496  0.09850  0.15821  0.19601] , precision= [ 0.02894  0.02247  0.01787  0.01481] , auc=[0.78079], sum_recall=[0.47768]
Epoch 4 [39.9s + 12.1s]: train==[2.74444 = 0.45741 + 2.28703], recall= [ 0.02496  0.10467  0.15865  0.20493] , precision= [ 0.02979  0.02366  0.01804  0.01560] , auc=[0.78936], sum_recall=[0.49321]
Epoch 5 [39.6s + 12.0s]: train==[2.68489 = 0.40269 + 2.28219], recall= [ 0.02666  0.10375  0.16312  0.20230] , precision= [ 0.03149  0.02315  0.01855  0.01538] , auc=[0.79486], sum_recall=[0.49583]
Epoch 6 [40.2s + 12.2s]: train==[2.63698 = 0.35762 + 2.27936], recall= [ 0.02879  0.09685  0.16816  0.20315] , precision= [ 0.03404  0.02162  0.01898  0.01543] , auc=[0.79923], sum_recall=[0.49695]
Epoch 7 [40.7s + 11.7s]: train==[2.61049 = 0.33228 + 2.27821], recall= [ 0.02879  0.10239  0.16717  0.20315] , precision= [ 0.03404  0.02281  0.01881  0.01543] , auc=[0.80338], sum_recall=[0.50149]
Epoch 8 [39.2s + 11.5s]: train==[2.59053 = 0.31247 + 2.27806], recall= [ 0.02907  0.10153  0.16873  0.20923] , precision= [ 0.03489  0.02264  0.01889  0.01589] , auc=[0.80615], sum_recall=[0.50856]
Epoch 9 [39.3s + 12.3s]: train==[2.57779 = 0.29969 + 2.27810], recall= [ 0.02822  0.10153  0.16802  0.21051] , precision= [ 0.03404  0.02264  0.01898  0.01606] , auc=[0.80792], sum_recall=[0.50828]
Epoch 10 [42.0s + 13.5s]: train==[2.55379 = 0.27632 + 2.27747], recall= [ 0.02737  0.09799  0.17291  0.21391] , precision= [ 0.03234  0.02213  0.01949  0.01628] , auc=[0.80960], sum_recall=[0.51218]
Epoch 11 [39.8s + 12.1s]: train==[2.54743 = 0.27183 + 2.27560], recall= [ 0.02780  0.10380  0.17324  0.21306] , precision= [ 0.03319  0.02349  0.01966  0.01623] , auc=[0.81108], sum_recall=[0.51790]
Epoch 12 [40.2s + 12.3s]: train==[2.53314 = 0.26111 + 2.27203], recall= [ 0.02737  0.10551  0.17303  0.21519] , precision= [ 0.03319  0.02383  0.01957  0.01640] , auc=[0.81292], sum_recall=[0.52110]
Epoch 13 [40.9s + 12.7s]: train==[2.51738 = 0.24973 + 2.26765], recall= [ 0.02737  0.10593  0.17246  0.21561] , precision= [ 0.03319  0.02383  0.01957  0.01640] , auc=[0.81510], sum_recall=[0.52138]
Epoch 14 [40.4s + 12.5s]: train==[2.50371 = 0.24086 + 2.26284], recall= [ 0.02822  0.10848  0.17644  0.21838] , precision= [ 0.03404  0.02434  0.02009  0.01662] , auc=[0.81717], sum_recall=[0.53152]
Epoch 15 [40.1s + 12.3s]: train==[2.49565 = 0.23744 + 2.25821], recall= [ 0.02907  0.10806  0.17546  0.21710] , precision= [ 0.03489  0.02417  0.01991  0.01651] , auc=[0.81918], sum_recall=[0.52970]
Epoch 16 [39.5s + 12.0s]: train==[2.48424 = 0.23044 + 2.25380], recall= [ 0.02992  0.10650  0.17589  0.22037] , precision= [ 0.03574  0.02400  0.01991  0.01679] , auc=[0.82084], sum_recall=[0.53268]
Epoch 17 [40.6s + 12.4s]: train==[2.46620 = 0.21633 + 2.24987], recall= [ 0.03077  0.10863  0.17717  0.22136] , precision= [ 0.03660  0.02451  0.02000  0.01691] , auc=[0.82175], sum_recall=[0.53793]
Epoch 18 [40.0s + 11.9s]: train==[2.46617 = 0.21999 + 2.24618], recall= [ 0.02992  0.10629  0.18027  0.22337] , precision= [ 0.03574  0.02417  0.02043  0.01702] , auc=[0.82244], sum_recall=[0.53984]
Epoch 19 [40.4s + 12.8s]: train==[2.45391 = 0.21117 + 2.24274], recall= [ 0.02992  0.10629  0.18367  0.22275] , precision= [ 0.03574  0.02417  0.02077  0.01696] , auc=[0.82273], sum_recall=[0.54263]
Epoch 20 [41.2s + 12.2s]: train==[2.44239 = 0.20268 + 2.23971], recall= [ 0.02950  0.11097  0.18495  0.22190] , precision= [ 0.03489  0.02519  0.02085  0.01685] , auc=[0.82295], sum_recall=[0.54731]
Epoch 21 [39.7s + 11.4s]: train==[2.43171 = 0.19472 + 2.23699], recall= [ 0.02950  0.11054  0.18395  0.22346] , precision= [ 0.03489  0.02519  0.02077  0.01696] , auc=[0.82287], sum_recall=[0.54745]
Epoch 22 [40.6s + 12.8s]: train==[2.42473 = 0.18994 + 2.23479], recall= [ 0.02865  0.10799  0.18459  0.22261] , precision= [ 0.03404  0.02451  0.02094  0.01691] , auc=[0.82277], sum_recall=[0.54383]
Epoch 23 [40.1s + 13.8s]: train==[2.41986 = 0.18693 + 2.23294], recall= [ 0.02907  0.10714  0.18459  0.22417] , precision= [ 0.03489  0.02434  0.02102  0.01696] , auc=[0.82272], sum_recall=[0.54497]
Epoch 24 [39.5s + 11.9s]: train==[2.42160 = 0.19025 + 2.23135], recall= [ 0.03163  0.10799  0.18629  0.22388] , precision= [ 0.03745  0.02451  0.02119  0.01702] , auc=[0.82286], sum_recall=[0.54979]
Epoch 25 [39.7s + 12.0s]: train==[2.40816 = 0.17834 + 2.22982], recall= [ 0.03120  0.11054  0.18459  0.22303] , precision= [ 0.03660  0.02485  0.02102  0.01696] , auc=[0.82314], sum_recall=[0.54936]
Epoch 26 [40.6s + 12.2s]: train==[2.40126 = 0.17289 + 2.22837], recall= [ 0.03120  0.10969  0.18395  0.22048] , precision= [ 0.03660  0.02468  0.02102  0.01679] , auc=[0.82358], sum_recall=[0.54532]
Epoch 27 [40.2s + 11.3s]: train==[2.39793 = 0.17090 + 2.22704], recall= [ 0.03205  0.10884  0.18821  0.22133] , precision= [ 0.03745  0.02468  0.02145  0.01685] , auc=[0.82378], sum_recall=[0.55043]
Epoch 28 [40.6s + 11.8s]: train==[2.39063 = 0.16454 + 2.22610], recall= [ 0.03290  0.10756  0.18821  0.21984] , precision= [ 0.03830  0.02434  0.02145  0.01679] , auc=[0.82392], sum_recall=[0.54851]
Epoch 29 [40.2s + 12.1s]: train==[2.39111 = 0.16558 + 2.22553], recall= [ 0.03205  0.10926  0.18693  0.22069] , precision= [ 0.03745  0.02468  0.02136  0.01685] , auc=[0.82398], sum_recall=[0.54894]
Epoch 30 [39.0s + 12.1s]: train==[2.38457 = 0.15940 + 2.22517], recall= [ 0.03163  0.11012  0.18566  0.22166] , precision= [ 0.03660  0.02485  0.02119  0.01702] , auc=[0.82376], sum_recall=[0.54906]
Epoch 31 [40.6s + 11.5s]: train==[2.38001 = 0.15502 + 2.22499], recall= [ 0.03163  0.11012  0.18438  0.22209] , precision= [ 0.03660  0.02485  0.02102  0.01702] , auc=[0.82352], sum_recall=[0.54821]
Epoch 32 [38.8s + 11.5s]: train==[2.37905 = 0.15422 + 2.22483], recall= [ 0.03248  0.11012  0.18395  0.22209] , precision= [ 0.03745  0.02485  0.02094  0.01702] , auc=[0.82373], sum_recall=[0.54863]
Epoch 33 [38.7s + 12.7s]: train==[2.37697 = 0.15235 + 2.22463], recall= [ 0.03418  0.11054  0.18410  0.21996] , precision= [ 0.03915  0.02502  0.02102  0.01691] , auc=[0.82440], sum_recall=[0.54878]
Epoch 34 [39.2s + 11.6s]: train==[2.36624 = 0.14177 + 2.22447], recall= [ 0.03645  0.11054  0.18367  0.22188] , precision= [ 0.04085  0.02485  0.02102  0.01708] , auc=[0.82485], sum_recall=[0.55253]
Epoch 35 [38.7s + 11.5s]: train==[2.37343 = 0.14913 + 2.22429], recall= [ 0.03475  0.11097  0.18324  0.22145] , precision= [ 0.03915  0.02485  0.02102  0.01708] , auc=[0.82487], sum_recall=[0.55041]
Epoch 36 [40.0s + 11.6s]: train==[2.36861 = 0.14448 + 2.22413], recall= [ 0.03645  0.10935  0.18358  0.22145] , precision= [ 0.04085  0.02468  0.02085  0.01708] , auc=[0.82409], sum_recall=[0.55083]
Epoch 37 [40.0s + 12.1s]: train==[2.35825 = 0.13449 + 2.22377], recall= [ 0.03645  0.11032  0.18259  0.22093] , precision= [ 0.04085  0.02502  0.02077  0.01702] , auc=[0.82335], sum_recall=[0.55030]
Epoch 38 [38.7s + 11.4s]: train==[2.35931 = 0.13619 + 2.22312], recall= [ 0.03645  0.11117  0.18253  0.22179] , precision= [ 0.04085  0.02519  0.02077  0.01708] , auc=[0.82287], sum_recall=[0.55194]
Epoch 39 [39.7s + 12.2s]: train==[2.35502 = 0.13277 + 2.22225], recall= [ 0.03772  0.10990  0.18415  0.22357] , precision= [ 0.04170  0.02485  0.02085  0.01725] , auc=[0.82310], sum_recall=[0.55535]
Epoch 40 [39.3s + 11.0s]: train==[2.35333 = 0.13190 + 2.22143], recall= [ 0.03858  0.10905  0.18509  0.22336] , precision= [ 0.04255  0.02468  0.02119  0.01719] , auc=[0.82353], sum_recall=[0.55607]
Epoch 41 [38.9s + 11.3s]: train==[2.34783 = 0.12712 + 2.22071], recall= [ 0.03858  0.10905  0.18670  0.22379] , precision= [ 0.04255  0.02468  0.02145  0.01725] , auc=[0.82362], sum_recall=[0.55811]
Epoch 42 [38.8s + 12.7s]: train==[2.35196 = 0.13185 + 2.22011], recall= [ 0.03772  0.11032  0.18796  0.22569] , precision= [ 0.04170  0.02502  0.02153  0.01725] , auc=[0.82346], sum_recall=[0.56169]
Epoch 43 [38.7s + 11.7s]: train==[2.35193 = 0.13243 + 2.21949], recall= [ 0.03602  0.10947  0.18753  0.22526] , precision= [ 0.04000  0.02468  0.02153  0.01719] , auc=[0.82350], sum_recall=[0.55828]
Epoch 44 [39.1s + 11.9s]: train==[2.34480 = 0.12593 + 2.21887], recall= [ 0.03517  0.10649  0.18498  0.22441] , precision= [ 0.03915  0.02400  0.02128  0.01713] , auc=[0.82305], sum_recall=[0.55105]
Epoch 45 [38.8s + 12.0s]: train==[2.34128 = 0.12326 + 2.21802], recall= [ 0.03517  0.10692  0.18604  0.22498] , precision= [ 0.03915  0.02417  0.02136  0.01713] , auc=[0.82303], sum_recall=[0.55311]
End of trainning! Best recall= [ 0.03475  0.11097  0.18324  0.22145] , precision= [ 0.03915  0.02485  0.02102  0.01708] , auc=[0.82487]
