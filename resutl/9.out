Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross2', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-25 00:05:45
loading data...
[n_users, n_items]=[3209, 12331]
[n_train, n_test]=[2636, 1318]
[n_edges]=[260034]
Using GPU 1,  memory_free: 17642
tensor([-0.0244, -0.0408, -0.0018,  0.0043,  0.0003], device='cuda:1')
Loading Model..Number of Model Parameters:  3348802
Epoch 0 [141.6s + 8.2s]: train==[4.99275 = 2.68173 + 2.31102], recall= [ 0.00553  0.01234  0.02128  0.02298] , precision= [ 0.00596  0.00255  0.00221  0.00165] , auc=[0.55287], sum_recall=[0.06213]
Epoch 1 [143.1s + 9.2s]: train==[3.32683 = 1.01667 + 2.31016], recall= [ 0.02298  0.06977  0.10466  0.12452] , precision= [ 0.02468  0.01532  0.01123  0.00896] , auc=[0.65856], sum_recall=[0.32193]
Epoch 2 [139.2s + 8.2s]: train==[2.91454 = 0.60575 + 2.30880], recall= [ 0.02468  0.08005  0.11175  0.13502] , precision= [ 0.02638  0.01736  0.01209  0.00976] , auc=[0.69489], sum_recall=[0.35150]
Epoch 3 [139.9s + 9.8s]: train==[2.76264 = 0.45603 + 2.30661], recall= [ 0.03234  0.08187  0.11634  0.13478] , precision= [ 0.03319  0.01821  0.01277  0.00987] , auc=[0.71539], sum_recall=[0.36534]
Epoch 4 [138.2s + 10.0s]: train==[2.69150 = 0.38792 + 2.30359], recall= [ 0.03021  0.08570  0.11932  0.13648] , precision= [ 0.03064  0.01889  0.01302  0.01004] , auc=[0.73039], sum_recall=[0.37172]
Epoch 5 [28.7s + 10.6s]: train==[2.64645 = 0.34665 + 2.29981], recall= [ 0.02766  0.08528  0.11983  0.13839] , precision= [ 0.02809  0.01872  0.01319  0.01033] , auc=[0.74193], sum_recall=[0.37116]
Epoch 6 [133.8s + 10.3s]: train==[2.61825 = 0.32279 + 2.29546], recall= [ 0.03459  0.08281  0.12364  0.13683] , precision= [ 0.03574  0.01838  0.01379  0.01021] , auc=[0.74990], sum_recall=[0.37787]
Epoch 7 [134.9s + 10.0s]: train==[2.59411 = 0.30325 + 2.29087], recall= [ 0.03544  0.08366  0.12407  0.14478] , precision= [ 0.03660  0.01855  0.01379  0.01078] , auc=[0.75501], sum_recall=[0.38795]
Epoch 8 [136.7s + 10.2s]: train==[2.57457 = 0.28819 + 2.28639], recall= [ 0.03459  0.08253  0.12818  0.14563] , precision= [ 0.03574  0.01821  0.01438  0.01078] , auc=[0.75867], sum_recall=[0.39092]
Epoch 9 [133.8s + 9.8s]: train==[2.55094 = 0.26877 + 2.28217], recall= [ 0.03629  0.08465  0.12733  0.14832] , precision= [ 0.03745  0.01872  0.01430  0.01101] , auc=[0.76162], sum_recall=[0.39660]
Epoch 10 [155.1s + 10.7s]: train==[2.53989 = 0.26169 + 2.27820], recall= [ 0.03884  0.08520  0.12861  0.14853] , precision= [ 0.04000  0.01906  0.01438  0.01106] , auc=[0.76417], sum_recall=[0.40119]
Epoch 11 [164.0s + 10.5s]: train==[2.52267 = 0.24839 + 2.27428], recall= [ 0.03799  0.08648  0.12960  0.15024] , precision= [ 0.03915  0.01940  0.01447  0.01118] , auc=[0.76646], sum_recall=[0.40431]
Epoch 12 [81.1s + 10.0s]: train==[2.50764 = 0.23724 + 2.27040], recall= [ 0.03842  0.08634  0.13045  0.15052] , precision= [ 0.04000  0.01940  0.01455  0.01123] , auc=[0.76841], sum_recall=[0.40573]
Epoch 13 [131.8s + 10.0s]: train==[2.49442 = 0.22783 + 2.26659], recall= [ 0.03863  0.08463  0.12726  0.15194] , precision= [ 0.04085  0.01906  0.01430  0.01129] , auc=[0.77014], sum_recall=[0.40246]
Epoch 14 [134.7s + 10.4s]: train==[2.48092 = 0.21800 + 2.26292], recall= [ 0.03616  0.08974  0.12896  0.15393] , precision= [ 0.03915  0.02009  0.01438  0.01146] , auc=[0.77164], sum_recall=[0.40879]
Epoch 15 [131.6s + 10.6s]: train==[2.46852 = 0.20930 + 2.25922], recall= [ 0.03616  0.08889  0.12939  0.15648] , precision= [ 0.03915  0.01991  0.01447  0.01163] , auc=[0.77302], sum_recall=[0.41092]
Epoch 16 [135.8s + 11.2s]: train==[2.45736 = 0.20203 + 2.25533], recall= [ 0.03616  0.08889  0.13024  0.15478] , precision= [ 0.03915  0.01991  0.01455  0.01157] , auc=[0.77427], sum_recall=[0.41007]
Epoch 17 [132.6s + 9.7s]: train==[2.44688 = 0.19566 + 2.25122], recall= [ 0.03361  0.08719  0.12981  0.15393] , precision= [ 0.03660  0.01940  0.01447  0.01152] , auc=[0.77544], sum_recall=[0.40453]
Epoch 18 [145.4s + 10.1s]: train==[2.43872 = 0.19181 + 2.24690], recall= [ 0.03404  0.08889  0.13045  0.15648] , precision= [ 0.03745  0.01974  0.01455  0.01169] , auc=[0.77658], sum_recall=[0.40985]
Epoch 19 [138.5s + 11.0s]: train==[2.42742 = 0.18471 + 2.24271], recall= [ 0.03489  0.08917  0.13130  0.15563] , precision= [ 0.03830  0.01991  0.01464  0.01163] , auc=[0.77777], sum_recall=[0.41099]
Epoch 20 [133.3s + 10.8s]: train==[2.41839 = 0.17986 + 2.23854], recall= [ 0.03616  0.09073  0.13258  0.15690] , precision= [ 0.04000  0.02026  0.01481  0.01174] , auc=[0.77879], sum_recall=[0.41638]
Epoch 21 [134.2s + 10.4s]: train==[2.41247 = 0.17821 + 2.23427], recall= [ 0.03616  0.08988  0.13258  0.15747] , precision= [ 0.04000  0.02009  0.01481  0.01174] , auc=[0.77976], sum_recall=[0.41610]
Epoch 22 [163.6s + 9.9s]: train==[2.40852 = 0.17855 + 2.22997], recall= [ 0.03361  0.09286  0.13400  0.15534] , precision= [ 0.03745  0.02077  0.01489  0.01157] , auc=[0.78057], sum_recall=[0.41581]
Epoch 23 [138.1s + 10.3s]: train==[2.39657 = 0.17111 + 2.22546], recall= [ 0.03361  0.09229  0.13655  0.15577] , precision= [ 0.03745  0.02043  0.01515  0.01163] , auc=[0.78132], sum_recall=[0.41822]
Epoch 24 [140.7s + 10.8s]: train==[2.38648 = 0.16600 + 2.22048], recall= [ 0.03319  0.09229  0.13740  0.15556] , precision= [ 0.03660  0.02043  0.01523  0.01163] , auc=[0.78206], sum_recall=[0.41844]
Epoch 25 [139.4s + 10.9s]: train==[2.37532 = 0.16053 + 2.21478], recall= [ 0.03404  0.09428  0.13485  0.15797] , precision= [ 0.03745  0.02094  0.01498  0.01186] , auc=[0.78283], sum_recall=[0.42113]
Epoch 26 [102.5s + 10.6s]: train==[2.37562 = 0.16706 + 2.20856], recall= [ 0.03489  0.09258  0.13825  0.15712] , precision= [ 0.03830  0.02060  0.01532  0.01180] , auc=[0.78364], sum_recall=[0.42283]
Epoch 27 [135.3s + 10.2s]: train==[2.36595 = 0.16425 + 2.20170], recall= [ 0.03744  0.09045  0.13683  0.15741] , precision= [ 0.04170  0.02009  0.01515  0.01191] , auc=[0.78421], sum_recall=[0.42214]
Epoch 28 [141.0s + 10.4s]: train==[2.34670 = 0.15261 + 2.19409], recall= [ 0.03744  0.08875  0.13513  0.15798] , precision= [ 0.04170  0.01974  0.01489  0.01191] , auc=[0.78460], sum_recall=[0.41930]
Epoch 29 [140.9s + 10.4s]: train==[2.33594 = 0.15026 + 2.18568], recall= [ 0.03744  0.09088  0.13428  0.15741] , precision= [ 0.04170  0.02009  0.01481  0.01180] , auc=[0.78502], sum_recall=[0.42001]
Epoch 30 [137.9s + 10.6s]: train==[2.32884 = 0.15159 + 2.17725], recall= [ 0.03744  0.09215  0.13598  0.15997] , precision= [ 0.04170  0.02043  0.01498  0.01191] , auc=[0.78549], sum_recall=[0.42554]
Epoch 31 [152.0s + 10.1s]: train==[2.31119 = 0.14266 + 2.16853], recall= [ 0.03744  0.09215  0.13598  0.16153] , precision= [ 0.04085  0.02043  0.01498  0.01209] , auc=[0.78602], sum_recall=[0.42710]
Epoch 32 [138.1s + 9.9s]: train==[2.30124 = 0.14106 + 2.16018], recall= [ 0.03574  0.09215  0.13619  0.16153] , precision= [ 0.03915  0.02043  0.01506  0.01209] , auc=[0.78655], sum_recall=[0.42561]
Epoch 33 [100.6s + 11.0s]: train==[2.29213 = 0.13967 + 2.15246], recall= [ 0.03744  0.09300  0.13648  0.15983] , precision= [ 0.04085  0.02060  0.01515  0.01197] , auc=[0.78684], sum_recall=[0.42675]
Epoch 34 [132.1s + 10.4s]: train==[2.28139 = 0.13628 + 2.14511], recall= [ 0.03744  0.09300  0.13648  0.16110] , precision= [ 0.04085  0.02060  0.01515  0.01209] , auc=[0.78683], sum_recall=[0.42802]
Epoch 35 [136.5s + 10.0s]: train==[2.27101 = 0.13282 + 2.13820], recall= [ 0.03616  0.09272  0.13563  0.16025] , precision= [ 0.03915  0.02060  0.01506  0.01203] , auc=[0.78654], sum_recall=[0.42476]
Epoch 36 [138.4s + 9.9s]: train==[2.26374 = 0.13122 + 2.13253], recall= [ 0.03574  0.09314  0.13435  0.16059] , precision= [ 0.03830  0.02060  0.01489  0.01197] , auc=[0.78602], sum_recall=[0.42383]
Epoch 37 [137.1s + 10.1s]: train==[2.25774 = 0.13038 + 2.12736], recall= [ 0.03404  0.09414  0.13571  0.15770] , precision= [ 0.03660  0.02060  0.01515  0.01186] , auc=[0.78517], sum_recall=[0.42158]
Epoch 38 [134.9s + 10.1s]: train==[2.26096 = 0.13748 + 2.12348], recall= [ 0.03395  0.09244  0.13316  0.15600] , precision= [ 0.03574  0.02026  0.01489  0.01174] , auc=[0.78411], sum_recall=[0.41554]
Epoch 39 [138.1s + 11.2s]: train==[2.25283 = 0.13279 + 2.12004], recall= [ 0.03480  0.09158  0.13422  0.15855] , precision= [ 0.03660  0.02009  0.01506  0.01191] , auc=[0.78345], sum_recall=[0.41916]
Epoch 40 [133.8s + 10.1s]: train==[2.24104 = 0.12330 + 2.11774], recall= [ 0.03736  0.08832  0.13550  0.15727] , precision= [ 0.03915  0.01957  0.01523  0.01180] , auc=[0.78289], sum_recall=[0.41845]
Epoch 41 [141.3s + 10.3s]: train==[2.24911 = 0.13357 + 2.11554], recall= [ 0.03565  0.08662  0.13550  0.15621] , precision= [ 0.03745  0.01923  0.01523  0.01169] , auc=[0.78237], sum_recall=[0.41398]
Epoch 42 [140.7s + 10.2s]: train==[2.24037 = 0.12569 + 2.11468], recall= [ 0.03395  0.08875  0.13244  0.15706] , precision= [ 0.03574  0.01974  0.01489  0.01174] , auc=[0.78200], sum_recall=[0.41219]
Epoch 43 [143.9s + 10.5s]: train==[2.23819 = 0.12481 + 2.11338], recall= [ 0.03319  0.08889  0.13329  0.15493] , precision= [ 0.03574  0.01974  0.01498  0.01157] , auc=[0.78171], sum_recall=[0.41029]
End of trainning! Best recall= [ 0.03744  0.09300  0.13648  0.15983] , precision= [ 0.04085  0.02060  0.01515  0.01197] , auc=[0.78684]
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross2', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-25 01:51:41
loading data...
[n_users, n_items]=[3209, 12331]
[n_train, n_test]=[2636, 1318]
[n_edges]=[260034]
Using GPU 1,  memory_free: 17642
tensor([-0.0032,  0.0390,  0.0292, -0.0043,  0.0059], device='cuda:1')
Loading Model..Number of Model Parameters:  3348802
Epoch 0 [140.0s + 9.8s]: train==[4.99090 = 2.67338 + 2.31752], recall= [ 0.00596  0.00979  0.01617  0.01872] , precision= [ 0.00596  0.00204  0.00170  0.00130] , auc=[0.54594], sum_recall=[0.05064]
Epoch 1 [139.0s + 10.4s]: train==[3.34969 = 1.03291 + 2.31678], recall= [ 0.02182  0.07253  0.09882  0.12315] , precision= [ 0.02298  0.01566  0.01072  0.00896] , auc=[0.65906], sum_recall=[0.31633]
Epoch 2 [137.8s + 10.0s]: train==[2.92814 = 0.61251 + 2.31564], recall= [ 0.02523  0.08189  0.11658  0.13443] , precision= [ 0.02638  0.01770  0.01251  0.00970] , auc=[0.69271], sum_recall=[0.35813]
Epoch 3 [100.6s + 12.0s]: train==[2.78031 = 0.46657 + 2.31375], recall= [ 0.02991  0.08317  0.11913  0.14271] , precision= [ 0.03064  0.01787  0.01285  0.01044] , auc=[0.71324], sum_recall=[0.37491]
Epoch 4 [139.3s + 11.6s]: train==[2.70581 = 0.39477 + 2.31104], recall= [ 0.02979  0.09189  0.12122  0.14299] , precision= [ 0.03064  0.01974  0.01336  0.01055] , auc=[0.72737], sum_recall=[0.38589]
Epoch 5 [137.2s + 12.2s]: train==[2.65983 = 0.35233 + 2.30750], recall= [ 0.03170  0.09189  0.12705  0.14670] , precision= [ 0.03319  0.01991  0.01396  0.01078] , auc=[0.73824], sum_recall=[0.39735]
Epoch 6 [136.7s + 12.8s]: train==[2.62727 = 0.32409 + 2.30318], recall= [ 0.03426  0.09275  0.12663  0.15074] , precision= [ 0.03574  0.01991  0.01396  0.01101] , auc=[0.74559], sum_recall=[0.40437]
Epoch 7 [137.7s + 11.4s]: train==[2.60690 = 0.30858 + 2.29832], recall= [ 0.03340  0.09062  0.12663  0.15074] , precision= [ 0.03489  0.01957  0.01404  0.01101] , auc=[0.75061], sum_recall=[0.40139]
Epoch 8 [136.8s + 11.2s]: train==[2.58530 = 0.29202 + 2.29328], recall= [ 0.03255  0.08998  0.12663  0.15017] , precision= [ 0.03404  0.01940  0.01404  0.01101] , auc=[0.75437], sum_recall=[0.39933]
Epoch 9 [137.2s + 11.5s]: train==[2.55218 = 0.26371 + 2.28847], recall= [ 0.03426  0.08870  0.12875  0.15060] , precision= [ 0.03574  0.01923  0.01421  0.01106] , auc=[0.75738], sum_recall=[0.40231]
Epoch 10 [114.6s + 12.1s]: train==[2.54382 = 0.25974 + 2.28407], recall= [ 0.03596  0.08913  0.12939  0.15358] , precision= [ 0.03745  0.01923  0.01421  0.01129] , auc=[0.75984], sum_recall=[0.40805]
Epoch 11 [140.9s + 12.1s]: train==[2.53049 = 0.25055 + 2.27994], recall= [ 0.03723  0.09095  0.12897  0.15358] , precision= [ 0.03915  0.01974  0.01421  0.01129] , auc=[0.76181], sum_recall=[0.41073]
Epoch 12 [139.7s + 11.3s]: train==[2.51477 = 0.23882 + 2.27594], recall= [ 0.03723  0.09168  0.12769  0.15592] , precision= [ 0.03915  0.01974  0.01404  0.01140] , auc=[0.76322], sum_recall=[0.41252]
Epoch 13 [139.9s + 11.1s]: train==[2.50021 = 0.22821 + 2.27200], recall= [ 0.03809  0.09253  0.12735  0.15856] , precision= [ 0.04000  0.01974  0.01404  0.01163] , auc=[0.76446], sum_recall=[0.41652]
Epoch 14 [143.0s + 11.9s]: train==[2.48550 = 0.21723 + 2.26827], recall= [ 0.03894  0.09083  0.12678  0.15813] , precision= [ 0.04085  0.01940  0.01404  0.01163] , auc=[0.76550], sum_recall=[0.41468]
Epoch 15 [140.0s + 12.6s]: train==[2.47562 = 0.21089 + 2.26473], recall= [ 0.03766  0.08998  0.12678  0.15655] , precision= [ 0.04000  0.01923  0.01404  0.01157] , auc=[0.76636], sum_recall=[0.41097]
Epoch 16 [159.0s + 11.8s]: train==[2.46376 = 0.20250 + 2.26126], recall= [ 0.03766  0.09296  0.12690  0.15570] , precision= [ 0.04000  0.01974  0.01413  0.01152] , auc=[0.76728], sum_recall=[0.41322]
Epoch 17 [79.9s + 12.3s]: train==[2.45467 = 0.19706 + 2.25761], recall= [ 0.03766  0.09211  0.12775  0.15627] , precision= [ 0.04000  0.01957  0.01421  0.01163] , auc=[0.76814], sum_recall=[0.41379]
Epoch 18 [143.2s + 11.6s]: train==[2.44570 = 0.19212 + 2.25357], recall= [ 0.03681  0.09253  0.12790  0.15584] , precision= [ 0.03915  0.01974  0.01421  0.01163] , auc=[0.76885], sum_recall=[0.41308]
Epoch 19 [137.4s + 12.1s]: train==[2.43623 = 0.18671 + 2.24953], recall= [ 0.03596  0.09253  0.12662  0.16010] , precision= [ 0.03830  0.01974  0.01413  0.01191] , auc=[0.76952], sum_recall=[0.41521]
Epoch 20 [155.1s + 12.4s]: train==[2.42596 = 0.18045 + 2.24551], recall= [ 0.03447  0.09253  0.12676  0.15924] , precision= [ 0.03660  0.01974  0.01421  0.01186] , auc=[0.77007], sum_recall=[0.41301]
Epoch 21 [136.2s + 11.4s]: train==[2.41721 = 0.17574 + 2.24147], recall= [ 0.03362  0.09296  0.12662  0.15797] , precision= [ 0.03574  0.01991  0.01413  0.01174] , auc=[0.77053], sum_recall=[0.41116]
Epoch 22 [139.6s + 10.9s]: train==[2.41631 = 0.17912 + 2.23719], recall= [ 0.03489  0.09304  0.12619  0.15839] , precision= [ 0.03660  0.02009  0.01413  0.01180] , auc=[0.77089], sum_recall=[0.41252]
Epoch 23 [140.5s + 11.6s]: train==[2.40504 = 0.17244 + 2.23260], recall= [ 0.03319  0.09177  0.12619  0.15456] , precision= [ 0.03489  0.01991  0.01413  0.01152] , auc=[0.77129], sum_recall=[0.40572]
Epoch 24 [87.0s + 12.5s]: train==[2.39417 = 0.16660 + 2.22757], recall= [ 0.03234  0.09262  0.12591  0.15541] , precision= [ 0.03404  0.02009  0.01404  0.01157] , auc=[0.77191], sum_recall=[0.40628]
Epoch 25 [144.5s + 11.9s]: train==[2.38303 = 0.16128 + 2.22175], recall= [ 0.03234  0.09146  0.12549  0.15627] , precision= [ 0.03404  0.01991  0.01396  0.01163] , auc=[0.77281], sum_recall=[0.40555]
Epoch 26 [142.0s + 11.2s]: train==[2.38068 = 0.16588 + 2.21481], recall= [ 0.03234  0.09146  0.12577  0.15627] , precision= [ 0.03404  0.01991  0.01404  0.01163] , auc=[0.77385], sum_recall=[0.40584]
Epoch 27 [140.0s + 11.2s]: train==[2.37126 = 0.16428 + 2.20698], recall= [ 0.03574  0.09231  0.12832  0.15627] , precision= [ 0.03745  0.02009  0.01430  0.01163] , auc=[0.77466], sum_recall=[0.41265]
Epoch 28 [140.1s + 11.6s]: train==[2.35139 = 0.15291 + 2.19848], recall= [ 0.03489  0.09146  0.12804  0.15924] , precision= [ 0.03660  0.01991  0.01430  0.01180] , auc=[0.77528], sum_recall=[0.41364]
Epoch 29 [140.0s + 12.2s]: train==[2.34457 = 0.15542 + 2.18915], recall= [ 0.03319  0.09104  0.12705  0.15924] , precision= [ 0.03489  0.01974  0.01413  0.01180] , auc=[0.77583], sum_recall=[0.41052]
Epoch 30 [141.6s + 12.2s]: train==[2.33355 = 0.15327 + 2.18028], recall= [ 0.03157  0.09004  0.12790  0.15882] , precision= [ 0.03404  0.01974  0.01421  0.01174] , auc=[0.77638], sum_recall=[0.40833]
Epoch 31 [90.3s + 12.0s]: train==[2.31526 = 0.14424 + 2.17102], recall= [ 0.03328  0.09090  0.12960  0.16116] , precision= [ 0.03574  0.01991  0.01438  0.01197] , auc=[0.77699], sum_recall=[0.41493]
Epoch 32 [141.4s + 10.9s]: train==[2.30401 = 0.14156 + 2.16245], recall= [ 0.03328  0.09685  0.12974  0.16222] , precision= [ 0.03574  0.02111  0.01438  0.01209] , auc=[0.77763], sum_recall=[0.42209]
Epoch 33 [138.1s + 11.9s]: train==[2.29564 = 0.14116 + 2.15448], recall= [ 0.03157  0.09600  0.13144  0.15967] , precision= [ 0.03404  0.02094  0.01455  0.01191] , auc=[0.77822], sum_recall=[0.41869]
Epoch 34 [140.3s + 11.9s]: train==[2.28663 = 0.13930 + 2.14733], recall= [ 0.03243  0.09345  0.13229  0.15946] , precision= [ 0.03489  0.02043  0.01464  0.01191] , auc=[0.77862], sum_recall=[0.41763]
Epoch 35 [140.1s + 11.9s]: train==[2.27649 = 0.13612 + 2.14036], recall= [ 0.03328  0.09430  0.13215  0.15903] , precision= [ 0.03574  0.02060  0.01472  0.01191] , auc=[0.77870], sum_recall=[0.41876]
Epoch 36 [139.2s + 11.1s]: train==[2.26624 = 0.13162 + 2.13462], recall= [ 0.03413  0.09260  0.13513  0.16158] , precision= [ 0.03660  0.02026  0.01506  0.01214] , auc=[0.77862], sum_recall=[0.42344]
Epoch 37 [143.2s + 11.4s]: train==[2.25930 = 0.13003 + 2.12927], recall= [ 0.03243  0.09090  0.13449  0.16116] , precision= [ 0.03489  0.01991  0.01506  0.01209] , auc=[0.77833], sum_recall=[0.41897]
Epoch 38 [99.5s + 12.3s]: train==[2.26235 = 0.13736 + 2.12498], recall= [ 0.03157  0.09035  0.13052  0.15946] , precision= [ 0.03404  0.01957  0.01455  0.01197] , auc=[0.77765], sum_recall=[0.41190]
Epoch 39 [140.1s + 11.4s]: train==[2.25432 = 0.13295 + 2.12138], recall= [ 0.03170  0.08780  0.12853  0.16031] , precision= [ 0.03489  0.01906  0.01430  0.01203] , auc=[0.77723], sum_recall=[0.40833]
Epoch 40 [140.0s + 11.4s]: train==[2.24352 = 0.12466 + 2.11886], recall= [ 0.03170  0.08780  0.12853  0.15818] , precision= [ 0.03489  0.01906  0.01438  0.01186] , auc=[0.77683], sum_recall=[0.40621]
Epoch 41 [137.7s + 11.8s]: train==[2.25102 = 0.13449 + 2.11653], recall= [ 0.03042  0.08865  0.12853  0.15733] , precision= [ 0.03319  0.01923  0.01438  0.01180] , auc=[0.77651], sum_recall=[0.40493]
Epoch 42 [139.6s + 11.5s]: train==[2.24166 = 0.12624 + 2.11542], recall= [ 0.03042  0.08865  0.12598  0.15393] , precision= [ 0.03319  0.01923  0.01404  0.01157] , auc=[0.77627], sum_recall=[0.39897]
Epoch 43 [139.8s + 11.8s]: train==[2.24036 = 0.12630 + 2.11406], recall= [ 0.03382  0.08865  0.12343  0.15307] , precision= [ 0.03660  0.01923  0.01379  0.01152] , auc=[0.77618], sum_recall=[0.39897]
Epoch 44 [139.4s + 11.9s]: train==[2.23143 = 0.11883 + 2.11260], recall= [ 0.03467  0.08822  0.12428  0.15307] , precision= [ 0.03745  0.01923  0.01387  0.01152] , auc=[0.77612], sum_recall=[0.40025]
Epoch 45 [104.7s + 12.3s]: train==[2.23413 = 0.12340 + 2.11073], recall= [ 0.03467  0.08822  0.12385  0.15272] , precision= [ 0.03745  0.01923  0.01379  0.01146] , auc=[0.77631], sum_recall=[0.39947]
End of trainning! Best recall= [ 0.03328  0.09430  0.13215  0.15903] , precision= [ 0.03574  0.02060  0.01472  0.01191] , auc=[0.77870]
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross2', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-25 03:43:28
loading data...
[n_users, n_items]=[3209, 12331]
[n_train, n_test]=[2636, 1318]
[n_edges]=[260034]
Using GPU 2,  memory_free: 23906
tensor([0.0124, 0.0405, 0.0011, 0.0002, 0.0203], device='cuda:2')
Loading Model..Number of Model Parameters:  3348802
Epoch 0 [44.2s + 13.9s]: train==[4.95522 = 2.63856 + 2.31666], recall= [ 0.00766  0.01360  0.01785  0.02154] , precision= [ 0.00766  0.00306  0.00196  0.00165] , auc=[0.55708], sum_recall=[0.06065]
Epoch 1 [43.6s + 15.5s]: train==[3.31496 = 0.99906 + 2.31589], recall= [ 0.01934  0.06643  0.09728  0.11948] , precision= [ 0.02213  0.01447  0.01047  0.00868] , auc=[0.66302], sum_recall=[0.30254]
Epoch 2 [46.8s + 14.0s]: train==[2.92060 = 0.60600 + 2.31461], recall= [ 0.02246  0.07310  0.11459  0.14211] , precision= [ 0.02553  0.01583  0.01243  0.01021] , auc=[0.69658], sum_recall=[0.35226]
Epoch 3 [44.6s + 15.4s]: train==[2.77699 = 0.46450 + 2.31249], recall= [ 0.02714  0.08119  0.12459  0.14734] , precision= [ 0.02979  0.01753  0.01345  0.01072] , auc=[0.71693], sum_recall=[0.38025]
Epoch 4 [42.5s + 16.2s]: train==[2.69004 = 0.38061 + 2.30944], recall= [ 0.02757  0.08728  0.12315  0.14620] , precision= [ 0.02979  0.01855  0.01345  0.01067] , auc=[0.73131], sum_recall=[0.38420]
Epoch 5 [47.9s + 15.1s]: train==[2.65088 = 0.34540 + 2.30548], recall= [ 0.02502  0.08572  0.12230  0.14982] , precision= [ 0.02723  0.01838  0.01336  0.01089] , auc=[0.74225], sum_recall=[0.38286]
Epoch 6 [46.4s + 17.5s]: train==[2.61574 = 0.31498 + 2.30076], recall= [ 0.02927  0.08755  0.12230  0.15164] , precision= [ 0.03149  0.01889  0.01336  0.01112] , auc=[0.75002], sum_recall=[0.39076]
Epoch 7 [44.2s + 16.1s]: train==[2.60003 = 0.30440 + 2.29564], recall= [ 0.02970  0.08542  0.12485  0.14994] , precision= [ 0.03149  0.01855  0.01362  0.01101] , auc=[0.75493], sum_recall=[0.38991]
Epoch 8 [45.8s + 18.7s]: train==[2.58252 = 0.29198 + 2.29054], recall= [ 0.03480  0.08457  0.12157  0.14951] , precision= [ 0.03660  0.01838  0.01336  0.01095] , auc=[0.75851], sum_recall=[0.39046]
Epoch 9 [42.6s + 15.6s]: train==[2.55076 = 0.26495 + 2.28581], recall= [ 0.03906  0.08627  0.12143  0.15235] , precision= [ 0.04085  0.01872  0.01345  0.01118] , auc=[0.76127], sum_recall=[0.39911]
Epoch 10 [44.8s + 16.4s]: train==[2.54055 = 0.25905 + 2.28150], recall= [ 0.03863  0.08287  0.12058  0.15150] , precision= [ 0.04085  0.01804  0.01336  0.01112] , auc=[0.76357], sum_recall=[0.39358]
Epoch 11 [43.9s + 16.5s]: train==[2.52550 = 0.24810 + 2.27740], recall= [ 0.03650  0.08244  0.12427  0.15022] , precision= [ 0.03915  0.01804  0.01379  0.01106] , auc=[0.76539], sum_recall=[0.39343]
Epoch 12 [43.6s + 16.1s]: train==[2.51020 = 0.23679 + 2.27341], recall= [ 0.03565  0.08372  0.12427  0.15107] , precision= [ 0.03830  0.01838  0.01379  0.01112] , auc=[0.76697], sum_recall=[0.39471]
Epoch 13 [44.0s + 15.2s]: train==[2.49660 = 0.22708 + 2.26952], recall= [ 0.03608  0.08457  0.12341  0.15022] , precision= [ 0.03915  0.01855  0.01370  0.01106] , auc=[0.76830], sum_recall=[0.39429]
Epoch 14 [44.3s + 16.5s]: train==[2.48030 = 0.21441 + 2.26588], recall= [ 0.03438  0.08615  0.12299  0.14937] , precision= [ 0.03745  0.01872  0.01370  0.01101] , auc=[0.76958], sum_recall=[0.39289]
Epoch 15 [44.4s + 16.7s]: train==[2.47347 = 0.21103 + 2.26243], recall= [ 0.03353  0.08615  0.12299  0.15022] , precision= [ 0.03660  0.01872  0.01370  0.01106] , auc=[0.77065], sum_recall=[0.39289]
Epoch 16 [43.8s + 15.6s]: train==[2.45966 = 0.20069 + 2.25897], recall= [ 0.03267  0.08712  0.12341  0.15235] , precision= [ 0.03574  0.01906  0.01379  0.01123] , auc=[0.77163], sum_recall=[0.39556]
Epoch 17 [42.9s + 14.7s]: train==[2.44902 = 0.19379 + 2.25522], recall= [ 0.03182  0.08840  0.12469  0.15150] , precision= [ 0.03489  0.01940  0.01396  0.01118] , auc=[0.77273], sum_recall=[0.39641]
Epoch 18 [46.0s + 14.6s]: train==[2.44198 = 0.19089 + 2.25109], recall= [ 0.03331  0.08712  0.12483  0.15193] , precision= [ 0.03574  0.01906  0.01387  0.01123] , auc=[0.77382], sum_recall=[0.39719]
Epoch 19 [46.7s + 15.0s]: train==[2.43125 = 0.18422 + 2.24703], recall= [ 0.03587  0.08712  0.12455  0.15065] , precision= [ 0.03830  0.01906  0.01379  0.01112] , auc=[0.77488], sum_recall=[0.39819]
Epoch 20 [43.5s + 16.2s]: train==[2.42253 = 0.17955 + 2.24297], recall= [ 0.03516  0.08712  0.12625  0.15031] , precision= [ 0.03830  0.01906  0.01396  0.01118] , auc=[0.77580], sum_recall=[0.39884]
Epoch 21 [47.2s + 16.3s]: train==[2.41523 = 0.17641 + 2.23882], recall= [ 0.03558  0.08670  0.12463  0.15456] , precision= [ 0.03915  0.01889  0.01387  0.01146] , auc=[0.77669], sum_recall=[0.40148]
Epoch 22 [43.3s + 16.9s]: train==[2.40885 = 0.17446 + 2.23438], recall= [ 0.03431  0.08670  0.12648  0.15797] , precision= [ 0.03745  0.01889  0.01404  0.01169] , auc=[0.77752], sum_recall=[0.40545]
Epoch 23 [45.2s + 17.1s]: train==[2.40202 = 0.17256 + 2.22947], recall= [ 0.03416  0.08755  0.12563  0.15683] , precision= [ 0.03660  0.01906  0.01396  0.01157] , auc=[0.77816], sum_recall=[0.40417]
Epoch 24 [44.4s + 16.2s]: train==[2.38695 = 0.16293 + 2.22402], recall= [ 0.03416  0.09010  0.12775  0.15853] , precision= [ 0.03660  0.01957  0.01421  0.01169] , auc=[0.77884], sum_recall=[0.41056]
Epoch 25 [44.6s + 16.5s]: train==[2.37722 = 0.15990 + 2.21733], recall= [ 0.03544  0.08925  0.12988  0.15790] , precision= [ 0.03830  0.01940  0.01438  0.01169] , auc=[0.77967], sum_recall=[0.41247]
Epoch 26 [51.7s + 17.2s]: train==[2.37292 = 0.16341 + 2.20951], recall= [ 0.03544  0.09104  0.13073  0.16045] , precision= [ 0.03830  0.01991  0.01447  0.01191] , auc=[0.78057], sum_recall=[0.41766]
Epoch 27 [43.7s + 15.9s]: train==[2.36210 = 0.16140 + 2.20070], recall= [ 0.03617  0.09090  0.13244  0.16002] , precision= [ 0.03830  0.01974  0.01464  0.01186] , auc=[0.78116], sum_recall=[0.41953]
Epoch 28 [41.5s + 16.1s]: train==[2.34240 = 0.15104 + 2.19136], recall= [ 0.03532  0.08932  0.13116  0.16300] , precision= [ 0.03745  0.01957  0.01455  0.01203] , auc=[0.78155], sum_recall=[0.41880]
Epoch 29 [44.5s + 14.7s]: train==[2.33504 = 0.15351 + 2.18154], recall= [ 0.03617  0.08932  0.13456  0.16556] , precision= [ 0.03830  0.01957  0.01489  0.01220] , auc=[0.78198], sum_recall=[0.42560]
Epoch 30 [42.6s + 12.0s]: train==[2.32307 = 0.15063 + 2.17244], recall= [ 0.03447  0.09272  0.13272  0.16598] , precision= [ 0.03660  0.02026  0.01472  0.01220] , auc=[0.78255], sum_recall=[0.42589]
Epoch 31 [43.2s + 11.1s]: train==[2.30614 = 0.14270 + 2.16344], recall= [ 0.03532  0.09272  0.13527  0.16683] , precision= [ 0.03745  0.02026  0.01498  0.01226] , auc=[0.78308], sum_recall=[0.43014]
Epoch 32 [41.2s + 11.3s]: train==[2.29628 = 0.14082 + 2.15546], recall= [ 0.03319  0.09385  0.13612  0.16669] , precision= [ 0.03489  0.02060  0.01506  0.01231] , auc=[0.78354], sum_recall=[0.42986]
Epoch 33 [42.0s + 12.0s]: train==[2.28914 = 0.14095 + 2.14819], recall= [ 0.03149  0.09471  0.13740  0.16584] , precision= [ 0.03319  0.02077  0.01523  0.01226] , auc=[0.78387], sum_recall=[0.42943]
Epoch 34 [41.8s + 11.9s]: train==[2.28029 = 0.13867 + 2.14161], recall= [ 0.03064  0.09300  0.13570  0.16456] , precision= [ 0.03234  0.02043  0.01506  0.01220] , auc=[0.78406], sum_recall=[0.42390]
Epoch 35 [42.7s + 11.9s]: train==[2.26891 = 0.13367 + 2.13524], recall= [ 0.03149  0.09556  0.13598  0.16393] , precision= [ 0.03319  0.02111  0.01506  0.01220] , auc=[0.78406], sum_recall=[0.42695]
Epoch 36 [39.9s + 11.4s]: train==[2.26344 = 0.13305 + 2.13039], recall= [ 0.03128  0.09598  0.13556  0.16265] , precision= [ 0.03319  0.02111  0.01506  0.01209] , auc=[0.78402], sum_recall=[0.42546]
Epoch 37 [41.2s + 11.6s]: train==[2.25719 = 0.13123 + 2.12596], recall= [ 0.03043  0.09385  0.13471  0.15924] , precision= [ 0.03234  0.02060  0.01498  0.01180] , auc=[0.78367], sum_recall=[0.41823]
Epoch 38 [41.2s + 11.7s]: train==[2.26243 = 0.13984 + 2.12260], recall= [ 0.03213  0.09471  0.13385  0.15754] , precision= [ 0.03404  0.02077  0.01489  0.01169] , auc=[0.78318], sum_recall=[0.41823]
Epoch 39 [42.4s + 12.2s]: train==[2.25385 = 0.13402 + 2.11983], recall= [ 0.03383  0.09343  0.13385  0.15669] , precision= [ 0.03574  0.02060  0.01489  0.01163] , auc=[0.78298], sum_recall=[0.41780]
Epoch 40 [41.7s + 12.0s]: train==[2.24246 = 0.12474 + 2.11772], recall= [ 0.03383  0.09343  0.13236  0.15797] , precision= [ 0.03574  0.02060  0.01472  0.01174] , auc=[0.78288], sum_recall=[0.41759]
Epoch 41 [43.1s + 11.0s]: train==[2.25022 = 0.13460 + 2.11562], recall= [ 0.03468  0.09556  0.13279  0.15712] , precision= [ 0.03660  0.02111  0.01472  0.01169] , auc=[0.78271], sum_recall=[0.42014]
Epoch 42 [41.4s + 11.6s]: train==[2.24328 = 0.12854 + 2.11474], recall= [ 0.03468  0.09385  0.13109  0.15541] , precision= [ 0.03660  0.02077  0.01455  0.01157] , auc=[0.78256], sum_recall=[0.41504]
Epoch 43 [42.6s + 11.6s]: train==[2.23779 = 0.12446 + 2.11333], recall= [ 0.03438  0.09471  0.12839  0.15669] , precision= [ 0.03660  0.02094  0.01421  0.01163] , auc=[0.78237], sum_recall=[0.41417]
Epoch 44 [41.3s + 12.1s]: train==[2.23056 = 0.11877 + 2.11179], recall= [ 0.03267  0.09164  0.12669  0.15293] , precision= [ 0.03489  0.02009  0.01404  0.01123] , auc=[0.78225], sum_recall=[0.40394]
Epoch 45 [42.4s + 11.5s]: train==[2.23299 = 0.12303 + 2.10997], recall= [ 0.03267  0.09300  0.12534  0.15378] , precision= [ 0.03489  0.02060  0.01379  0.01129] , auc=[0.78217], sum_recall=[0.40480]
End of trainning! Best recall= [ 0.03149  0.09556  0.13598  0.16393] , precision= [ 0.03319  0.02111  0.01506  0.01220] , auc=[0.78406]
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross2', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-25 04:28:18
loading data...
[n_users, n_items]=[3209, 12331]
[n_train, n_test]=[2636, 1318]
[n_edges]=[260034]
Using GPU 1,  memory_free: 17642
tensor([ 0.0263,  0.0315, -0.0307, -0.0002, -0.0160], device='cuda:1')
Loading Model..Number of Model Parameters:  3348802
Epoch 0 [29.5s + 10.3s]: train==[4.96610 = 2.64874 + 2.31735], recall= [ 0.00851  0.01447  0.01957  0.02326] , precision= [ 0.00851  0.00289  0.00196  0.00159] , auc=[0.55834], sum_recall=[0.06582]
Epoch 1 [153.3s + 10.4s]: train==[3.32620 = 1.00971 + 2.31649], recall= [ 0.01872  0.07265  0.10223  0.12400] , precision= [ 0.01957  0.01600  0.01123  0.00908] , auc=[0.65860], sum_recall=[0.31761]
Epoch 2 [139.7s + 10.4s]: train==[2.92521 = 0.60996 + 2.31525], recall= [ 0.02298  0.08329  0.11492  0.13724] , precision= [ 0.02383  0.01821  0.01260  0.01004] , auc=[0.69242], sum_recall=[0.35844]
Epoch 3 [140.7s + 11.6s]: train==[2.77842 = 0.46529 + 2.31314], recall= [ 0.02723  0.08360  0.12223  0.14541] , precision= [ 0.02809  0.01804  0.01345  0.01078] , auc=[0.71376], sum_recall=[0.37847]
Epoch 4 [139.4s + 12.3s]: train==[2.69908 = 0.38900 + 2.31008], recall= [ 0.02383  0.08184  0.12446  0.14584] , precision= [ 0.02468  0.01787  0.01353  0.01078] , auc=[0.72835], sum_recall=[0.37597]
Epoch 5 [135.5s + 12.3s]: train==[2.65270 = 0.34659 + 2.30610], recall= [ 0.02809  0.08652  0.12616  0.14955] , precision= [ 0.02894  0.01872  0.01379  0.01106] , auc=[0.73965], sum_recall=[0.39032]
Epoch 6 [138.4s + 12.2s]: train==[2.62238 = 0.32104 + 2.30134], recall= [ 0.02723  0.08907  0.12404  0.15082] , precision= [ 0.02809  0.01923  0.01362  0.01106] , auc=[0.74717], sum_recall=[0.39117]
Epoch 7 [80.1s + 12.4s]: train==[2.60012 = 0.30398 + 2.29614], recall= [ 0.03064  0.08895  0.12233  0.15082] , precision= [ 0.03149  0.01923  0.01336  0.01106] , auc=[0.75216], sum_recall=[0.39275]
Epoch 8 [138.8s + 12.1s]: train==[2.57885 = 0.28790 + 2.29095], recall= [ 0.03319  0.09065  0.12063  0.14955] , precision= [ 0.03404  0.01957  0.01328  0.01101] , auc=[0.75584], sum_recall=[0.39402]
Epoch 9 [138.2s + 12.1s]: train==[2.55293 = 0.26682 + 2.28611], recall= [ 0.03319  0.08780  0.12340  0.14967] , precision= [ 0.03404  0.01923  0.01353  0.01101] , auc=[0.75863], sum_recall=[0.39405]
Epoch 10 [136.7s + 12.4s]: train==[2.54238 = 0.26068 + 2.28170], recall= [ 0.03498  0.09014  0.12212  0.14967] , precision= [ 0.03660  0.01957  0.01345  0.01101] , auc=[0.76113], sum_recall=[0.39691]
Epoch 11 [138.4s + 12.6s]: train==[2.52649 = 0.24899 + 2.27750], recall= [ 0.03838  0.09056  0.12309  0.14882] , precision= [ 0.04000  0.01957  0.01362  0.01095] , auc=[0.76313], sum_recall=[0.40086]
Epoch 12 [135.1s + 11.6s]: train==[2.51120 = 0.23782 + 2.27338], recall= [ 0.03923  0.09226  0.12395  0.14967] , precision= [ 0.04085  0.01991  0.01370  0.01101] , auc=[0.76478], sum_recall=[0.40511]
Epoch 13 [136.3s + 12.1s]: train==[2.49419 = 0.22484 + 2.26935], recall= [ 0.03966  0.09056  0.12565  0.15052] , precision= [ 0.04170  0.01957  0.01387  0.01106] , auc=[0.76624], sum_recall=[0.40639]
Epoch 14 [110.3s + 12.7s]: train==[2.48082 = 0.21529 + 2.26552], recall= [ 0.04051  0.08886  0.12522  0.15031] , precision= [ 0.04255  0.01923  0.01379  0.01112] , auc=[0.76751], sum_recall=[0.40490]
Epoch 15 [137.9s + 12.7s]: train==[2.47140 = 0.20954 + 2.26186], recall= [ 0.04094  0.08758  0.12522  0.15201] , precision= [ 0.04340  0.01906  0.01379  0.01123] , auc=[0.76866], sum_recall=[0.40575]
Epoch 16 [136.8s + 12.3s]: train==[2.45784 = 0.19962 + 2.25822], recall= [ 0.04094  0.08941  0.12714  0.15215] , precision= [ 0.04340  0.01957  0.01404  0.01129] , auc=[0.76960], sum_recall=[0.40963]
Epoch 17 [140.8s + 11.8s]: train==[2.44737 = 0.19302 + 2.25435], recall= [ 0.04094  0.09040  0.12714  0.15130] , precision= [ 0.04340  0.01974  0.01404  0.01123] , auc=[0.77052], sum_recall=[0.40977]
Epoch 18 [136.3s + 12.3s]: train==[2.44148 = 0.19130 + 2.25018], recall= [ 0.04221  0.09125  0.12515  0.15300] , precision= [ 0.04511  0.01991  0.01387  0.01135] , auc=[0.77126], sum_recall=[0.41162]
Epoch 19 [135.3s + 13.5s]: train==[2.43248 = 0.18644 + 2.24604], recall= [ 0.04221  0.09168  0.12600  0.15343] , precision= [ 0.04511  0.01991  0.01396  0.01140] , auc=[0.77191], sum_recall=[0.41332]
Epoch 20 [150.3s + 12.8s]: train==[2.42057 = 0.17856 + 2.24201], recall= [ 0.04136  0.08870  0.12543  0.15394] , precision= [ 0.04426  0.01940  0.01387  0.01152] , auc=[0.77242], sum_recall=[0.40943]
Epoch 21 [97.6s + 12.5s]: train==[2.41730 = 0.17925 + 2.23805], recall= [ 0.03966  0.08997  0.12302  0.15402] , precision= [ 0.04255  0.01974  0.01370  0.01157] , auc=[0.77292], sum_recall=[0.40668]
Epoch 22 [145.1s + 12.2s]: train==[2.41280 = 0.17880 + 2.23401], recall= [ 0.03966  0.09338  0.12501  0.15594] , precision= [ 0.04255  0.02043  0.01379  0.01174] , auc=[0.77332], sum_recall=[0.41399]
Epoch 23 [138.5s + 12.2s]: train==[2.40287 = 0.17309 + 2.22978], recall= [ 0.03765  0.09380  0.12756  0.15594] , precision= [ 0.04085  0.02043  0.01404  0.01174] , auc=[0.77375], sum_recall=[0.41496]
Epoch 24 [141.6s + 13.2s]: train==[2.39097 = 0.16567 + 2.22529], recall= [ 0.03808  0.09210  0.12863  0.15649] , precision= [ 0.04085  0.02009  0.01421  0.01169] , auc=[0.77444], sum_recall=[0.41530]
Epoch 25 [149.3s + 12.9s]: train==[2.38077 = 0.16055 + 2.22021], recall= [ 0.03638  0.09295  0.13017  0.15828] , precision= [ 0.03915  0.02026  0.01455  0.01186] , auc=[0.77532], sum_recall=[0.41778]
Epoch 26 [137.9s + 11.9s]: train==[2.37713 = 0.16291 + 2.21421], recall= [ 0.03680  0.09231  0.13187  0.15819] , precision= [ 0.04000  0.02026  0.01472  0.01180] , auc=[0.77630], sum_recall=[0.41918]
Epoch 27 [137.4s + 11.8s]: train==[2.36972 = 0.16232 + 2.20740], recall= [ 0.03723  0.09529  0.13428  0.15649] , precision= [ 0.04000  0.02094  0.01489  0.01169] , auc=[0.77703], sum_recall=[0.42329]
Epoch 28 [82.1s + 12.7s]: train==[2.35260 = 0.15262 + 2.19999], recall= [ 0.03638  0.09572  0.13416  0.15947] , precision= [ 0.03915  0.02094  0.01481  0.01191] , auc=[0.77747], sum_recall=[0.42572]
Epoch 29 [138.2s + 12.3s]: train==[2.34578 = 0.15402 + 2.19175], recall= [ 0.03467  0.09529  0.13151  0.16032] , precision= [ 0.03745  0.02077  0.01455  0.01197] , auc=[0.77796], sum_recall=[0.42180]
Epoch 30 [138.9s + 12.4s]: train==[2.33424 = 0.15061 + 2.18363], recall= [ 0.03285  0.09494  0.13236  0.16139] , precision= [ 0.03489  0.02094  0.01464  0.01209] , auc=[0.77846], sum_recall=[0.42154]
Epoch 31 [137.6s + 11.9s]: train==[2.31761 = 0.14272 + 2.17489], recall= [ 0.03413  0.09579  0.13293  0.16194] , precision= [ 0.03574  0.02111  0.01472  0.01203] , auc=[0.77898], sum_recall=[0.42479]
Epoch 32 [152.9s + 11.9s]: train==[2.30588 = 0.13946 + 2.16642], recall= [ 0.03680  0.09664  0.13463  0.16236] , precision= [ 0.03915  0.02128  0.01489  0.01209] , auc=[0.77939], sum_recall=[0.43044]
Epoch 33 [136.4s + 12.7s]: train==[2.29853 = 0.14031 + 2.15822], recall= [ 0.03850  0.09579  0.13719  0.16222] , precision= [ 0.04085  0.02111  0.01523  0.01209] , auc=[0.77958], sum_recall=[0.43370]
Epoch 34 [138.2s + 12.8s]: train==[2.28788 = 0.13736 + 2.15052], recall= [ 0.03850  0.09536  0.13889  0.16061] , precision= [ 0.04085  0.02111  0.01540  0.01203] , auc=[0.77954], sum_recall=[0.43336]
Epoch 35 [91.7s + 13.4s]: train==[2.27502 = 0.13202 + 2.14299], recall= [ 0.03978  0.09579  0.13968  0.16018] , precision= [ 0.04255  0.02111  0.01549  0.01197] , auc=[0.77920], sum_recall=[0.43543]
Epoch 36 [146.8s + 11.9s]: train==[2.26698 = 0.13041 + 2.13657], recall= [ 0.03680  0.09962  0.13869  0.15919] , precision= [ 0.03915  0.02196  0.01540  0.01186] , auc=[0.77880], sum_recall=[0.43430]
Epoch 37 [143.9s + 12.2s]: train==[2.25993 = 0.12947 + 2.13046], recall= [ 0.03765  0.10013  0.13912  0.15876] , precision= [ 0.04000  0.02213  0.01540  0.01180] , auc=[0.77816], sum_recall=[0.43566]
Epoch 38 [137.6s + 12.4s]: train==[2.26244 = 0.13683 + 2.12560], recall= [ 0.03680  0.10141  0.13784  0.15876] , precision= [ 0.03915  0.02247  0.01523  0.01180] , auc=[0.77733], sum_recall=[0.43481]
Epoch 39 [138.5s + 12.8s]: train==[2.25548 = 0.13424 + 2.12124], recall= [ 0.03510  0.09715  0.13805  0.15961] , precision= [ 0.03745  0.02162  0.01532  0.01186] , auc=[0.77675], sum_recall=[0.42992]
Epoch 40 [136.6s + 12.0s]: train==[2.24127 = 0.12310 + 2.11817], recall= [ 0.03425  0.09871  0.13635  0.15876] , precision= [ 0.03660  0.02196  0.01515  0.01180] , auc=[0.77627], sum_recall=[0.42807]
Epoch 41 [140.2s + 11.8s]: train==[2.24832 = 0.13281 + 2.11551], recall= [ 0.03595  0.09871  0.13422  0.15663] , precision= [ 0.03830  0.02196  0.01498  0.01169] , auc=[0.77594], sum_recall=[0.42552]
Epoch 42 [89.7s + 12.7s]: train==[2.24027 = 0.12606 + 2.11421], recall= [ 0.03510  0.09956  0.13380  0.15749] , precision= [ 0.03745  0.02213  0.01489  0.01169] , auc=[0.77576], sum_recall=[0.42595]
Epoch 43 [138.0s + 12.3s]: train==[2.23763 = 0.12480 + 2.11283], recall= [ 0.03170  0.09446  0.13422  0.15578] , precision= [ 0.03404  0.02111  0.01498  0.01157] , auc=[0.77577], sum_recall=[0.41616]
End of trainning! Best recall= [ 0.03850  0.09579  0.13719  0.16222] , precision= [ 0.04085  0.02111  0.01523  0.01209] , auc=[0.77958]
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross2', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-25 06:13:29
loading data...
[n_users, n_items]=[3209, 12331]
[n_train, n_test]=[2636, 1318]
[n_edges]=[260034]
Using GPU 1,  memory_free: 17642
tensor([ 0.0165,  0.0212, -0.0006,  0.0036,  0.0314], device='cuda:1')
Loading Model..Number of Model Parameters:  3348802
Epoch 0 [139.6s + 9.9s]: train==[5.00949 = 2.68918 + 2.32031], recall= [ 0.00894  0.01362  0.01816  0.01901] , precision= [ 0.00936  0.00289  0.00196  0.00136] , auc=[0.55820], sum_recall=[0.05972]
Epoch 1 [135.6s + 10.1s]: train==[3.34124 = 1.02195 + 2.31929], recall= [ 0.01884  0.06892  0.09899  0.12182] , precision= [ 0.02043  0.01481  0.01072  0.00879] , auc=[0.65745], sum_recall=[0.30857]
Epoch 2 [141.1s + 10.6s]: train==[2.93459 = 0.61673 + 2.31786], recall= [ 0.02608  0.07734  0.12209  0.14280] , precision= [ 0.02809  0.01702  0.01336  0.01044] , auc=[0.68368], sum_recall=[0.36830]
Epoch 3 [143.6s + 11.5s]: train==[2.78512 = 0.46961 + 2.31551], recall= [ 0.03161  0.08218  0.12507  0.14875] , precision= [ 0.03404  0.01787  0.01370  0.01084] , auc=[0.70088], sum_recall=[0.38761]
Epoch 4 [136.6s + 12.1s]: train==[2.70450 = 0.39230 + 2.31219], recall= [ 0.03204  0.08643  0.12845  0.15129] , precision= [ 0.03404  0.01889  0.01421  0.01112] , auc=[0.71565], sum_recall=[0.39821]
Epoch 5 [101.1s + 13.0s]: train==[2.66576 = 0.35782 + 2.30794], recall= [ 0.03033  0.08686  0.12682  0.15001] , precision= [ 0.03234  0.01906  0.01413  0.01106] , auc=[0.72768], sum_recall=[0.39402]
Epoch 6 [158.3s + 12.8s]: train==[2.63040 = 0.32754 + 2.30286], recall= [ 0.03161  0.08345  0.12341  0.15412] , precision= [ 0.03319  0.01821  0.01379  0.01135] , auc=[0.73680], sum_recall=[0.39260]
Epoch 7 [159.3s + 11.4s]: train==[2.60727 = 0.30996 + 2.29731], recall= [ 0.03459  0.08244  0.12583  0.15056] , precision= [ 0.03660  0.01804  0.01413  0.01123] , auc=[0.74341], sum_recall=[0.39341]
Epoch 8 [154.5s + 11.2s]: train==[2.58417 = 0.29240 + 2.29178], recall= [ 0.03714  0.08202  0.12455  0.14971] , precision= [ 0.03915  0.01804  0.01404  0.01118] , auc=[0.74854], sum_recall=[0.39341]
Epoch 9 [154.5s + 11.7s]: train==[2.55335 = 0.26671 + 2.28665], recall= [ 0.03970  0.08074  0.12724  0.15013] , precision= [ 0.04170  0.01770  0.01438  0.01123] , auc=[0.75239], sum_recall=[0.39781]
Epoch 10 [155.3s + 12.4s]: train==[2.54488 = 0.26283 + 2.28204], recall= [ 0.04310  0.08074  0.12724  0.14940] , precision= [ 0.04511  0.01770  0.01430  0.01123] , auc=[0.75539], sum_recall=[0.40049]
Epoch 11 [155.2s + 12.5s]: train==[2.52916 = 0.25140 + 2.27776], recall= [ 0.04310  0.08202  0.12895  0.15141] , precision= [ 0.04511  0.01804  0.01447  0.01129] , auc=[0.75756], sum_recall=[0.40547]
Epoch 12 [157.3s + 11.3s]: train==[2.51345 = 0.23982 + 2.27362], recall= [ 0.04267  0.08457  0.12864  0.15396] , precision= [ 0.04511  0.01855  0.01447  0.01146] , auc=[0.75910], sum_recall=[0.40985]
Epoch 13 [173.3s + 12.0s]: train==[2.49880 = 0.22923 + 2.26957], recall= [ 0.04097  0.08499  0.12779  0.15396] , precision= [ 0.04340  0.01872  0.01438  0.01146] , auc=[0.76047], sum_recall=[0.40772]
Epoch 14 [169.7s + 11.5s]: train==[2.48593 = 0.22021 + 2.26572], recall= [ 0.04012  0.08499  0.13120  0.15481] , precision= [ 0.04255  0.01872  0.01472  0.01152] , auc=[0.76163], sum_recall=[0.41112]
Epoch 15 [182.4s + 11.7s]: train==[2.47706 = 0.21496 + 2.26210], recall= [ 0.03927  0.08627  0.13290  0.15660] , precision= [ 0.04170  0.01906  0.01489  0.01169] , auc=[0.76273], sum_recall=[0.41504]
Epoch 16 [157.6s + 12.0s]: train==[2.46296 = 0.20436 + 2.25860], recall= [ 0.04000  0.08670  0.13414  0.15681] , precision= [ 0.04170  0.01906  0.01506  0.01174] , auc=[0.76383], sum_recall=[0.41765]
Epoch 17 [110.8s + 12.2s]: train==[2.45079 = 0.19580 + 2.25499], recall= [ 0.03830  0.08585  0.13563  0.15669] , precision= [ 0.04000  0.01889  0.01532  0.01169] , auc=[0.76497], sum_recall=[0.41646]
Epoch 18 [164.7s + 11.9s]: train==[2.44447 = 0.19338 + 2.25109], recall= [ 0.03915  0.08767  0.13775  0.15754] , precision= [ 0.04085  0.01940  0.01549  0.01174] , auc=[0.76613], sum_recall=[0.42212]
Epoch 19 [150.9s + 11.6s]: train==[2.43638 = 0.18924 + 2.24714], recall= [ 0.03745  0.08852  0.13279  0.15924] , precision= [ 0.03915  0.01957  0.01498  0.01186] , auc=[0.76728], sum_recall=[0.41800]
Epoch 20 [151.5s + 12.5s]: train==[2.42393 = 0.18054 + 2.24339], recall= [ 0.03957  0.09022  0.13322  0.15924] , precision= [ 0.04170  0.01991  0.01506  0.01186] , auc=[0.76840], sum_recall=[0.42226]
Epoch 21 [150.6s + 11.5s]: train==[2.42248 = 0.18261 + 2.23987], recall= [ 0.03714  0.08946  0.13322  0.16010] , precision= [ 0.04000  0.01991  0.01506  0.01191] , auc=[0.76953], sum_recall=[0.41991]
Epoch 22 [148.3s + 11.2s]: train==[2.41576 = 0.17917 + 2.23659], recall= [ 0.03544  0.08988  0.13151  0.16095] , precision= [ 0.03830  0.01991  0.01489  0.01197] , auc=[0.77057], sum_recall=[0.41778]
Epoch 23 [148.8s + 11.6s]: train==[2.40604 = 0.17262 + 2.23342], recall= [ 0.03714  0.08861  0.13236  0.16010] , precision= [ 0.04000  0.01974  0.01498  0.01191] , auc=[0.77139], sum_recall=[0.41821]
Epoch 24 [28.0s + 11.7s]: train==[2.39800 = 0.16751 + 2.23049], recall= [ 0.03629  0.08861  0.13492  0.16222] , precision= [ 0.03915  0.01974  0.01523  0.01209] , auc=[0.77228], sum_recall=[0.42204]
Epoch 25 [176.2s + 13.1s]: train==[2.39043 = 0.16265 + 2.22778], recall= [ 0.03544  0.08775  0.13393  0.16095] , precision= [ 0.03830  0.01957  0.01506  0.01203] , auc=[0.77336], sum_recall=[0.41807]
Epoch 26 [182.9s + 12.9s]: train==[2.39186 = 0.16679 + 2.22506], recall= [ 0.03374  0.08946  0.13520  0.16010] , precision= [ 0.03660  0.01991  0.01515  0.01197] , auc=[0.77436], sum_recall=[0.41849]
Epoch 27 [163.4s + 11.5s]: train==[2.38893 = 0.16676 + 2.22217], recall= [ 0.03459  0.09173  0.13669  0.16010] , precision= [ 0.03745  0.02026  0.01532  0.01197] , auc=[0.77505], sum_recall=[0.42310]
Epoch 28 [157.3s + 12.0s]: train==[2.37446 = 0.15514 + 2.21932], recall= [ 0.03459  0.09598  0.13754  0.16010] , precision= [ 0.03745  0.02111  0.01540  0.01186] , auc=[0.77537], sum_recall=[0.42821]
Epoch 29 [159.8s + 11.8s]: train==[2.37166 = 0.15518 + 2.21649], recall= [ 0.03544  0.09428  0.13797  0.15924] , precision= [ 0.03830  0.02077  0.01549  0.01180] , auc=[0.77581], sum_recall=[0.42693]
Epoch 30 [92.2s + 12.4s]: train==[2.36595 = 0.15237 + 2.21357], recall= [ 0.03799  0.09513  0.13924  0.15924] , precision= [ 0.04085  0.02094  0.01566  0.01180] , auc=[0.77637], sum_recall=[0.43161]
Epoch 31 [155.0s + 11.7s]: train==[2.35606 = 0.14580 + 2.21027], recall= [ 0.03970  0.09598  0.13839  0.15868] , precision= [ 0.04255  0.02111  0.01557  0.01180] , auc=[0.77693], sum_recall=[0.43275]
Epoch 32 [153.9s + 11.3s]: train==[2.34862 = 0.14226 + 2.20636], recall= [ 0.03757  0.09499  0.13839  0.16208] , precision= [ 0.04000  0.02094  0.01557  0.01203] , auc=[0.77745], sum_recall=[0.43303]
Epoch 33 [151.5s + 11.7s]: train==[2.34364 = 0.14238 + 2.20127], recall= [ 0.03757  0.09414  0.13584  0.16208] , precision= [ 0.04000  0.02077  0.01532  0.01203] , auc=[0.77790], sum_recall=[0.42963]
Epoch 34 [151.1s + 12.1s]: train==[2.33216 = 0.13691 + 2.19525], recall= [ 0.03927  0.09329  0.13541  0.16378] , precision= [ 0.04170  0.02060  0.01523  0.01214] , auc=[0.77837], sum_recall=[0.43175]
Epoch 35 [151.0s + 11.9s]: train==[2.32117 = 0.13314 + 2.18803], recall= [ 0.03757  0.09244  0.13456  0.16605] , precision= [ 0.04000  0.02043  0.01515  0.01237] , auc=[0.77875], sum_recall=[0.43062]
Epoch 36 [150.6s + 11.0s]: train==[2.31081 = 0.13061 + 2.18021], recall= [ 0.03757  0.09201  0.13541  0.16605] , precision= [ 0.04000  0.02043  0.01523  0.01237] , auc=[0.77898], sum_recall=[0.43105]
Epoch 37 [28.1s + 11.8s]: train==[2.29958 = 0.12811 + 2.17147], recall= [ 0.03927  0.09052  0.13499  0.16251] , precision= [ 0.04170  0.02026  0.01523  0.01209] , auc=[0.77913], sum_recall=[0.42729]
Epoch 38 [165.2s + 11.6s]: train==[2.29501 = 0.13236 + 2.16265], recall= [ 0.03629  0.08967  0.13499  0.16251] , precision= [ 0.03830  0.02009  0.01523  0.01209] , auc=[0.77904], sum_recall=[0.42346]
Epoch 39 [160.9s + 12.1s]: train==[2.28151 = 0.12785 + 2.15366], recall= [ 0.03544  0.09137  0.13478  0.16336] , precision= [ 0.03745  0.02043  0.01515  0.01214] , auc=[0.77918], sum_recall=[0.42495]
Epoch 40 [157.0s + 12.3s]: train==[2.26457 = 0.11918 + 2.14539], recall= [ 0.03544  0.09222  0.13307  0.16095] , precision= [ 0.03745  0.02060  0.01498  0.01203] , auc=[0.77938], sum_recall=[0.42168]
Epoch 41 [157.2s + 11.8s]: train==[2.26284 = 0.12552 + 2.13732], recall= [ 0.03672  0.09095  0.13137  0.15839] , precision= [ 0.03915  0.02026  0.01481  0.01186] , auc=[0.77962], sum_recall=[0.41743]
Epoch 42 [179.7s + 11.3s]: train==[2.25369 = 0.12253 + 2.13115], recall= [ 0.03459  0.08967  0.13137  0.15584] , precision= [ 0.03660  0.01991  0.01481  0.01169] , auc=[0.77997], sum_recall=[0.41147]
Epoch 43 [114.0s + 12.2s]: train==[2.24413 = 0.11851 + 2.12562], recall= [ 0.03416  0.09208  0.13052  0.15527] , precision= [ 0.03660  0.02060  0.01464  0.01157] , auc=[0.78032], sum_recall=[0.41204]
Epoch 44 [150.5s + 12.2s]: train==[2.23329 = 0.11269 + 2.12060], recall= [ 0.03416  0.09378  0.13095  0.15357] , precision= [ 0.03660  0.02094  0.01464  0.01146] , auc=[0.78045], sum_recall=[0.41246]
Epoch 45 [150.5s + 12.3s]: train==[2.23303 = 0.11668 + 2.11634], recall= [ 0.03502  0.09378  0.12924  0.15400] , precision= [ 0.03745  0.02094  0.01447  0.01146] , auc=[0.78054], sum_recall=[0.41204]
Epoch 46 [147.8s + 11.3s]: train==[2.23076 = 0.11699 + 2.11377], recall= [ 0.03595  0.08953  0.12712  0.15634] , precision= [ 0.03915  0.01991  0.01421  0.01157] , auc=[0.78016], sum_recall=[0.40893]
Epoch 47 [157.9s + 12.1s]: train==[2.23297 = 0.12121 + 2.11176], recall= [ 0.03553  0.09166  0.12584  0.15506] , precision= [ 0.03830  0.02043  0.01404  0.01146] , auc=[0.77947], sum_recall=[0.40808]
Epoch 48 [153.6s + 11.4s]: train==[2.23226 = 0.12207 + 2.11018], recall= [ 0.03297  0.08995  0.12201  0.15265] , precision= [ 0.03574  0.02009  0.01362  0.01123] , auc=[0.77877], sum_recall=[0.39758]
Epoch 49 [148.5s + 12.3s]: train==[2.23273 = 0.12276 + 2.10997], recall= [ 0.03127  0.08676  0.11903  0.14903] , precision= [ 0.03404  0.01940  0.01328  0.01101] , auc=[0.77851], sum_recall=[0.38610]
Epoch 50 [27.9s + 12.8s]: train==[2.23145 = 0.12052 + 2.11093], recall= [ 0.02829  0.08634  0.12201  0.15272] , precision= [ 0.03064  0.01940  0.01362  0.01129] , auc=[0.77856], sum_recall=[0.38936]
Epoch 51 [157.8s + 11.5s]: train==[2.23427 = 0.12276 + 2.11151], recall= [ 0.02829  0.08719  0.12208  0.14974] , precision= [ 0.03064  0.01957  0.01370  0.01106] , auc=[0.77848], sum_recall=[0.38730]
Epoch 52 [166.0s + 12.0s]: train==[2.22665 = 0.11654 + 2.11011], recall= [ 0.02659  0.08932  0.11783  0.15139] , precision= [ 0.02894  0.01991  0.01328  0.01123] , auc=[0.77771], sum_recall=[0.38512]
Epoch 53 [154.3s + 11.5s]: train==[2.22523 = 0.11411 + 2.11112], recall= [ 0.02659  0.08336  0.11932  0.15096] , precision= [ 0.02894  0.01872  0.01336  0.01123] , auc=[0.77736], sum_recall=[0.38022]
Epoch 54 [158.6s + 11.8s]: train==[2.23388 = 0.12102 + 2.11286], recall= [ 0.02744  0.08052  0.12080  0.15088] , precision= [ 0.02979  0.01804  0.01353  0.01118] , auc=[0.77731], sum_recall=[0.37964]
Epoch 55 [176.0s + 11.3s]: train==[2.22336 = 0.10995 + 2.11341], recall= [ 0.02772  0.07882  0.11910  0.14917] , precision= [ 0.03064  0.01770  0.01336  0.01112] , auc=[0.77685], sum_recall=[0.37482]
End of trainning! Best recall= [ 0.03502  0.09378  0.12924  0.15400] , precision= [ 0.03745  0.02094  0.01447  0.01146] , auc=[0.78054]
