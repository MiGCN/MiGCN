Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross0', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-23 14:55:28
loading data...
[n_users, n_items]=[3209, 12211]
[n_train, n_test]=[2636, 1318]
[n_edges]=[285362]
Using GPU 0,  memory_free: 21944
tensor([ 0.0159,  0.0267, -0.0153, -0.0210, -0.0101], device='cuda:0')
Loading Model..Number of Model Parameters:  3324802
Epoch 0 [39.1s + 8.6s]: train==[5.13294 = 2.81685 + 2.31610], recall= [ 0.00739  0.01387  0.01622  0.01796] , precision= [ 0.00783  0.00313  0.00191  0.00139] , auc=[0.48914], sum_recall=[0.05543]
Epoch 1 [39.2s + 25.0s]: train==[3.58470 = 1.27022 + 2.31448], recall= [ 0.01935  0.07114  0.12323  0.14309] , precision= [ 0.02261  0.01617  0.01383  0.01061] , auc=[0.66607], sum_recall=[0.35681]
Epoch 2 [38.8s + 28.3s]: train==[3.06067 = 0.75494 + 2.30573], recall= [ 0.01891  0.09557  0.15407  0.18371] , precision= [ 0.02174  0.02174  0.01739  0.01374] , auc=[0.74042], sum_recall=[0.45226]
Epoch 3 [39.1s + 10.7s]: train==[2.88355 = 0.58769 + 2.29587], recall= [ 0.02152  0.09615  0.15896  0.19684] , precision= [ 0.02435  0.02209  0.01791  0.01478] , auc=[0.76719], sum_recall=[0.47346]
Epoch 4 [39.2s + 11.5s]: train==[2.76306 = 0.47584 + 2.28721], recall= [ 0.02379  0.09513  0.16011  0.19771] , precision= [ 0.02783  0.02157  0.01817  0.01496] , auc=[0.77959], sum_recall=[0.47675]
Epoch 5 [42.8s + 10.7s]: train==[2.70425 = 0.42359 + 2.28066], recall= [ 0.02423  0.09792  0.15743  0.20003] , precision= [ 0.02783  0.02226  0.01809  0.01513] , auc=[0.78825], sum_recall=[0.47960]
Epoch 6 [38.9s + 14.5s]: train==[2.66313 = 0.38660 + 2.27653], recall= [ 0.02466  0.09821  0.15757  0.20065] , precision= [ 0.02870  0.02243  0.01817  0.01530] , auc=[0.79436], sum_recall=[0.48109]
Epoch 7 [39.2s + 10.8s]: train==[2.63004 = 0.35545 + 2.27459], recall= [ 0.02457  0.09509  0.16091  0.20126] , precision= [ 0.02783  0.02157  0.01852  0.01536] , auc=[0.79921], sum_recall=[0.48183]
Epoch 8 [40.3s + 10.8s]: train==[2.60086 = 0.32663 + 2.27423], recall= [ 0.02283  0.09454  0.16642  0.20300] , precision= [ 0.02609  0.02174  0.01922  0.01548] , auc=[0.80373], sum_recall=[0.48678]
Epoch 9 [39.3s + 11.1s]: train==[2.58129 = 0.30676 + 2.27453], recall= [ 0.02283  0.09889  0.16776  0.20926] , precision= [ 0.02609  0.02261  0.01922  0.01594] , auc=[0.80707], sum_recall=[0.49874]
Epoch 10 [38.9s + 11.2s]: train==[2.57099 = 0.29619 + 2.27480], recall= [ 0.02370  0.09727  0.17023  0.21209] , precision= [ 0.02696  0.02226  0.01939  0.01617] , auc=[0.80987], sum_recall=[0.50328]
Epoch 11 [39.1s + 10.7s]: train==[2.55191 = 0.27782 + 2.27410], recall= [ 0.02283  0.10017  0.17489  0.21144] , precision= [ 0.02609  0.02313  0.02000  0.01617] , auc=[0.81227], sum_recall=[0.50932]
Epoch 12 [40.9s + 11.1s]: train==[2.54091 = 0.26886 + 2.27205], recall= [ 0.02283  0.10169  0.17562  0.21170] , precision= [ 0.02609  0.02330  0.02000  0.01606] , auc=[0.81457], sum_recall=[0.51183]
Epoch 13 [39.1s + 11.9s]: train==[2.51648 = 0.24787 + 2.26862], recall= [ 0.02065  0.10151  0.17518  0.21141] , precision= [ 0.02435  0.02313  0.01991  0.01612] , auc=[0.81675], sum_recall=[0.50876]
Epoch 14 [38.9s + 10.7s]: train==[2.50176 = 0.23757 + 2.26419], recall= [ 0.02065  0.10074  0.17431  0.21223] , precision= [ 0.02435  0.02313  0.01983  0.01617] , auc=[0.81878], sum_recall=[0.50794]
Epoch 15 [38.8s + 10.6s]: train==[2.49788 = 0.23860 + 2.25928], recall= [ 0.01978  0.09697  0.17584  0.21593] , precision= [ 0.02348  0.02226  0.01991  0.01646] , auc=[0.82054], sum_recall=[0.50852]
Epoch 16 [39.3s + 12.8s]: train==[2.48179 = 0.22722 + 2.25456], recall= [ 0.02022  0.10092  0.17497  0.21701] , precision= [ 0.02435  0.02330  0.01983  0.01658] , auc=[0.82199], sum_recall=[0.51311]
Epoch 17 [39.4s + 10.7s]: train==[2.46899 = 0.21880 + 2.25019], recall= [ 0.02109  0.10236  0.17736  0.21593] , precision= [ 0.02522  0.02348  0.02017  0.01646] , auc=[0.82325], sum_recall=[0.51673]
Epoch 18 [39.5s + 10.8s]: train==[2.46416 = 0.21782 + 2.24634], recall= [ 0.02184  0.10555  0.17743  0.21549] , precision= [ 0.02609  0.02400  0.02017  0.01641] , auc=[0.82421], sum_recall=[0.52031]
Epoch 19 [39.2s + 12.1s]: train==[2.44757 = 0.20476 + 2.24280], recall= [ 0.02271  0.10468  0.17656  0.21723] , precision= [ 0.02696  0.02383  0.02009  0.01652] , auc=[0.82493], sum_recall=[0.52118]
Epoch 20 [40.4s + 11.5s]: train==[2.44225 = 0.20284 + 2.23942], recall= [ 0.02357  0.10729  0.17521  0.21897] , precision= [ 0.02783  0.02435  0.02000  0.01658] , auc=[0.82558], sum_recall=[0.52504]
Epoch 21 [40.5s + 11.0s]: train==[2.43597 = 0.19961 + 2.23635], recall= [ 0.02618  0.10758  0.17555  0.21752] , precision= [ 0.03043  0.02452  0.01991  0.01646] , auc=[0.82612], sum_recall=[0.52683]
Epoch 22 [39.6s + 11.0s]: train==[2.42516 = 0.19162 + 2.23353], recall= [ 0.02565  0.10712  0.17325  0.21639] , precision= [ 0.02870  0.02417  0.01983  0.01646] , auc=[0.82652], sum_recall=[0.52241]
Epoch 23 [39.2s + 11.2s]: train==[2.42075 = 0.18954 + 2.23121], recall= [ 0.02652  0.10492  0.17600  0.21400] , precision= [ 0.02957  0.02348  0.02009  0.01629] , auc=[0.82677], sum_recall=[0.52144]
Epoch 24 [39.5s + 10.9s]: train==[2.41295 = 0.18366 + 2.22929], recall= [ 0.02464  0.10509  0.17427  0.21545] , precision= [ 0.02696  0.02365  0.01991  0.01635] , auc=[0.82698], sum_recall=[0.51944]
Epoch 25 [40.7s + 12.0s]: train==[2.40735 = 0.17948 + 2.22787], recall= [ 0.02551  0.10596  0.17561  0.21566] , precision= [ 0.02783  0.02383  0.01991  0.01641] , auc=[0.82735], sum_recall=[0.52274]
Epoch 26 [41.4s + 11.4s]: train==[2.40800 = 0.18142 + 2.22658], recall= [ 0.02638  0.10654  0.17561  0.21598] , precision= [ 0.02870  0.02417  0.01991  0.01652] , auc=[0.82776], sum_recall=[0.52451]
Epoch 27 [39.2s + 10.2s]: train==[2.40016 = 0.17469 + 2.22547], recall= [ 0.02638  0.10850  0.17340  0.21743] , precision= [ 0.02870  0.02470  0.01983  0.01670] , auc=[0.82815], sum_recall=[0.52570]
Epoch 28 [45.2s + 10.8s]: train==[2.39497 = 0.17044 + 2.22452], recall= [ 0.02812  0.10915  0.17296  0.21613] , precision= [ 0.03043  0.02470  0.01991  0.01664] , auc=[0.82823], sum_recall=[0.52635]
Epoch 29 [39.0s + 10.8s]: train==[2.38797 = 0.16441 + 2.22356], recall= [ 0.02855  0.10883  0.17528  0.21656] , precision= [ 0.03130  0.02435  0.02017  0.01664] , auc=[0.82810], sum_recall=[0.52923]
Epoch 30 [39.1s + 10.7s]: train==[2.38577 = 0.16290 + 2.22287], recall= [ 0.02855  0.10980  0.17369  0.21552] , precision= [ 0.03130  0.02470  0.02009  0.01652] , auc=[0.82791], sum_recall=[0.52756]
Epoch 31 [43.7s + 11.6s]: train==[2.38147 = 0.15914 + 2.22234], recall= [ 0.02812  0.11154  0.17438  0.21595] , precision= [ 0.03043  0.02504  0.02009  0.01658] , auc=[0.82754], sum_recall=[0.52999]
Epoch 32 [39.3s + 12.2s]: train==[2.37657 = 0.15459 + 2.22198], recall= [ 0.02899  0.11317  0.17547  0.21465] , precision= [ 0.03130  0.02574  0.02017  0.01646] , auc=[0.82720], sum_recall=[0.53227]
Epoch 33 [39.6s + 10.9s]: train==[2.37524 = 0.15344 + 2.22181], recall= [ 0.02768  0.11317  0.17612  0.21649] , precision= [ 0.02957  0.02574  0.02017  0.01658] , auc=[0.82701], sum_recall=[0.53346]
Epoch 34 [39.5s + 10.8s]: train==[2.36945 = 0.14781 + 2.22164], recall= [ 0.02768  0.11317  0.17526  0.21697] , precision= [ 0.02957  0.02574  0.02009  0.01652] , auc=[0.82696], sum_recall=[0.53308]
Epoch 35 [39.0s + 11.8s]: train==[2.37186 = 0.15037 + 2.22149], recall= [ 0.02812  0.11346  0.17265  0.21791] , precision= [ 0.03043  0.02591  0.01983  0.01670] , auc=[0.82695], sum_recall=[0.53214]
Epoch 36 [39.2s + 21.9s]: train==[2.37048 = 0.14923 + 2.22125], recall= [ 0.02855  0.11433  0.17435  0.21617] , precision= [ 0.03130  0.02609  0.02017  0.01658] , auc=[0.82693], sum_recall=[0.53340]
Epoch 37 [39.1s + 10.6s]: train==[2.35771 = 0.13676 + 2.22095], recall= [ 0.02855  0.11259  0.17348  0.21556] , precision= [ 0.03130  0.02574  0.02009  0.01646] , auc=[0.82690], sum_recall=[0.53018]
Epoch 38 [38.9s + 11.1s]: train==[2.35509 = 0.13471 + 2.22038], recall= [ 0.02812  0.11194  0.17466  0.21597] , precision= [ 0.03043  0.02557  0.02026  0.01641] , auc=[0.82690], sum_recall=[0.53069]
End of trainning! Best recall= [ 0.02812  0.10915  0.17296  0.21613] , precision= [ 0.03043  0.02470  0.01991  0.01664] , auc=[0.82823]
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross0', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-23 15:29:24
loading data...
[n_users, n_items]=[3209, 12211]
[n_train, n_test]=[2636, 1318]
[n_edges]=[285362]
Using GPU 0,  memory_free: 24265
tensor([-0.0291, -0.0054, -0.0095, -0.0065,  0.0335], device='cuda:0')
Loading Model..Number of Model Parameters:  3324802
Epoch 0 [38.8s + 9.7s]: train==[5.13885 = 2.81643 + 2.32242], recall= [ 0.00283  0.01043  0.01391  0.01616] , precision= [ 0.00348  0.00243  0.00157  0.00128] , auc=[0.49423], sum_recall=[0.04333]
Epoch 1 [41.0s + 10.5s]: train==[3.57851 = 1.25899 + 2.31952], recall= [ 0.01486  0.06736  0.11532  0.14636] , precision= [ 0.01739  0.01513  0.01296  0.01084] , auc=[0.69043], sum_recall=[0.34389]
Epoch 2 [39.7s + 10.8s]: train==[3.08073 = 0.77176 + 2.30897], recall= [ 0.01920  0.08630  0.15131  0.18975] , precision= [ 0.02348  0.02017  0.01739  0.01438] , auc=[0.75514], sum_recall=[0.44657]
Epoch 3 [39.7s + 16.5s]: train==[2.89096 = 0.59334 + 2.29762], recall= [ 0.02496  0.09629  0.16682  0.20619] , precision= [ 0.03043  0.02261  0.01913  0.01565] , auc=[0.77617], sum_recall=[0.49426]
Epoch 4 [45.7s + 12.4s]: train==[2.76184 = 0.47380 + 2.28804], recall= [ 0.02709  0.09484  0.17338  0.20039] , precision= [ 0.03391  0.02261  0.01983  0.01525] , auc=[0.78259], sum_recall=[0.49569]
Epoch 5 [39.7s + 12.2s]: train==[2.70653 = 0.42538 + 2.28115], recall= [ 0.02500  0.10078  0.17623  0.20727] , precision= [ 0.03043  0.02383  0.02026  0.01571] , auc=[0.78834], sum_recall=[0.50928]
Epoch 6 [39.6s + 12.0s]: train==[2.66527 = 0.38820 + 2.27707], recall= [ 0.02674  0.09882  0.17275  0.21061] , precision= [ 0.03217  0.02330  0.01991  0.01594] , auc=[0.79308], sum_recall=[0.50892]
Epoch 7 [39.9s + 12.3s]: train==[2.63200 = 0.35678 + 2.27522], recall= [ 0.02517  0.10075  0.17304  0.21087] , precision= [ 0.03130  0.02348  0.02000  0.01594] , auc=[0.79723], sum_recall=[0.50984]
Epoch 8 [40.4s + 11.6s]: train==[2.60709 = 0.33218 + 2.27491], recall= [ 0.02517  0.10749  0.17855  0.21000] , precision= [ 0.03130  0.02470  0.02043  0.01588] , auc=[0.80131], sum_recall=[0.52121]
Epoch 9 [40.1s + 11.8s]: train==[2.58259 = 0.30758 + 2.27501], recall= [ 0.02836  0.10641  0.17674  0.21608] , precision= [ 0.03391  0.02452  0.02026  0.01629] , auc=[0.80441], sum_recall=[0.52759]
Epoch 10 [41.0s + 12.8s]: train==[2.56833 = 0.29358 + 2.27475], recall= [ 0.02467  0.10641  0.17758  0.21942] , precision= [ 0.02957  0.02452  0.02026  0.01652] , auc=[0.80743], sum_recall=[0.52807]
Epoch 11 [40.4s + 11.8s]: train==[2.55386 = 0.28052 + 2.27334], recall= [ 0.02467  0.10771  0.17845  0.22311] , precision= [ 0.02957  0.02487  0.02035  0.01681] , auc=[0.81008], sum_recall=[0.53394]
Epoch 12 [45.0s + 12.0s]: train==[2.54210 = 0.27139 + 2.27071], recall= [ 0.02423  0.10945  0.17918  0.22058] , precision= [ 0.02957  0.02522  0.02052  0.01664] , auc=[0.81248], sum_recall=[0.53344]
Epoch 13 [38.8s + 12.1s]: train==[2.51826 = 0.25151 + 2.26676], recall= [ 0.02351  0.11293  0.18084  0.22050] , precision= [ 0.02957  0.02591  0.02070  0.01664] , auc=[0.81433], sum_recall=[0.53778]
Epoch 14 [38.9s + 11.4s]: train==[2.50781 = 0.24584 + 2.26198], recall= [ 0.02220  0.11612  0.18050  0.22050] , precision= [ 0.02783  0.02643  0.02078  0.01664] , auc=[0.81651], sum_recall=[0.53933]
Epoch 15 [39.0s + 11.6s]: train==[2.49452 = 0.23757 + 2.25695], recall= [ 0.02336  0.11438  0.17867  0.21906] , precision= [ 0.02957  0.02609  0.02043  0.01646] , auc=[0.81851], sum_recall=[0.53546]
Epoch 16 [41.3s + 12.4s]: train==[2.48141 = 0.22910 + 2.25231], recall= [ 0.02220  0.11590  0.17693  0.21997] , precision= [ 0.02783  0.02661  0.02026  0.01652] , auc=[0.82017], sum_recall=[0.53500]
Epoch 17 [39.0s + 11.3s]: train==[2.46815 = 0.22015 + 2.24800], recall= [ 0.02307  0.11590  0.17693  0.22244] , precision= [ 0.02870  0.02661  0.02026  0.01670] , auc=[0.82161], sum_recall=[0.53834]
Epoch 18 [38.9s + 11.6s]: train==[2.46419 = 0.22001 + 2.24418], recall= [ 0.02293  0.11503  0.17389  0.22070] , precision= [ 0.02783  0.02643  0.01991  0.01658] , auc=[0.82286], sum_recall=[0.53254]
Epoch 19 [38.8s + 12.4s]: train==[2.44800 = 0.20723 + 2.24076], recall= [ 0.02380  0.11686  0.17389  0.22392] , precision= [ 0.02870  0.02696  0.01991  0.01687] , auc=[0.82378], sum_recall=[0.53846]
Epoch 20 [38.9s + 11.8s]: train==[2.44261 = 0.20516 + 2.23746], recall= [ 0.02467  0.11600  0.17715  0.22247] , precision= [ 0.02957  0.02678  0.02017  0.01670] , auc=[0.82451], sum_recall=[0.54028]
Epoch 21 [38.8s + 11.4s]: train==[2.43401 = 0.19950 + 2.23451], recall= [ 0.02536  0.11513  0.17802  0.22090] , precision= [ 0.02957  0.02661  0.02026  0.01664] , auc=[0.82509], sum_recall=[0.53941]
Epoch 22 [38.9s + 11.7s]: train==[2.42492 = 0.19301 + 2.23192], recall= [ 0.02580  0.11317  0.17976  0.22107] , precision= [ 0.03043  0.02609  0.02043  0.01675] , auc=[0.82554], sum_recall=[0.53980]
Epoch 23 [38.8s + 11.5s]: train==[2.41838 = 0.18854 + 2.22984], recall= [ 0.02536  0.11346  0.17906  0.21977] , precision= [ 0.02957  0.02626  0.02043  0.01664] , auc=[0.82569], sum_recall=[0.53765]
Epoch 24 [38.8s + 11.6s]: train==[2.41413 = 0.18602 + 2.22811], recall= [ 0.02580  0.11172  0.17895  0.21885] , precision= [ 0.03043  0.02591  0.02035  0.01670] , auc=[0.82580], sum_recall=[0.53531]
Epoch 25 [38.9s + 11.5s]: train==[2.40702 = 0.18019 + 2.22682], recall= [ 0.02580  0.11259  0.17939  0.21609] , precision= [ 0.03043  0.02609  0.02043  0.01646] , auc=[0.82598], sum_recall=[0.53386]
Epoch 26 [38.9s + 11.9s]: train==[2.40719 = 0.18157 + 2.22562], recall= [ 0.02797  0.11020  0.17997  0.21609] , precision= [ 0.03304  0.02574  0.02043  0.01646] , auc=[0.82614], sum_recall=[0.53423]
Epoch 27 [39.0s + 11.0s]: train==[2.39752 = 0.17299 + 2.22453], recall= [ 0.02884  0.10759  0.17997  0.21711] , precision= [ 0.03391  0.02522  0.02043  0.01658] , auc=[0.82624], sum_recall=[0.53350]
Epoch 28 [38.9s + 11.4s]: train==[2.39234 = 0.16876 + 2.22357], recall= [ 0.02928  0.10759  0.17910  0.22015] , precision= [ 0.03391  0.02522  0.02035  0.01675] , auc=[0.82631], sum_recall=[0.53611]
Epoch 29 [39.0s + 12.2s]: train==[2.38739 = 0.16486 + 2.22254], recall= [ 0.02957  0.10781  0.18071  0.22058] , precision= [ 0.03304  0.02522  0.02052  0.01681] , auc=[0.82611], sum_recall=[0.53867]
Epoch 30 [39.2s + 11.8s]: train==[2.38440 = 0.16263 + 2.22177], recall= [ 0.02870  0.10868  0.17985  0.21807] , precision= [ 0.03217  0.02539  0.02043  0.01670] , auc=[0.82586], sum_recall=[0.53529]
Epoch 31 [39.1s + 12.1s]: train==[2.38276 = 0.16159 + 2.22116], recall= [ 0.02870  0.10955  0.18176  0.21851] , precision= [ 0.03217  0.02557  0.02070  0.01675] , auc=[0.82557], sum_recall=[0.53851]
Epoch 32 [39.2s + 12.3s]: train==[2.37411 = 0.15340 + 2.22070], recall= [ 0.02870  0.11042  0.18089  0.21829] , precision= [ 0.03217  0.02574  0.02061  0.01670] , auc=[0.82526], sum_recall=[0.53829]
Epoch 33 [39.4s + 11.3s]: train==[2.37668 = 0.15633 + 2.22035], recall= [ 0.02986  0.11198  0.17871  0.22046] , precision= [ 0.03391  0.02591  0.02043  0.01687] , auc=[0.82511], sum_recall=[0.54101]
Epoch 34 [38.7s + 11.1s]: train==[2.36921 = 0.14930 + 2.21991], recall= [ 0.03159  0.11372  0.18132  0.22307] , precision= [ 0.03565  0.02626  0.02070  0.01704] , auc=[0.82506], sum_recall=[0.54971]
Epoch 35 [38.9s + 12.0s]: train==[2.36985 = 0.15044 + 2.21941], recall= [ 0.03072  0.11372  0.18230  0.22329] , precision= [ 0.03478  0.02626  0.02087  0.01710] , auc=[0.82521], sum_recall=[0.55004]
Epoch 36 [38.9s + 10.8s]: train==[2.36927 = 0.15056 + 2.21872], recall= [ 0.02986  0.11357  0.17853  0.22503] , precision= [ 0.03391  0.02609  0.02043  0.01728] , auc=[0.82534], sum_recall=[0.54699]
Epoch 37 [38.9s + 11.8s]: train==[2.35698 = 0.13907 + 2.21790], recall= [ 0.03072  0.11285  0.18169  0.22312] , precision= [ 0.03478  0.02609  0.02078  0.01710] , auc=[0.82551], sum_recall=[0.54838]
Epoch 38 [42.0s + 12.2s]: train==[2.35041 = 0.13376 + 2.21665], recall= [ 0.02986  0.11215  0.18065  0.22210] , precision= [ 0.03391  0.02609  0.02061  0.01699] , auc=[0.82541], sum_recall=[0.54476]
End of trainning! Best recall= [ 0.02928  0.10759  0.17910  0.22015] , precision= [ 0.03391  0.02522  0.02035  0.01675] , auc=[0.82631]
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross0', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-23 16:03:00
loading data...
[n_users, n_items]=[3209, 12211]
[n_train, n_test]=[2636, 1318]
[n_edges]=[285362]
Using GPU 0,  memory_free: 22192
tensor([-0.0304, -0.0132, -0.0208, -0.0030,  0.0417], device='cuda:0')
Loading Model..Number of Model Parameters:  3324802
Epoch 0 [38.4s + 10.1s]: train==[5.13546 = 2.82126 + 2.31419], recall= [ 0.00435  0.00957  0.01304  0.01326] , precision= [ 0.00522  0.00209  0.00139  0.00099] , auc=[0.50495], sum_recall=[0.04022]
Epoch 1 [38.6s + 10.4s]: train==[3.52850 = 1.21640 + 2.31211], recall= [ 0.02109  0.08399  0.13075  0.14635] , precision= [ 0.02348  0.01861  0.01461  0.01107] , auc=[0.69898], sum_recall=[0.38217]
Epoch 2 [38.7s + 10.2s]: train==[3.02195 = 0.71811 + 2.30384], recall= [ 0.02326  0.09514  0.15285  0.18716] , precision= [ 0.02696  0.02122  0.01696  0.01391] , auc=[0.76736], sum_recall=[0.45842]
Epoch 3 [38.8s + 11.0s]: train==[2.85149 = 0.55638 + 2.29511], recall= [ 0.02326  0.09391  0.16373  0.20092] , precision= [ 0.02696  0.02122  0.01843  0.01507] , auc=[0.78732], sum_recall=[0.48182]
Epoch 4 [38.7s + 12.0s]: train==[2.73121 = 0.44324 + 2.28797], recall= [ 0.02109  0.09783  0.16408  0.20466] , precision= [ 0.02522  0.02191  0.01861  0.01542] , auc=[0.79442], sum_recall=[0.48766]
Epoch 5 [38.9s + 11.3s]: train==[2.68139 = 0.39833 + 2.28307], recall= [ 0.02239  0.09837  0.16389  0.21068] , precision= [ 0.02609  0.02243  0.01878  0.01583] , auc=[0.79923], sum_recall=[0.49533]
Epoch 6 [38.8s + 12.2s]: train==[2.64772 = 0.36732 + 2.28040], recall= [ 0.02152  0.10329  0.16239  0.20506] , precision= [ 0.02522  0.02383  0.01852  0.01536] , auc=[0.80290], sum_recall=[0.49226]
Epoch 7 [38.7s + 12.2s]: train==[2.61514 = 0.33560 + 2.27954], recall= [ 0.01804  0.10662  0.16427  0.21042] , precision= [ 0.02174  0.02452  0.01878  0.01583] , auc=[0.80533], sum_recall=[0.49936]
Epoch 8 [39.1s + 11.7s]: train==[2.59407 = 0.31437 + 2.27970], recall= [ 0.01891  0.10390  0.16587  0.20955] , precision= [ 0.02261  0.02400  0.01887  0.01577] , auc=[0.80776], sum_recall=[0.49823]
Epoch 9 [39.0s + 11.8s]: train==[2.57625 = 0.29650 + 2.27975], recall= [ 0.01935  0.10368  0.16601  0.21332] , precision= [ 0.02348  0.02365  0.01878  0.01606] , auc=[0.80963], sum_recall=[0.50236]
Epoch 10 [38.8s + 12.5s]: train==[2.56269 = 0.28384 + 2.27884], recall= [ 0.01630  0.10107  0.16812  0.21201] , precision= [ 0.02000  0.02313  0.01904  0.01594] , auc=[0.81151], sum_recall=[0.49751]
Epoch 11 [39.1s + 11.8s]: train==[2.55376 = 0.27739 + 2.27636], recall= [ 0.01761  0.10194  0.16609  0.21479] , precision= [ 0.02174  0.02330  0.01887  0.01629] , auc=[0.81362], sum_recall=[0.50043]
Epoch 12 [38.9s + 11.4s]: train==[2.53281 = 0.26048 + 2.27234], recall= [ 0.01848  0.10281  0.16522  0.21803] , precision= [ 0.02261  0.02348  0.01878  0.01652] , auc=[0.81587], sum_recall=[0.50454]
Epoch 13 [39.0s + 12.2s]: train==[2.51485 = 0.24766 + 2.26719], recall= [ 0.01913  0.10107  0.16826  0.22107] , precision= [ 0.02261  0.02313  0.01913  0.01670] , auc=[0.81814], sum_recall=[0.50954]
Epoch 14 [38.9s + 11.5s]: train==[2.50013 = 0.23840 + 2.26173], recall= [ 0.01942  0.10281  0.16565  0.21861] , precision= [ 0.02348  0.02348  0.01887  0.01652] , auc=[0.82057], sum_recall=[0.50650]
Epoch 15 [38.8s + 11.4s]: train==[2.49114 = 0.23461 + 2.25653], recall= [ 0.02072  0.10426  0.16957  0.21687] , precision= [ 0.02435  0.02365  0.01930  0.01646] , auc=[0.82259], sum_recall=[0.51143]
Epoch 16 [39.0s + 12.6s]: train==[2.47826 = 0.22625 + 2.25201], recall= [ 0.01986  0.10676  0.17189  0.21687] , precision= [ 0.02348  0.02400  0.01965  0.01646] , auc=[0.82425], sum_recall=[0.51537]
Epoch 17 [38.9s + 11.5s]: train==[2.46725 = 0.21922 + 2.24803], recall= [ 0.01986  0.10763  0.17218  0.21905] , precision= [ 0.02348  0.02417  0.01974  0.01658] , auc=[0.82551], sum_recall=[0.51871]
Epoch 18 [38.8s + 11.5s]: train==[2.46396 = 0.21956 + 2.24440], recall= [ 0.02116  0.10850  0.17305  0.21905] , precision= [ 0.02435  0.02452  0.01983  0.01658] , auc=[0.82642], sum_recall=[0.52175]
Epoch 19 [38.9s + 12.8s]: train==[2.44595 = 0.20485 + 2.24110], recall= [ 0.02203  0.10792  0.17539  0.21919] , precision= [ 0.02522  0.02452  0.02017  0.01658] , auc=[0.82705], sum_recall=[0.52453]
Epoch 20 [39.5s + 12.7s]: train==[2.44322 = 0.20520 + 2.23802], recall= [ 0.02377  0.10792  0.17539  0.21731] , precision= [ 0.02696  0.02452  0.02017  0.01641] , auc=[0.82759], sum_recall=[0.52439]
Epoch 21 [39.0s + 12.0s]: train==[2.43477 = 0.19943 + 2.23534], recall= [ 0.02377  0.10807  0.17539  0.21479] , precision= [ 0.02696  0.02470  0.02017  0.01629] , auc=[0.82794], sum_recall=[0.52202]
Epoch 22 [39.1s + 12.2s]: train==[2.42667 = 0.19360 + 2.23306], recall= [ 0.02377  0.10977  0.17636  0.21487] , precision= [ 0.02696  0.02504  0.02035  0.01641] , auc=[0.82807], sum_recall=[0.52476]
Epoch 23 [38.9s + 12.3s]: train==[2.41869 = 0.18735 + 2.23134], recall= [ 0.02420  0.11148  0.17607  0.21487] , precision= [ 0.02783  0.02539  0.02026  0.01641] , auc=[0.82802], sum_recall=[0.52662]
Epoch 24 [38.9s + 11.7s]: train==[2.41006 = 0.18018 + 2.22988], recall= [ 0.02246  0.11278  0.17576  0.21704] , precision= [ 0.02609  0.02574  0.02009  0.01658] , auc=[0.82796], sum_recall=[0.52804]
Epoch 25 [38.8s + 12.0s]: train==[2.40716 = 0.17854 + 2.22863], recall= [ 0.02246  0.11430  0.17576  0.21675] , precision= [ 0.02609  0.02591  0.02009  0.01652] , auc=[0.82804], sum_recall=[0.52928]
Epoch 26 [39.2s + 11.5s]: train==[2.40557 = 0.17824 + 2.22733], recall= [ 0.02333  0.11674  0.17423  0.22095] , precision= [ 0.02696  0.02626  0.02000  0.01687] , auc=[0.82822], sum_recall=[0.53526]
Epoch 27 [38.9s + 11.9s]: train==[2.39702 = 0.17093 + 2.22609], recall= [ 0.02420  0.11326  0.17684  0.22008] , precision= [ 0.02783  0.02557  0.02026  0.01681] , auc=[0.82835], sum_recall=[0.53439]
Epoch 28 [38.7s + 12.0s]: train==[2.39146 = 0.16640 + 2.22506], recall= [ 0.02594  0.11239  0.17858  0.22139] , precision= [ 0.02957  0.02539  0.02043  0.01693] , auc=[0.82837], sum_recall=[0.53830]
Epoch 29 [38.9s + 11.8s]: train==[2.38552 = 0.16136 + 2.22416], recall= [ 0.02594  0.11239  0.17858  0.21878] , precision= [ 0.02957  0.02539  0.02052  0.01675] , auc=[0.82817], sum_recall=[0.53570]
Epoch 30 [38.9s + 11.8s]: train==[2.38408 = 0.16041 + 2.22367], recall= [ 0.02594  0.11297  0.17648  0.21921] , precision= [ 0.02957  0.02557  0.02035  0.01675] , auc=[0.82802], sum_recall=[0.53461]
Epoch 31 [39.0s + 12.2s]: train==[2.38079 = 0.15742 + 2.22337], recall= [ 0.02507  0.11481  0.17445  0.22093] , precision= [ 0.02870  0.02609  0.02000  0.01687] , auc=[0.82774], sum_recall=[0.53526]
Epoch 32 [38.7s + 12.6s]: train==[2.37424 = 0.15103 + 2.22321], recall= [ 0.02681  0.11350  0.17358  0.21987] , precision= [ 0.03043  0.02574  0.01991  0.01687] , auc=[0.82757], sum_recall=[0.53376]
Epoch 33 [39.2s + 12.4s]: train==[2.37497 = 0.15193 + 2.22304], recall= [ 0.02681  0.11274  0.17141  0.22074] , precision= [ 0.03043  0.02574  0.01974  0.01693] , auc=[0.82745], sum_recall=[0.53170]
Epoch 34 [39.3s + 12.3s]: train==[2.36700 = 0.14421 + 2.22279], recall= [ 0.02754  0.11134  0.17010  0.21711] , precision= [ 0.03043  0.02522  0.01965  0.01664] , auc=[0.82741], sum_recall=[0.52609]
Epoch 35 [42.1s + 12.2s]: train==[2.37091 = 0.14843 + 2.22248], recall= [ 0.02841  0.11033  0.16952  0.21750] , precision= [ 0.03130  0.02487  0.01965  0.01652] , auc=[0.82732], sum_recall=[0.52575]
Epoch 36 [41.2s + 12.7s]: train==[2.36921 = 0.14709 + 2.22211], recall= [ 0.02928  0.10946  0.16952  0.21576] , precision= [ 0.03217  0.02470  0.01965  0.01641] , auc=[0.82708], sum_recall=[0.52401]
Epoch 37 [39.1s + 11.9s]: train==[2.35898 = 0.13738 + 2.22160], recall= [ 0.02928  0.10955  0.17022  0.21382] , precision= [ 0.03217  0.02487  0.01965  0.01629] , auc=[0.82696], sum_recall=[0.52287]
Epoch 38 [38.9s + 13.1s]: train==[2.35282 = 0.13221 + 2.22061], recall= [ 0.02928  0.10738  0.17196  0.21387] , precision= [ 0.03217  0.02417  0.01983  0.01629] , auc=[0.82690], sum_recall=[0.52249]
End of trainning! Best recall= [ 0.02594  0.11239  0.17858  0.22139] , precision= [ 0.02957  0.02539  0.02043  0.01693] , auc=[0.82837]
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross0', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-23 16:36:16
loading data...
[n_users, n_items]=[3209, 12211]
[n_train, n_test]=[2636, 1318]
[n_edges]=[285362]
Using GPU 3,  memory_free: 24265
tensor([0.0049, 0.0335, 0.0388, 0.0134, 0.0121], device='cuda:3')
Loading Model..Number of Model Parameters:  3324802
Epoch 0 [39.1s + 11.2s]: train==[5.15179 = 2.83392 + 2.31786], recall= [ 0.00370  0.00717  0.01109  0.01391] , precision= [ 0.00435  0.00157  0.00122  0.00104] , auc=[0.52477], sum_recall=[0.03587]
Epoch 1 [39.6s + 11.1s]: train==[3.57216 = 1.25599 + 2.31617], recall= [ 0.01645  0.07547  0.11505  0.13717] , precision= [ 0.01913  0.01704  0.01304  0.01032] , auc=[0.69381], sum_recall=[0.34414]
Epoch 2 [39.3s + 10.4s]: train==[3.07291 = 0.76605 + 2.30685], recall= [ 0.01920  0.09170  0.15278  0.19081] , precision= [ 0.02261  0.02052  0.01713  0.01443] , auc=[0.76365], sum_recall=[0.45450]
Epoch 3 [39.7s + 14.2s]: train==[2.88184 = 0.58529 + 2.29655], recall= [ 0.02105  0.09311  0.16747  0.20802] , precision= [ 0.02522  0.02139  0.01896  0.01559] , auc=[0.78533], sum_recall=[0.48965]
Epoch 4 [39.3s + 13.2s]: train==[2.75594 = 0.46825 + 2.28770], recall= [ 0.02453  0.09176  0.16353  0.20783] , precision= [ 0.02870  0.02122  0.01843  0.01559] , auc=[0.79356], sum_recall=[0.48764]
Epoch 5 [40.0s + 13.4s]: train==[2.70585 = 0.42475 + 2.28110], recall= [ 0.02192  0.09168  0.16997  0.21087] , precision= [ 0.02609  0.02157  0.01930  0.01583] , auc=[0.79859], sum_recall=[0.49445]
Epoch 6 [39.9s + 13.5s]: train==[2.66475 = 0.38782 + 2.27693], recall= [ 0.02366  0.09371  0.16943  0.21189] , precision= [ 0.02783  0.02209  0.01913  0.01594] , auc=[0.80262], sum_recall=[0.49869]
Epoch 7 [39.6s + 13.0s]: train==[2.62643 = 0.35165 + 2.27478], recall= [ 0.02105  0.09589  0.17026  0.21363] , precision= [ 0.02522  0.02243  0.01957  0.01612] , auc=[0.80588], sum_recall=[0.50083]
Epoch 8 [39.3s + 13.4s]: train==[2.60368 = 0.32967 + 2.27401], recall= [ 0.02192  0.09644  0.17186  0.21358] , precision= [ 0.02696  0.02226  0.01974  0.01623] , auc=[0.80891], sum_recall=[0.50380]
Epoch 9 [39.6s + 15.4s]: train==[2.57744 = 0.30385 + 2.27359], recall= [ 0.02453  0.09862  0.17070  0.21421] , precision= [ 0.02957  0.02278  0.01965  0.01617] , auc=[0.81134], sum_recall=[0.50805]
Epoch 10 [39.3s + 13.1s]: train==[2.57043 = 0.29761 + 2.27282], recall= [ 0.02141  0.10166  0.16973  0.21623] , precision= [ 0.02522  0.02348  0.01948  0.01641] , auc=[0.81345], sum_recall=[0.50903]
Epoch 11 [39.2s + 12.6s]: train==[2.55041 = 0.27938 + 2.27102], recall= [ 0.02228  0.10409  0.16936  0.21657] , precision= [ 0.02609  0.02383  0.01939  0.01635] , auc=[0.81576], sum_recall=[0.51230]
Epoch 12 [40.2s + 13.2s]: train==[2.53828 = 0.27022 + 2.26805], recall= [ 0.02112  0.10630  0.17022  0.21410] , precision= [ 0.02609  0.02452  0.01948  0.01617] , auc=[0.81761], sum_recall=[0.51175]
Epoch 13 [39.9s + 13.3s]: train==[2.51516 = 0.25121 + 2.26395], recall= [ 0.02069  0.10699  0.17109  0.21497] , precision= [ 0.02522  0.02452  0.01957  0.01623] , auc=[0.81936], sum_recall=[0.51375]
Epoch 14 [40.3s + 13.5s]: train==[2.50292 = 0.24379 + 2.25912], recall= [ 0.02054  0.10395  0.17022  0.21367] , precision= [ 0.02435  0.02383  0.01948  0.01612] , auc=[0.82105], sum_recall=[0.50838]
Epoch 15 [40.0s + 13.1s]: train==[2.49522 = 0.24093 + 2.25430], recall= [ 0.02156  0.10569  0.17022  0.21338] , precision= [ 0.02609  0.02417  0.01948  0.01612] , auc=[0.82258], sum_recall=[0.51085]
Epoch 16 [39.5s + 13.3s]: train==[2.47899 = 0.22918 + 2.24982], recall= [ 0.02330  0.10656  0.17109  0.21294] , precision= [ 0.02783  0.02435  0.01957  0.01606] , auc=[0.82388], sum_recall=[0.51389]
Epoch 17 [40.2s + 12.5s]: train==[2.46653 = 0.22078 + 2.24575], recall= [ 0.02330  0.10699  0.17196  0.21555] , precision= [ 0.02783  0.02435  0.01965  0.01629] , auc=[0.82494], sum_recall=[0.51780]
Epoch 18 [39.7s + 14.3s]: train==[2.46467 = 0.22245 + 2.24222], recall= [ 0.02243  0.10612  0.17472  0.21434] , precision= [ 0.02696  0.02417  0.02009  0.01629] , auc=[0.82565], sum_recall=[0.51761]
Epoch 19 [39.9s + 13.9s]: train==[2.44476 = 0.20577 + 2.23899], recall= [ 0.02315  0.10760  0.17124  0.21608] , precision= [ 0.02696  0.02470  0.01974  0.01641] , auc=[0.82607], sum_recall=[0.51807]
Epoch 20 [41.5s + 17.2s]: train==[2.44272 = 0.20670 + 2.23602], recall= [ 0.02228  0.10630  0.17196  0.21420] , precision= [ 0.02609  0.02435  0.01974  0.01623] , auc=[0.82656], sum_recall=[0.51474]
Epoch 21 [39.4s + 12.5s]: train==[2.43285 = 0.19936 + 2.23349], recall= [ 0.02344  0.10510  0.17399  0.21550] , precision= [ 0.02783  0.02435  0.02000  0.01635] , auc=[0.82691], sum_recall=[0.51804]
Epoch 22 [39.8s + 13.0s]: train==[2.42391 = 0.19259 + 2.23132], recall= [ 0.02344  0.10467  0.17486  0.21560] , precision= [ 0.02783  0.02417  0.02009  0.01641] , auc=[0.82701], sum_recall=[0.51857]
Epoch 23 [39.8s + 12.8s]: train==[2.41987 = 0.19022 + 2.22965], recall= [ 0.02562  0.10594  0.17530  0.21473] , precision= [ 0.03043  0.02417  0.02009  0.01635] , auc=[0.82696], sum_recall=[0.52158]
Epoch 24 [40.7s + 13.7s]: train==[2.41350 = 0.18516 + 2.22834], recall= [ 0.02562  0.10768  0.17638  0.21481] , precision= [ 0.03043  0.02452  0.02017  0.01635] , auc=[0.82703], sum_recall=[0.52449]
Epoch 25 [39.6s + 13.4s]: train==[2.40719 = 0.17985 + 2.22734], recall= [ 0.02562  0.10916  0.17518  0.21568] , precision= [ 0.03043  0.02504  0.02017  0.01641] , auc=[0.82731], sum_recall=[0.52563]
Epoch 26 [40.3s + 13.4s]: train==[2.40852 = 0.18211 + 2.22641], recall= [ 0.02475  0.10916  0.17692  0.21742] , precision= [ 0.02957  0.02504  0.02035  0.01652] , auc=[0.82749], sum_recall=[0.52824]
Epoch 27 [39.6s + 13.1s]: train==[2.40073 = 0.17518 + 2.22555], recall= [ 0.02475  0.10916  0.17709  0.21611] , precision= [ 0.02957  0.02504  0.02043  0.01646] , auc=[0.82767], sum_recall=[0.52711]
Epoch 28 [40.5s + 13.4s]: train==[2.39480 = 0.17002 + 2.22477], recall= [ 0.02388  0.10829  0.17622  0.21655] , precision= [ 0.02870  0.02487  0.02035  0.01646] , auc=[0.82793], sum_recall=[0.52493]
Epoch 29 [39.5s + 13.4s]: train==[2.38736 = 0.16340 + 2.22396], recall= [ 0.02475  0.10720  0.17709  0.21742] , precision= [ 0.02957  0.02435  0.02043  0.01652] , auc=[0.82789], sum_recall=[0.52645]
Epoch 30 [39.8s + 12.6s]: train==[2.38762 = 0.16414 + 2.22348], recall= [ 0.02475  0.10633  0.17665  0.21742] , precision= [ 0.02957  0.02417  0.02043  0.01652] , auc=[0.82775], sum_recall=[0.52515]
Epoch 31 [39.1s + 13.0s]: train==[2.38198 = 0.15887 + 2.22311], recall= [ 0.02475  0.10720  0.17492  0.22035] , precision= [ 0.02957  0.02435  0.02026  0.01670] , auc=[0.82760], sum_recall=[0.52721]
Epoch 32 [39.3s + 13.6s]: train==[2.37667 = 0.15374 + 2.22292], recall= [ 0.02562  0.10851  0.17318  0.22296] , precision= [ 0.03043  0.02470  0.02009  0.01687] , auc=[0.82735], sum_recall=[0.53026]
Epoch 33 [39.4s + 12.9s]: train==[2.37720 = 0.15441 + 2.22279], recall= [ 0.02562  0.11025  0.17354  0.22252] , precision= [ 0.03043  0.02504  0.02000  0.01687] , auc=[0.82715], sum_recall=[0.53193]
Epoch 34 [39.7s + 12.7s]: train==[2.36996 = 0.14730 + 2.22266], recall= [ 0.02649  0.10938  0.17267  0.22165] , precision= [ 0.03130  0.02487  0.01991  0.01681] , auc=[0.82705], sum_recall=[0.53019]
Epoch 35 [39.0s + 14.2s]: train==[2.37201 = 0.14951 + 2.22250], recall= [ 0.02562  0.10862  0.17528  0.22165] , precision= [ 0.03043  0.02487  0.02017  0.01681] , auc=[0.82704], sum_recall=[0.53116]
Epoch 36 [39.4s + 12.4s]: train==[2.37211 = 0.14979 + 2.22232], recall= [ 0.02649  0.10862  0.17528  0.22325] , precision= [ 0.03130  0.02487  0.02017  0.01699] , auc=[0.82715], sum_recall=[0.53363]
Epoch 37 [39.7s + 13.2s]: train==[2.35956 = 0.13746 + 2.22210], recall= [ 0.02634  0.11036  0.17728  0.22136] , precision= [ 0.03043  0.02522  0.02035  0.01687] , auc=[0.82747], sum_recall=[0.53534]
Epoch 38 [39.5s + 13.5s]: train==[2.35608 = 0.13443 + 2.22165], recall= [ 0.02721  0.10905  0.17884  0.22122] , precision= [ 0.03130  0.02504  0.02043  0.01687] , auc=[0.82779], sum_recall=[0.53632]
End of trainning! Best recall= [ 0.02388  0.10829  0.17622  0.21655] , precision= [ 0.02870  0.02487  0.02035  0.01646] , auc=[0.82793]
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross0', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-23 17:10:57
loading data...
[n_users, n_items]=[3209, 12211]
[n_train, n_test]=[2636, 1318]
[n_edges]=[285362]
Using GPU 3,  memory_free: 24265
tensor([ 0.0414,  0.0141,  0.0164,  0.0134, -0.0146], device='cuda:3')
Loading Model..Number of Model Parameters:  3324802
Epoch 0 [39.1s + 10.8s]: train==[5.15455 = 2.83985 + 2.31471], recall= [ 0.00630  0.01391  0.01652  0.01739] , precision= [ 0.00696  0.00313  0.00183  0.00128] , auc=[0.51339], sum_recall=[0.05413]
Epoch 1 [39.2s + 10.9s]: train==[3.51512 = 1.20292 + 2.31221], recall= [ 0.02022  0.07457  0.11408  0.13798] , precision= [ 0.02174  0.01652  0.01270  0.01020] , auc=[0.70488], sum_recall=[0.34685]
Epoch 2 [39.4s + 16.0s]: train==[3.00985 = 0.70583 + 2.30402], recall= [ 0.02268  0.08982  0.15137  0.18544] , precision= [ 0.02522  0.02052  0.01687  0.01386] , auc=[0.77069], sum_recall=[0.44931]
Epoch 3 [40.0s + 13.0s]: train==[2.83965 = 0.54386 + 2.29578], recall= [ 0.02370  0.09289  0.16263  0.19900] , precision= [ 0.02696  0.02122  0.01826  0.01478] , auc=[0.79084], sum_recall=[0.47821]
Epoch 4 [39.1s + 12.9s]: train==[2.72618 = 0.43696 + 2.28923], recall= [ 0.02561  0.08821  0.16164  0.20076] , precision= [ 0.02957  0.02035  0.01809  0.01496] , auc=[0.79951], sum_recall=[0.47622]
Epoch 5 [39.0s + 12.5s]: train==[2.67200 = 0.38721 + 2.28478], recall= [ 0.02300  0.08753  0.16671  0.20526] , precision= [ 0.02696  0.02017  0.01861  0.01525] , auc=[0.80496], sum_recall=[0.48250]
Epoch 6 [39.0s + 12.8s]: train==[2.64176 = 0.35939 + 2.28237], recall= [ 0.02152  0.09014  0.16845  0.20627] , precision= [ 0.02435  0.02070  0.01878  0.01536] , auc=[0.80904], sum_recall=[0.48638]
Epoch 7 [38.9s + 12.9s]: train==[2.61225 = 0.33071 + 2.28154], recall= [ 0.02257  0.08869  0.17227  0.20696] , precision= [ 0.02696  0.02052  0.01904  0.01542] , auc=[0.81190], sum_recall=[0.49048]
Epoch 8 [39.2s + 12.4s]: train==[2.59770 = 0.31619 + 2.28151], recall= [ 0.02126  0.08514  0.16705  0.20841] , precision= [ 0.02522  0.01965  0.01852  0.01559] , auc=[0.81442], sum_recall=[0.48186]
Epoch 9 [39.4s + 13.0s]: train==[2.57380 = 0.29272 + 2.28109], recall= [ 0.02109  0.08905  0.16705  0.20884] , precision= [ 0.02435  0.02035  0.01852  0.01571] , auc=[0.81639], sum_recall=[0.48603]
Epoch 10 [39.2s + 13.0s]: train==[2.56332 = 0.28378 + 2.27954], recall= [ 0.02000  0.09079  0.16096  0.20850] , precision= [ 0.02261  0.02070  0.01791  0.01571] , auc=[0.81837], sum_recall=[0.48026]
Epoch 11 [39.1s + 12.3s]: train==[2.54781 = 0.27143 + 2.27637], recall= [ 0.01913  0.09325  0.16128  0.21042] , precision= [ 0.02174  0.02122  0.01809  0.01588] , auc=[0.82069], sum_recall=[0.48408]
Epoch 12 [39.2s + 13.2s]: train==[2.53533 = 0.26360 + 2.27173], recall= [ 0.01913  0.09238  0.16462  0.21042] , precision= [ 0.02174  0.02104  0.01852  0.01588] , auc=[0.82299], sum_recall=[0.48655]
Epoch 13 [39.0s + 12.8s]: train==[2.51356 = 0.24745 + 2.26611], recall= [ 0.02000  0.09470  0.16471  0.21042] , precision= [ 0.02261  0.02139  0.01861  0.01588] , auc=[0.82523], sum_recall=[0.48983]
Epoch 14 [39.3s + 12.6s]: train==[2.50015 = 0.23990 + 2.26025], recall= [ 0.01913  0.09746  0.16558  0.21155] , precision= [ 0.02174  0.02209  0.01870  0.01594] , auc=[0.82747], sum_recall=[0.49372]
Epoch 15 [39.3s + 12.3s]: train==[2.49211 = 0.23735 + 2.25476], recall= [ 0.02046  0.09702  0.16720  0.21227] , precision= [ 0.02435  0.02209  0.01887  0.01606] , auc=[0.82936], sum_recall=[0.49696]
Epoch 16 [39.1s + 13.5s]: train==[2.47861 = 0.22857 + 2.25004], recall= [ 0.02133  0.09615  0.16833  0.21372] , precision= [ 0.02522  0.02191  0.01896  0.01612] , auc=[0.83078], sum_recall=[0.49954]
Epoch 17 [39.4s + 13.1s]: train==[2.46561 = 0.21973 + 2.24588], recall= [ 0.02046  0.10103  0.16920  0.21708] , precision= [ 0.02435  0.02313  0.01904  0.01635] , auc=[0.83187], sum_recall=[0.50778]
Epoch 18 [39.1s + 13.1s]: train==[2.46367 = 0.22142 + 2.24225], recall= [ 0.02127  0.10364  0.16659  0.21636] , precision= [ 0.02522  0.02365  0.01878  0.01623] , auc=[0.83270], sum_recall=[0.50786]
Epoch 19 [39.2s + 13.6s]: train==[2.44522 = 0.20619 + 2.23903], recall= [ 0.02231  0.10603  0.16981  0.21578] , precision= [ 0.02696  0.02400  0.01922  0.01623] , auc=[0.83330], sum_recall=[0.51393]
Epoch 20 [39.9s + 13.0s]: train==[2.44273 = 0.20658 + 2.23615], recall= [ 0.02127  0.10255  0.16981  0.21987] , precision= [ 0.02522  0.02330  0.01922  0.01658] , auc=[0.83381], sum_recall=[0.51350]
Epoch 21 [39.2s + 12.9s]: train==[2.43335 = 0.19955 + 2.23380], recall= [ 0.02214  0.10313  0.16894  0.22074] , precision= [ 0.02609  0.02330  0.01913  0.01664] , auc=[0.83416], sum_recall=[0.51495]
Epoch 22 [39.2s + 19.8s]: train==[2.42672 = 0.19488 + 2.23184], recall= [ 0.02127  0.10473  0.17085  0.21987] , precision= [ 0.02522  0.02383  0.01939  0.01658] , auc=[0.83431], sum_recall=[0.51671]
Epoch 23 [39.1s + 12.6s]: train==[2.41690 = 0.18656 + 2.23034], recall= [ 0.02127  0.10806  0.16911  0.21726] , precision= [ 0.02522  0.02435  0.01922  0.01641] , auc=[0.83427], sum_recall=[0.51570]
Epoch 24 [42.2s + 13.0s]: train==[2.41058 = 0.18151 + 2.22907], recall= [ 0.02214  0.10719  0.17259  0.21929] , precision= [ 0.02609  0.02417  0.01957  0.01658] , auc=[0.83421], sum_recall=[0.52121]
Epoch 25 [39.5s + 13.0s]: train==[2.40454 = 0.17652 + 2.22801], recall= [ 0.02112  0.10661  0.17444  0.21639] , precision= [ 0.02435  0.02417  0.01983  0.01635] , auc=[0.83424], sum_recall=[0.51856]
Epoch 26 [44.3s + 13.7s]: train==[2.40297 = 0.17600 + 2.22697], recall= [ 0.02112  0.10748  0.17357  0.21726] , precision= [ 0.02435  0.02435  0.01974  0.01641] , auc=[0.83412], sum_recall=[0.51943]
Epoch 27 [42.4s + 12.8s]: train==[2.39618 = 0.17015 + 2.22603], recall= [ 0.02112  0.10690  0.17386  0.21777] , precision= [ 0.02435  0.02435  0.01983  0.01652] , auc=[0.83406], sum_recall=[0.51965]
Epoch 28 [40.3s + 13.0s]: train==[2.39080 = 0.16546 + 2.22535], recall= [ 0.02112  0.10980  0.17194  0.21777] , precision= [ 0.02435  0.02504  0.01965  0.01652] , auc=[0.83395], sum_recall=[0.52063]
Epoch 29 [39.2s + 12.9s]: train==[2.38474 = 0.15996 + 2.22479], recall= [ 0.02199  0.10919  0.17172  0.21958] , precision= [ 0.02522  0.02470  0.01957  0.01664] , auc=[0.83354], sum_recall=[0.52248]
Epoch 30 [39.1s + 12.1s]: train==[2.38282 = 0.15835 + 2.22447], recall= [ 0.02112  0.11006  0.17172  0.21849] , precision= [ 0.02522  0.02487  0.01957  0.01652] , auc=[0.83314], sum_recall=[0.52140]
Epoch 31 [43.6s + 12.3s]: train==[2.38032 = 0.15606 + 2.22426], recall= [ 0.02286  0.10936  0.17346  0.21728] , precision= [ 0.02696  0.02487  0.01974  0.01652] , auc=[0.83254], sum_recall=[0.52297]
Epoch 32 [39.4s + 13.3s]: train==[2.37562 = 0.15158 + 2.22404], recall= [ 0.02286  0.10719  0.17250  0.21738] , precision= [ 0.02696  0.02435  0.01957  0.01658] , auc=[0.83205], sum_recall=[0.51993]
End of trainning! Best recall= [ 0.02127  0.10473  0.17085  0.21987] , precision= [ 0.02522  0.02383  0.01939  0.01658] , auc=[0.83431]
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross0', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-23 17:40:08
loading data...
[n_users, n_items]=[3209, 12211]
[n_train, n_test]=[2636, 1318]
[n_edges]=[285362]
Using GPU 3,  memory_free: 24265
tensor([ 0.0242,  0.0205, -0.0254,  0.0101,  0.0386], device='cuda:3')
Loading Model..Number of Model Parameters:  3324802
Epoch 0 [40.3s + 10.5s]: train==[5.15494 = 2.83905 + 2.31589], recall= [ 0.00283  0.01022  0.01072  0.01507] , precision= [ 0.00348  0.00226  0.00130  0.00116] , auc=[0.51636], sum_recall=[0.03884]
Epoch 1 [38.9s + 10.0s]: train==[3.59329 = 1.27933 + 2.31396], recall= [ 0.01609  0.07209  0.12440  0.15077] , precision= [ 0.01913  0.01635  0.01391  0.01125] , auc=[0.69530], sum_recall=[0.36335]
Epoch 2 [41.0s + 10.3s]: train==[3.07177 = 0.76713 + 2.30463], recall= [ 0.01891  0.09208  0.14994  0.19232] , precision= [ 0.02261  0.02070  0.01696  0.01432] , auc=[0.76104], sum_recall=[0.45326]
Epoch 3 [38.7s + 11.7s]: train==[2.88731 = 0.59310 + 2.29421], recall= [ 0.02225  0.10520  0.17207  0.20254] , precision= [ 0.02696  0.02400  0.01948  0.01519] , auc=[0.78217], sum_recall=[0.50206]
Epoch 4 [38.5s + 11.6s]: train==[2.76637 = 0.48125 + 2.28513], recall= [ 0.02268  0.09802  0.17791  0.20890] , precision= [ 0.02696  0.02261  0.02009  0.01571] , auc=[0.78881], sum_recall=[0.50751]
Epoch 5 [38.8s + 11.5s]: train==[2.69995 = 0.42162 + 2.27833], recall= [ 0.02698  0.09955  0.17298  0.20979] , precision= [ 0.03217  0.02278  0.01965  0.01583] , auc=[0.79417], sum_recall=[0.50930]
Epoch 6 [38.7s + 11.8s]: train==[2.66488 = 0.39083 + 2.27405], recall= [ 0.02611  0.10157  0.17151  0.20849] , precision= [ 0.03130  0.02330  0.01965  0.01577] , auc=[0.79838], sum_recall=[0.50769]
Epoch 7 [38.9s + 12.2s]: train==[2.62356 = 0.35162 + 2.27193], recall= [ 0.02486  0.10092  0.17047  0.20675] , precision= [ 0.02870  0.02296  0.01948  0.01565] , auc=[0.80217], sum_recall=[0.50300]
Epoch 8 [38.7s + 11.5s]: train==[2.60292 = 0.33154 + 2.27139], recall= [ 0.02616  0.10175  0.17232  0.20817] , precision= [ 0.03043  0.02313  0.01974  0.01577] , auc=[0.80542], sum_recall=[0.50840]
Epoch 9 [45.8s + 11.3s]: train==[2.57756 = 0.30610 + 2.27146], recall= [ 0.02355  0.10244  0.17575  0.21049] , precision= [ 0.02783  0.02365  0.02009  0.01600] , auc=[0.80798], sum_recall=[0.51223]
Epoch 10 [38.8s + 12.0s]: train==[2.56568 = 0.29414 + 2.27154], recall= [ 0.02399  0.10017  0.17522  0.21027] , precision= [ 0.02870  0.02296  0.02000  0.01594] , auc=[0.81063], sum_recall=[0.50964]
Epoch 11 [38.9s + 15.7s]: train==[2.55357 = 0.28279 + 2.27078], recall= [ 0.02268  0.10075  0.17435  0.21307] , precision= [ 0.02696  0.02296  0.01991  0.01612] , auc=[0.81326], sum_recall=[0.51085]
Epoch 12 [38.6s + 11.4s]: train==[2.54036 = 0.27132 + 2.26905], recall= [ 0.02355  0.10249  0.17367  0.21554] , precision= [ 0.02783  0.02330  0.01983  0.01623] , auc=[0.81574], sum_recall=[0.51525]
Epoch 13 [38.6s + 12.0s]: train==[2.51832 = 0.25212 + 2.26620], recall= [ 0.02377  0.10386  0.17353  0.21510] , precision= [ 0.02783  0.02383  0.01974  0.01623] , auc=[0.81778], sum_recall=[0.51626]
Epoch 14 [38.7s + 11.2s]: train==[2.50412 = 0.24177 + 2.26235], recall= [ 0.02351  0.10691  0.16933  0.21508] , precision= [ 0.02783  0.02435  0.01913  0.01635] , auc=[0.81988], sum_recall=[0.51483]
Epoch 15 [38.5s + 11.3s]: train==[2.49914 = 0.24104 + 2.25809], recall= [ 0.02438  0.10517  0.17350  0.21552] , precision= [ 0.02870  0.02400  0.01974  0.01641] , auc=[0.82176], sum_recall=[0.51856]
Epoch 16 [38.6s + 12.0s]: train==[2.48418 = 0.23027 + 2.25392], recall= [ 0.02525  0.10444  0.17263  0.21335] , precision= [ 0.02957  0.02383  0.01965  0.01623] , auc=[0.82343], sum_recall=[0.51566]
Epoch 17 [38.7s + 11.7s]: train==[2.47275 = 0.22279 + 2.24996], recall= [ 0.02525  0.10731  0.17638  0.21421] , precision= [ 0.02957  0.02435  0.02017  0.01629] , auc=[0.82497], sum_recall=[0.52315]
Epoch 18 [38.7s + 11.0s]: train==[2.46998 = 0.22368 + 2.24629], recall= [ 0.02612  0.10731  0.17812  0.21755] , precision= [ 0.03043  0.02435  0.02035  0.01646] , auc=[0.82628], sum_recall=[0.52909]
Epoch 19 [38.6s + 12.2s]: train==[2.44936 = 0.20642 + 2.24294], recall= [ 0.02525  0.10905  0.17812  0.21755] , precision= [ 0.02957  0.02470  0.02035  0.01646] , auc=[0.82733], sum_recall=[0.52996]
Epoch 20 [38.7s + 11.6s]: train==[2.44590 = 0.20622 + 2.23968], recall= [ 0.02612  0.11209  0.17764  0.21740] , precision= [ 0.03043  0.02539  0.02026  0.01641] , auc=[0.82829], sum_recall=[0.53325]
Epoch 21 [38.8s + 11.3s]: train==[2.43648 = 0.19971 + 2.23677], recall= [ 0.02612  0.11383  0.17677  0.21958] , precision= [ 0.03043  0.02574  0.02017  0.01658] , auc=[0.82915], sum_recall=[0.53629]
Epoch 22 [38.6s + 12.2s]: train==[2.43036 = 0.19621 + 2.23415], recall= [ 0.02786  0.11383  0.17633  0.21871] , precision= [ 0.03217  0.02574  0.02009  0.01652] , auc=[0.82984], sum_recall=[0.53673]
Epoch 23 [40.6s + 11.7s]: train==[2.42099 = 0.18908 + 2.23190], recall= [ 0.02681  0.11586  0.17629  0.21914] , precision= [ 0.03043  0.02626  0.02009  0.01658] , auc=[0.83029], sum_recall=[0.53810]
Epoch 24 [38.8s + 11.4s]: train==[2.41452 = 0.18451 + 2.23001], recall= [ 0.02681  0.11847  0.17358  0.21610] , precision= [ 0.03043  0.02678  0.01974  0.01635] , auc=[0.83063], sum_recall=[0.53496]
Epoch 25 [38.5s + 11.6s]: train==[2.40819 = 0.17978 + 2.22841], recall= [ 0.02736  0.11847  0.17312  0.21871] , precision= [ 0.03217  0.02678  0.01965  0.01652] , auc=[0.83089], sum_recall=[0.53765]
Epoch 26 [38.6s + 11.7s]: train==[2.40980 = 0.18286 + 2.22694], recall= [ 0.02822  0.11732  0.17442  0.22122] , precision= [ 0.03304  0.02643  0.01974  0.01664] , auc=[0.83108], sum_recall=[0.54119]
Epoch 27 [38.7s + 11.1s]: train==[2.39948 = 0.17379 + 2.22569], recall= [ 0.03083  0.11688  0.17634  0.22035] , precision= [ 0.03565  0.02626  0.02000  0.01658] , auc=[0.83125], sum_recall=[0.54440]
Epoch 28 [38.5s + 11.3s]: train==[2.39624 = 0.17164 + 2.22460], recall= [ 0.03083  0.11793  0.17489  0.22383] , precision= [ 0.03565  0.02661  0.01991  0.01681] , auc=[0.83136], sum_recall=[0.54748]
Epoch 29 [38.8s + 12.0s]: train==[2.38886 = 0.16535 + 2.22352], recall= [ 0.03083  0.11532  0.17489  0.22470] , precision= [ 0.03565  0.02609  0.01991  0.01687] , auc=[0.83129], sum_recall=[0.54574]
Epoch 30 [39.0s + 11.4s]: train==[2.38817 = 0.16542 + 2.22274], recall= [ 0.02996  0.11532  0.17576  0.22557] , precision= [ 0.03478  0.02609  0.02000  0.01693] , auc=[0.83120], sum_recall=[0.54661]
Epoch 31 [38.6s + 12.0s]: train==[2.38532 = 0.16319 + 2.22213], recall= [ 0.02982  0.11488  0.17576  0.22487] , precision= [ 0.03391  0.02609  0.02000  0.01693] , auc=[0.83086], sum_recall=[0.54533]
Epoch 32 [39.1s + 11.9s]: train==[2.37713 = 0.15542 + 2.22172], recall= [ 0.03069  0.11575  0.17554  0.22540] , precision= [ 0.03478  0.02626  0.01991  0.01704] , auc=[0.83053], sum_recall=[0.54738]
Epoch 33 [38.7s + 11.3s]: train==[2.37745 = 0.15601 + 2.22144], recall= [ 0.03069  0.11575  0.17438  0.22770] , precision= [ 0.03478  0.02626  0.01974  0.01710] , auc=[0.83025], sum_recall=[0.54852]
Epoch 34 [38.7s + 11.3s]: train==[2.37197 = 0.15079 + 2.22117], recall= [ 0.03243  0.11413  0.17525  0.23045] , precision= [ 0.03652  0.02557  0.01983  0.01733] , auc=[0.82985], sum_recall=[0.55226]
Epoch 35 [42.1s + 12.2s]: train==[2.37169 = 0.15080 + 2.22090], recall= [ 0.03243  0.11442  0.17351  0.22763] , precision= [ 0.03652  0.02574  0.01965  0.01710] , auc=[0.82969], sum_recall=[0.54798]
Epoch 36 [39.0s + 11.0s]: train==[2.37130 = 0.15086 + 2.22044], recall= [ 0.03156  0.11383  0.17377  0.22936] , precision= [ 0.03565  0.02591  0.01965  0.01722] , auc=[0.82947], sum_recall=[0.54853]
Epoch 37 [39.0s + 11.5s]: train==[2.35812 = 0.13826 + 2.21986], recall= [ 0.03156  0.11383  0.17421  0.22950] , precision= [ 0.03565  0.02591  0.01974  0.01722] , auc=[0.82937], sum_recall=[0.54910]
Epoch 38 [38.7s + 12.4s]: train==[2.35445 = 0.13550 + 2.21895], recall= [ 0.03272  0.11253  0.17464  0.23025] , precision= [ 0.03739  0.02557  0.01974  0.01751] , auc=[0.82932], sum_recall=[0.55014]
End of trainning! Best recall= [ 0.03083  0.11793  0.17489  0.22383] , precision= [ 0.03565  0.02661  0.01991  0.01681] , auc=[0.83136]
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross0', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-23 18:13:16
loading data...
[n_users, n_items]=[3209, 12211]
[n_train, n_test]=[2636, 1318]
[n_edges]=[285362]
Using GPU 3,  memory_free: 24265
tensor([-0.0314, -0.0100, -0.0111, -0.0249,  0.0251], device='cuda:3')
Loading Model..Number of Model Parameters:  3324802
Epoch 0 [39.4s + 10.0s]: train==[5.17265 = 2.84872 + 2.32392], recall= [ 0.00543  0.01391  0.01391  0.01507] , precision= [ 0.00609  0.00313  0.00157  0.00116] , auc=[0.49859], sum_recall=[0.04833]
Epoch 1 [39.1s + 9.6s]: train==[3.60956 = 1.28812 + 2.32143], recall= [ 0.01399  0.08130  0.12778  0.14948] , precision= [ 0.01565  0.01809  0.01409  0.01101] , auc=[0.68532], sum_recall=[0.37255]
Epoch 2 [38.8s + 9.6s]: train==[3.06903 = 0.75726 + 2.31177], recall= [ 0.02094  0.08913  0.15086  0.19230] , precision= [ 0.02348  0.02017  0.01696  0.01443] , auc=[0.76509], sum_recall=[0.45324]
Epoch 3 [39.0s + 12.7s]: train==[2.88339 = 0.58226 + 2.30113], recall= [ 0.02761  0.10087  0.16680  0.20533] , precision= [ 0.03130  0.02278  0.01861  0.01536] , auc=[0.78763], sum_recall=[0.50061]
Epoch 4 [38.8s + 11.6s]: train==[2.77067 = 0.47885 + 2.29182], recall= [ 0.02616  0.09930  0.16519  0.20718] , precision= [ 0.03043  0.02261  0.01861  0.01559] , auc=[0.79560], sum_recall=[0.49783]
Epoch 5 [39.1s + 11.7s]: train==[2.70651 = 0.42183 + 2.28468], recall= [ 0.02529  0.09952  0.16486  0.21109] , precision= [ 0.02957  0.02278  0.01870  0.01594] , auc=[0.80163], sum_recall=[0.50077]
Epoch 6 [39.1s + 12.1s]: train==[2.66538 = 0.38534 + 2.28004], recall= [ 0.02312  0.09930  0.16921  0.21036] , precision= [ 0.02696  0.02243  0.01922  0.01594] , auc=[0.80594], sum_recall=[0.50200]
Epoch 7 [40.1s + 11.8s]: train==[2.63199 = 0.35431 + 2.27768], recall= [ 0.02268  0.10097  0.17182  0.20863] , precision= [ 0.02696  0.02278  0.01948  0.01583] , auc=[0.80926], sum_recall=[0.50410]
Epoch 8 [39.3s + 11.3s]: train==[2.60591 = 0.32890 + 2.27702], recall= [ 0.02138  0.10228  0.16747  0.20631] , precision= [ 0.02522  0.02296  0.01904  0.01559] , auc=[0.81215], sum_recall=[0.49743]
Epoch 9 [38.9s + 11.7s]: train==[2.57965 = 0.30257 + 2.27708], recall= [ 0.01899  0.10472  0.16776  0.20674] , precision= [ 0.02261  0.02383  0.01913  0.01565] , auc=[0.81443], sum_recall=[0.49821]
Epoch 10 [39.1s + 12.3s]: train==[2.57039 = 0.29336 + 2.27704], recall= [ 0.02003  0.10385  0.17037  0.21036] , precision= [ 0.02435  0.02365  0.01939  0.01594] , auc=[0.81655], sum_recall=[0.50462]
Epoch 11 [40.2s + 11.7s]: train==[2.55634 = 0.28036 + 2.27598], recall= [ 0.01786  0.10429  0.17247  0.21210] , precision= [ 0.02261  0.02383  0.01965  0.01606] , auc=[0.81839], sum_recall=[0.50672]
Epoch 12 [39.5s + 11.9s]: train==[2.54156 = 0.26792 + 2.27364], recall= [ 0.01786  0.10868  0.17073  0.21602] , precision= [ 0.02261  0.02470  0.01948  0.01635] , auc=[0.82010], sum_recall=[0.51329]
Epoch 13 [39.7s + 11.9s]: train==[2.52030 = 0.25046 + 2.26984], recall= [ 0.01786  0.10767  0.17128  0.21406] , precision= [ 0.02261  0.02470  0.01965  0.01617] , auc=[0.82150], sum_recall=[0.51086]
Epoch 14 [39.7s + 12.8s]: train==[2.50653 = 0.24154 + 2.26499], recall= [ 0.01829  0.11317  0.17175  0.21597] , precision= [ 0.02261  0.02591  0.01957  0.01635] , auc=[0.82329], sum_recall=[0.51919]
Epoch 15 [39.3s + 11.4s]: train==[2.50014 = 0.24039 + 2.25974], recall= [ 0.02003  0.11230  0.17153  0.21771] , precision= [ 0.02435  0.02574  0.01948  0.01652] , auc=[0.82510], sum_recall=[0.52158]
Epoch 16 [39.0s + 12.1s]: train==[2.48465 = 0.22999 + 2.25466], recall= [ 0.02003  0.11317  0.17175  0.21826] , precision= [ 0.02435  0.02591  0.01957  0.01658] , auc=[0.82651], sum_recall=[0.52321]
Epoch 17 [38.8s + 12.0s]: train==[2.47246 = 0.22250 + 2.24996], recall= [ 0.02090  0.11187  0.17238  0.21826] , precision= [ 0.02522  0.02557  0.01957  0.01658] , auc=[0.82763], sum_recall=[0.52340]
Epoch 18 [39.5s + 11.6s]: train==[2.46737 = 0.22153 + 2.24584], recall= [ 0.02003  0.11071  0.17284  0.21869] , precision= [ 0.02435  0.02522  0.01974  0.01664] , auc=[0.82851], sum_recall=[0.52227]
Epoch 19 [39.3s + 12.4s]: train==[2.45087 = 0.20880 + 2.24207], recall= [ 0.02072  0.10995  0.17544  0.21678] , precision= [ 0.02435  0.02522  0.02000  0.01641] , auc=[0.82910], sum_recall=[0.52290]
Epoch 20 [38.9s + 12.9s]: train==[2.44700 = 0.20849 + 2.23851], recall= [ 0.02072  0.11082  0.17357  0.21576] , precision= [ 0.02435  0.02539  0.01974  0.01629] , auc=[0.82960], sum_recall=[0.52088]
Epoch 21 [39.6s + 11.6s]: train==[2.43454 = 0.19917 + 2.23536], recall= [ 0.02116  0.11082  0.17444  0.21562] , precision= [ 0.02522  0.02539  0.01983  0.01623] , auc=[0.82994], sum_recall=[0.52204]
Epoch 22 [39.1s + 11.8s]: train==[2.42848 = 0.19585 + 2.23263], recall= [ 0.02203  0.11082  0.17401  0.21676] , precision= [ 0.02609  0.02539  0.01974  0.01641] , auc=[0.83006], sum_recall=[0.52361]
Epoch 23 [39.4s + 11.7s]: train==[2.42261 = 0.19213 + 2.23048], recall= [ 0.02203  0.11169  0.17150  0.21506] , precision= [ 0.02609  0.02574  0.01957  0.01629] , auc=[0.82992], sum_recall=[0.52027]
Epoch 24 [39.6s + 11.6s]: train==[2.41700 = 0.18820 + 2.22880], recall= [ 0.02116  0.11125  0.17410  0.21593] , precision= [ 0.02522  0.02574  0.01983  0.01635] , auc=[0.82966], sum_recall=[0.52244]
Epoch 25 [40.5s + 12.1s]: train==[2.40804 = 0.18056 + 2.22748], recall= [ 0.02145  0.10973  0.17515  0.21496] , precision= [ 0.02609  0.02522  0.02000  0.01623] , auc=[0.82951], sum_recall=[0.52129]
Epoch 26 [38.9s + 11.8s]: train==[2.41020 = 0.18384 + 2.22636], recall= [ 0.02232  0.11038  0.17425  0.21593] , precision= [ 0.02696  0.02522  0.01991  0.01635] , auc=[0.82937], sum_recall=[0.52288]
Epoch 27 [39.2s + 11.4s]: train==[2.40054 = 0.17524 + 2.22530], recall= [ 0.02145  0.11252  0.17338  0.21322] , precision= [ 0.02609  0.02557  0.01983  0.01612] , auc=[0.82925], sum_recall=[0.52057]
Epoch 28 [39.5s + 12.4s]: train==[2.39644 = 0.17204 + 2.22440], recall= [ 0.02145  0.11194  0.17425  0.21148] , precision= [ 0.02609  0.02557  0.01991  0.01600] , auc=[0.82926], sum_recall=[0.51912]
Epoch 29 [40.3s + 11.9s]: train==[2.38902 = 0.16560 + 2.22342], recall= [ 0.02232  0.11317  0.17515  0.21339] , precision= [ 0.02696  0.02591  0.02000  0.01617] , auc=[0.82914], sum_recall=[0.52403]
Epoch 30 [39.5s + 12.6s]: train==[2.38890 = 0.16611 + 2.22279], recall= [ 0.02406  0.11418  0.17428  0.21318] , precision= [ 0.02870  0.02626  0.01991  0.01617] , auc=[0.82893], sum_recall=[0.52570]
Epoch 31 [40.2s + 11.7s]: train==[2.38629 = 0.16391 + 2.22238], recall= [ 0.02406  0.11331  0.17539  0.21231] , precision= [ 0.02870  0.02609  0.02009  0.01612] , auc=[0.82862], sum_recall=[0.52507]
Epoch 32 [41.2s + 13.0s]: train==[2.37857 = 0.15639 + 2.22217], recall= [ 0.02478  0.11201  0.17467  0.21361] , precision= [ 0.02870  0.02557  0.02009  0.01623] , auc=[0.82834], sum_recall=[0.52507]
End of trainning! Best recall= [ 0.02203  0.11082  0.17401  0.21676] , precision= [ 0.02609  0.02539  0.01974  0.01641] , auc=[0.83006]
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross0', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-23 18:41:34
loading data...
[n_users, n_items]=[3209, 12211]
[n_train, n_test]=[2636, 1318]
[n_edges]=[285362]
Using GPU 1,  memory_free: 24265
tensor([-0.0372, -0.0138, -0.0122, -0.0094,  0.0268], device='cuda:1')
Loading Model..Number of Model Parameters:  3324802
Epoch 0 [39.4s + 9.7s]: train==[5.12366 = 2.81207 + 2.31159], recall= [ 0.00359  0.00699  0.00873  0.00902] , precision= [ 0.00435  0.00191  0.00113  0.00081] , auc=[0.50161], sum_recall=[0.02833]
Epoch 1 [39.4s + 9.8s]: train==[3.54369 = 1.23448 + 2.30921], recall= [ 0.01790  0.07329  0.12448  0.14968] , precision= [ 0.02087  0.01722  0.01417  0.01136] , auc=[0.69366], sum_recall=[0.36535]
Epoch 2 [39.3s + 10.0s]: train==[3.03665 = 0.73603 + 2.30062], recall= [ 0.01626  0.09434  0.15275  0.18879] , precision= [ 0.01913  0.02139  0.01757  0.01432] , auc=[0.76867], sum_recall=[0.45213]
Epoch 3 [39.4s + 11.8s]: train==[2.85210 = 0.56022 + 2.29187], recall= [ 0.02289  0.09665  0.16587  0.20282] , precision= [ 0.02696  0.02209  0.01887  0.01519] , auc=[0.79129], sum_recall=[0.48823]
Epoch 4 [39.5s + 11.6s]: train==[2.73499 = 0.45020 + 2.28479], recall= [ 0.02278  0.09477  0.17048  0.20703] , precision= [ 0.02609  0.02174  0.01930  0.01554] , auc=[0.80239], sum_recall=[0.49505]
Epoch 5 [39.3s + 11.1s]: train==[2.68544 = 0.40556 + 2.27988], recall= [ 0.02094  0.09443  0.16700  0.21003] , precision= [ 0.02348  0.02174  0.01896  0.01583] , auc=[0.80878], sum_recall=[0.49241]
Epoch 6 [39.4s + 12.2s]: train==[2.64412 = 0.36693 + 2.27719], recall= [ 0.02036  0.08970  0.16671  0.21032] , precision= [ 0.02348  0.02087  0.01896  0.01583] , auc=[0.81330], sum_recall=[0.48709]
Epoch 7 [39.2s + 12.1s]: train==[2.61373 = 0.33736 + 2.27637], recall= [ 0.02094  0.09057  0.16656  0.21061] , precision= [ 0.02348  0.02087  0.01904  0.01588] , auc=[0.81678], sum_recall=[0.48869]
Epoch 8 [39.6s + 11.5s]: train==[2.59147 = 0.31488 + 2.27660], recall= [ 0.01957  0.09849  0.17004  0.20928] , precision= [ 0.02261  0.02261  0.01939  0.01583] , auc=[0.81940], sum_recall=[0.49738]
Epoch 9 [39.3s + 12.1s]: train==[2.57473 = 0.29781 + 2.27692], recall= [ 0.01986  0.09622  0.17124  0.21206] , precision= [ 0.02348  0.02209  0.01930  0.01606] , auc=[0.82102], sum_recall=[0.49937]
Epoch 10 [45.4s + 12.0s]: train==[2.56223 = 0.28586 + 2.27637], recall= [ 0.02029  0.09579  0.17471  0.21346] , precision= [ 0.02435  0.02191  0.01965  0.01617] , auc=[0.82254], sum_recall=[0.50425]
Epoch 11 [40.6s + 12.4s]: train==[2.54910 = 0.27468 + 2.27442], recall= [ 0.02029  0.09917  0.17037  0.21193] , precision= [ 0.02435  0.02261  0.01922  0.01606] , auc=[0.82427], sum_recall=[0.50175]
Epoch 12 [45.4s + 11.9s]: train==[2.53289 = 0.26190 + 2.27099], recall= [ 0.02261  0.10187  0.17020  0.21164] , precision= [ 0.02609  0.02330  0.01930  0.01612] , auc=[0.82565], sum_recall=[0.50632]
Epoch 13 [39.5s + 12.8s]: train==[2.51097 = 0.24459 + 2.26637], recall= [ 0.02217  0.10318  0.17049  0.21251] , precision= [ 0.02609  0.02365  0.01939  0.01617] , auc=[0.82711], sum_recall=[0.50835]
Epoch 14 [39.5s + 11.6s]: train==[2.50179 = 0.24060 + 2.26119], recall= [ 0.02145  0.10395  0.16962  0.21280] , precision= [ 0.02522  0.02365  0.01930  0.01612] , auc=[0.82867], sum_recall=[0.50782]
Epoch 15 [39.5s + 11.3s]: train==[2.49256 = 0.23645 + 2.25611], recall= [ 0.02275  0.10525  0.17223  0.21555] , precision= [ 0.02609  0.02383  0.01957  0.01635] , auc=[0.83011], sum_recall=[0.51579]
Epoch 16 [39.2s + 11.4s]: train==[2.47965 = 0.22803 + 2.25162], recall= [ 0.02188  0.10656  0.17730  0.21555] , precision= [ 0.02522  0.02400  0.02026  0.01635] , auc=[0.83115], sum_recall=[0.52129]
Epoch 17 [40.5s + 11.2s]: train==[2.46686 = 0.21928 + 2.24758], recall= [ 0.02101  0.10960  0.17715  0.21425] , precision= [ 0.02435  0.02470  0.02043  0.01629] , auc=[0.83199], sum_recall=[0.52201]
Epoch 18 [39.5s + 11.4s]: train==[2.46539 = 0.22145 + 2.24394], recall= [ 0.02069  0.10960  0.17865  0.21686] , precision= [ 0.02435  0.02470  0.02052  0.01646] , auc=[0.83246], sum_recall=[0.52579]
Epoch 19 [39.6s + 11.8s]: train==[2.44640 = 0.20577 + 2.24063], recall= [ 0.02156  0.11308  0.17788  0.21859] , precision= [ 0.02522  0.02539  0.02052  0.01664] , auc=[0.83278], sum_recall=[0.53111]
Epoch 20 [39.4s + 11.8s]: train==[2.44562 = 0.20806 + 2.23756], recall= [ 0.02156  0.11221  0.17962  0.21758] , precision= [ 0.02522  0.02522  0.02061  0.01652] , auc=[0.83296], sum_recall=[0.53096]
Epoch 21 [39.3s + 11.6s]: train==[2.43551 = 0.20058 + 2.23493], recall= [ 0.02069  0.11047  0.18179  0.22120] , precision= [ 0.02435  0.02487  0.02087  0.01681] , auc=[0.83294], sum_recall=[0.53415]
Epoch 22 [39.2s + 11.3s]: train==[2.42688 = 0.19425 + 2.23262], recall= [ 0.02069  0.10960  0.18179  0.22135] , precision= [ 0.02435  0.02487  0.02087  0.01681] , auc=[0.83264], sum_recall=[0.53343]
Epoch 23 [44.3s + 11.6s]: train==[2.42183 = 0.19095 + 2.23088], recall= [ 0.02286  0.10525  0.18208  0.22033] , precision= [ 0.02696  0.02400  0.02087  0.01670] , auc=[0.83203], sum_recall=[0.53053]
Epoch 24 [45.9s + 11.5s]: train==[2.41349 = 0.18399 + 2.22950], recall= [ 0.02330  0.10552  0.18099  0.21956] , precision= [ 0.02696  0.02435  0.02070  0.01670] , auc=[0.83140], sum_recall=[0.52937]
Epoch 25 [39.6s + 11.8s]: train==[2.40825 = 0.17982 + 2.22843], recall= [ 0.02330  0.10552  0.18264  0.21832] , precision= [ 0.02696  0.02435  0.02078  0.01664] , auc=[0.83092], sum_recall=[0.52978]
Epoch 26 [39.8s + 12.3s]: train==[2.40453 = 0.17709 + 2.22744], recall= [ 0.02330  0.10600  0.18133  0.22084] , precision= [ 0.02696  0.02417  0.02061  0.01675] , auc=[0.83033], sum_recall=[0.53147]
Epoch 27 [40.0s + 11.6s]: train==[2.40003 = 0.17353 + 2.22650], recall= [ 0.02504  0.10832  0.18220  0.22402] , precision= [ 0.02870  0.02452  0.02070  0.01704] , auc=[0.82989], sum_recall=[0.53958]
Epoch 28 [42.9s + 12.0s]: train==[2.39268 = 0.16698 + 2.22571], recall= [ 0.02504  0.10789  0.18177  0.22436] , precision= [ 0.02870  0.02435  0.02070  0.01704] , auc=[0.82947], sum_recall=[0.53905]
Epoch 29 [42.3s + 12.2s]: train==[2.38608 = 0.16108 + 2.22500], recall= [ 0.02591  0.10919  0.18191  0.22349] , precision= [ 0.02957  0.02452  0.02078  0.01699] , auc=[0.82894], sum_recall=[0.54050]
Epoch 30 [39.6s + 11.7s]: train==[2.38567 = 0.16108 + 2.22459], recall= [ 0.02547  0.10919  0.18061  0.22301] , precision= [ 0.02957  0.02452  0.02061  0.01704] , auc=[0.82855], sum_recall=[0.53828]
End of trainning! Best recall= [ 0.02156  0.11221  0.17962  0.21758] , precision= [ 0.02522  0.02522  0.02061  0.01652] , auc=[0.83296]
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross0', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-23 19:08:35
loading data...
[n_users, n_items]=[3209, 12211]
[n_train, n_test]=[2636, 1318]
[n_edges]=[285362]
Using GPU 1,  memory_free: 24265
tensor([ 0.0057, -0.0342,  0.0050, -0.0275,  0.0049], device='cuda:1')
Loading Model..Number of Model Parameters:  3324802
Epoch 0 [38.7s + 9.9s]: train==[5.19030 = 2.86938 + 2.32092], recall= [ 0.00348  0.01054  0.01141  0.01228] , precision= [ 0.00348  0.00261  0.00139  0.00099] , auc=[0.50440], sum_recall=[0.03770]
Epoch 1 [38.8s + 9.4s]: train==[3.57405 = 1.25555 + 2.31850], recall= [ 0.01500  0.07266  0.12660  0.15558] , precision= [ 0.01739  0.01687  0.01426  0.01159] , auc=[0.69133], sum_recall=[0.36984]
Epoch 2 [38.8s + 9.6s]: train==[3.06700 = 0.75741 + 2.30958], recall= [ 0.02279  0.09054  0.16054  0.19716] , precision= [ 0.02696  0.02052  0.01783  0.01478] , auc=[0.75466], sum_recall=[0.47102]
Epoch 3 [39.2s + 11.1s]: train==[2.88475 = 0.58519 + 2.29955], recall= [ 0.02279  0.09872  0.16830  0.20793] , precision= [ 0.02696  0.02261  0.01887  0.01559] , auc=[0.77738], sum_recall=[0.49774]
Epoch 4 [39.3s + 11.1s]: train==[2.75928 = 0.46850 + 2.29078], recall= [ 0.02540  0.10296  0.16635  0.20677] , precision= [ 0.02957  0.02330  0.01870  0.01565] , auc=[0.78505], sum_recall=[0.50148]
Epoch 5 [45.4s + 11.1s]: train==[2.70049 = 0.41625 + 2.28424], recall= [ 0.02322  0.10478  0.16939  0.20754] , precision= [ 0.02696  0.02365  0.01922  0.01565] , auc=[0.79122], sum_recall=[0.50493]
Epoch 6 [38.9s + 11.1s]: train==[2.66280 = 0.38262 + 2.28018], recall= [ 0.02366  0.10818  0.16852  0.21235] , precision= [ 0.02696  0.02435  0.01913  0.01594] , auc=[0.79617], sum_recall=[0.51271]
Epoch 7 [39.0s + 11.8s]: train==[2.62928 = 0.35097 + 2.27831], recall= [ 0.02467  0.10731  0.17297  0.21583] , precision= [ 0.02870  0.02417  0.01965  0.01617] , auc=[0.80072], sum_recall=[0.52078]
Epoch 8 [39.0s + 11.2s]: train==[2.60289 = 0.32494 + 2.27795], recall= [ 0.02207  0.10654  0.17736  0.21539] , precision= [ 0.02609  0.02417  0.02009  0.01617] , auc=[0.80499], sum_recall=[0.52136]
Epoch 9 [38.7s + 10.6s]: train==[2.58399 = 0.30599 + 2.27801], recall= [ 0.02120  0.10234  0.17826  0.21330] , precision= [ 0.02522  0.02313  0.02026  0.01612] , auc=[0.80829], sum_recall=[0.51509]
Epoch 10 [40.9s + 11.8s]: train==[2.57421 = 0.29661 + 2.27760], recall= [ 0.02120  0.10209  0.17565  0.21794] , precision= [ 0.02522  0.02278  0.02000  0.01646] , auc=[0.81107], sum_recall=[0.51688]
Epoch 11 [39.1s + 11.1s]: train==[2.55142 = 0.27544 + 2.27598], recall= [ 0.02196  0.10470  0.17638  0.21977] , precision= [ 0.02522  0.02330  0.02000  0.01664] , auc=[0.81383], sum_recall=[0.52281]
Epoch 12 [39.0s + 11.4s]: train==[2.54252 = 0.26956 + 2.27296], recall= [ 0.02065  0.10601  0.17524  0.21832] , precision= [ 0.02435  0.02348  0.01991  0.01658] , auc=[0.81642], sum_recall=[0.52022]
Epoch 13 [38.9s + 11.4s]: train==[2.51780 = 0.24929 + 2.26851], recall= [ 0.02239  0.10622  0.17683  0.21745] , precision= [ 0.02609  0.02383  0.02017  0.01652] , auc=[0.81849], sum_recall=[0.52290]
Epoch 14 [39.0s + 11.2s]: train==[2.50862 = 0.24538 + 2.26324], recall= [ 0.02304  0.10796  0.17727  0.22093] , precision= [ 0.02609  0.02417  0.02017  0.01675] , auc=[0.82072], sum_recall=[0.52921]
Epoch 15 [38.8s + 10.5s]: train==[2.49605 = 0.23816 + 2.25789], recall= [ 0.02377  0.10912  0.17997  0.21919] , precision= [ 0.02609  0.02452  0.02052  0.01664] , auc=[0.82272], sum_recall=[0.53206]
Epoch 16 [39.0s + 12.0s]: train==[2.48124 = 0.22813 + 2.25312], recall= [ 0.02377  0.11173  0.17944  0.22006] , precision= [ 0.02609  0.02522  0.02035  0.01670] , auc=[0.82449], sum_recall=[0.53500]
Epoch 17 [39.1s + 10.7s]: train==[2.46841 = 0.21958 + 2.24882], recall= [ 0.02475  0.11608  0.18292  0.22093] , precision= [ 0.02783  0.02609  0.02070  0.01675] , auc=[0.82590], sum_recall=[0.54468]
Epoch 18 [38.8s + 11.1s]: train==[2.46732 = 0.22229 + 2.24503], recall= [ 0.02562  0.11673  0.18162  0.21982] , precision= [ 0.02870  0.02609  0.02061  0.01658] , auc=[0.82702], sum_recall=[0.54379]
Epoch 19 [38.8s + 11.5s]: train==[2.44920 = 0.20761 + 2.24159], recall= [ 0.02649  0.11064  0.18133  0.21504] , precision= [ 0.02957  0.02470  0.02061  0.01623] , auc=[0.82778], sum_recall=[0.53350]
Epoch 20 [38.8s + 10.8s]: train==[2.44316 = 0.20483 + 2.23834], recall= [ 0.02822  0.11412  0.18118  0.21515] , precision= [ 0.03130  0.02539  0.02052  0.01617] , auc=[0.82842], sum_recall=[0.53868]
Epoch 21 [38.9s + 10.5s]: train==[2.43404 = 0.19872 + 2.23533], recall= [ 0.02822  0.11325  0.17930  0.21515] , precision= [ 0.03130  0.02522  0.02026  0.01617] , auc=[0.82896], sum_recall=[0.53593]
Epoch 22 [39.1s + 11.4s]: train==[2.42711 = 0.19443 + 2.23268], recall= [ 0.02822  0.11586  0.17973  0.21480] , precision= [ 0.03130  0.02574  0.02026  0.01606] , auc=[0.82932], sum_recall=[0.53862]
Epoch 23 [39.0s + 11.1s]: train==[2.41896 = 0.18837 + 2.23059], recall= [ 0.02909  0.11514  0.17582  0.21543] , precision= [ 0.03217  0.02574  0.01983  0.01623] , auc=[0.82926], sum_recall=[0.53548]
Epoch 24 [39.3s + 11.0s]: train==[2.41427 = 0.18540 + 2.22888], recall= [ 0.03040  0.11717  0.17756  0.21272] , precision= [ 0.03391  0.02626  0.02000  0.01600] , auc=[0.82924], sum_recall=[0.53784]
Epoch 25 [39.1s + 11.6s]: train==[2.41026 = 0.18268 + 2.22758], recall= [ 0.03040  0.11804  0.17930  0.21446] , precision= [ 0.03391  0.02643  0.02017  0.01612] , auc=[0.82926], sum_recall=[0.54219]
Epoch 26 [39.2s + 11.9s]: train==[2.40650 = 0.18011 + 2.22640], recall= [ 0.03127  0.11800  0.17669  0.21605] , precision= [ 0.03478  0.02661  0.01991  0.01623] , auc=[0.82912], sum_recall=[0.54201]
Epoch 27 [39.0s + 10.4s]: train==[2.39864 = 0.17328 + 2.22536], recall= [ 0.03040  0.11699  0.17799  0.21771] , precision= [ 0.03391  0.02626  0.02009  0.01646] , auc=[0.82885], sum_recall=[0.54308]
Epoch 28 [38.9s + 11.8s]: train==[2.39459 = 0.17017 + 2.22442], recall= [ 0.03127  0.11594  0.17904  0.21814] , precision= [ 0.03478  0.02591  0.02026  0.01646] , auc=[0.82849], sum_recall=[0.54439]
Epoch 29 [43.6s + 11.3s]: train==[2.38784 = 0.16441 + 2.22342], recall= [ 0.03214  0.11659  0.17860  0.21597] , precision= [ 0.03565  0.02591  0.02017  0.01629] , auc=[0.82799], sum_recall=[0.54330]
Epoch 30 [39.1s + 10.9s]: train==[2.38707 = 0.16436 + 2.22271], recall= [ 0.03214  0.11486  0.17505  0.21531] , precision= [ 0.03565  0.02557  0.01974  0.01629] , auc=[0.82756], sum_recall=[0.53736]
Epoch 31 [38.8s + 11.4s]: train==[2.38482 = 0.16263 + 2.22219], recall= [ 0.03214  0.11674  0.17679  0.21749] , precision= [ 0.03565  0.02609  0.01991  0.01646] , auc=[0.82713], sum_recall=[0.54315]
Epoch 32 [39.0s + 11.7s]: train==[2.37726 = 0.15537 + 2.22189], recall= [ 0.03214  0.11674  0.17527  0.21749] , precision= [ 0.03565  0.02609  0.01983  0.01652] , auc=[0.82668], sum_recall=[0.54163]
End of trainning! Best recall= [ 0.02822  0.11586  0.17973  0.21480] , precision= [ 0.03130  0.02574  0.02026  0.01606] , auc=[0.82932]
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross0', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-23 19:36:26
loading data...
[n_users, n_items]=[3209, 12211]
[n_train, n_test]=[2636, 1318]
[n_edges]=[285362]
Using GPU 1,  memory_free: 24265
tensor([-0.0416, -0.0085,  0.0215, -0.0150, -0.0296], device='cuda:1')
Loading Model..Number of Model Parameters:  3324802
Epoch 0 [39.5s + 9.7s]: train==[5.17336 = 2.85156 + 2.32179], recall= [ 0.00500  0.00674  0.01391  0.01478] , precision= [ 0.00609  0.00157  0.00157  0.00110] , auc=[0.51825], sum_recall=[0.04043]
Epoch 1 [40.7s + 10.0s]: train==[3.57590 = 1.25625 + 2.31965], recall= [ 0.02042  0.07622  0.12444  0.15571] , precision= [ 0.02522  0.01757  0.01400  0.01154] , auc=[0.70495], sum_recall=[0.37680]
Epoch 2 [40.1s + 9.8s]: train==[3.05967 = 0.74927 + 2.31041], recall= [ 0.02272  0.09361  0.15754  0.19288] , precision= [ 0.02609  0.02122  0.01791  0.01455] , auc=[0.77364], sum_recall=[0.46675]
Epoch 3 [39.6s + 11.0s]: train==[2.87236 = 0.57181 + 2.30055], recall= [ 0.02272  0.09982  0.16769  0.20553] , precision= [ 0.02609  0.02278  0.01904  0.01542] , auc=[0.79284], sum_recall=[0.49576]
Epoch 4 [39.8s + 11.2s]: train==[2.74625 = 0.45392 + 2.29233], recall= [ 0.02779  0.09525  0.16935  0.20883] , precision= [ 0.03217  0.02157  0.01922  0.01571] , auc=[0.79799], sum_recall=[0.50122]
Epoch 5 [39.7s + 11.0s]: train==[2.69058 = 0.40416 + 2.28641], recall= [ 0.02692  0.09521  0.16838  0.20873] , precision= [ 0.03130  0.02157  0.01904  0.01565] , auc=[0.80062], sum_recall=[0.49924]
Epoch 6 [39.6s + 11.0s]: train==[2.65783 = 0.37496 + 2.28287], recall= [ 0.02786  0.09608  0.16650  0.20978] , precision= [ 0.03217  0.02174  0.01878  0.01583] , auc=[0.80249], sum_recall=[0.50021]
Epoch 7 [39.5s + 11.6s]: train==[2.62928 = 0.34803 + 2.28125], recall= [ 0.02612  0.09869  0.16921  0.21557] , precision= [ 0.03043  0.02226  0.01930  0.01623] , auc=[0.80411], sum_recall=[0.50959]
Epoch 8 [39.2s + 11.1s]: train==[2.60311 = 0.32228 + 2.28083], recall= [ 0.02264  0.10173  0.17160  0.21789] , precision= [ 0.02696  0.02296  0.01948  0.01641] , auc=[0.80631], sum_recall=[0.51387]
Epoch 9 [39.3s + 14.1s]: train==[2.58174 = 0.30119 + 2.28055], recall= [ 0.02177  0.09999  0.17591  0.21807] , precision= [ 0.02609  0.02261  0.01991  0.01646] , auc=[0.80831], sum_recall=[0.51574]
Epoch 10 [42.5s + 11.9s]: train==[2.57194 = 0.29243 + 2.27951], recall= [ 0.02003  0.10521  0.17434  0.21879] , precision= [ 0.02435  0.02365  0.01983  0.01664] , auc=[0.81044], sum_recall=[0.51837]
Epoch 11 [39.2s + 11.3s]: train==[2.55840 = 0.28129 + 2.27711], recall= [ 0.02090  0.10717  0.17630  0.21585] , precision= [ 0.02522  0.02383  0.02009  0.01652] , auc=[0.81285], sum_recall=[0.52021]
Epoch 12 [39.0s + 11.1s]: train==[2.54172 = 0.26845 + 2.27328], recall= [ 0.02046  0.10630  0.17272  0.21382] , precision= [ 0.02522  0.02365  0.01965  0.01635] , auc=[0.81529], sum_recall=[0.51330]
Epoch 13 [38.7s + 12.5s]: train==[2.52177 = 0.25357 + 2.26821], recall= [ 0.02133  0.10659  0.17065  0.21483] , precision= [ 0.02609  0.02383  0.01948  0.01652] , auc=[0.81753], sum_recall=[0.51340]
Epoch 14 [39.4s + 11.0s]: train==[2.50747 = 0.24499 + 2.26248], recall= [ 0.02307  0.10941  0.17021  0.21727] , precision= [ 0.02783  0.02452  0.01939  0.01664] , auc=[0.81965], sum_recall=[0.51996]
Epoch 15 [39.4s + 10.9s]: train==[2.49829 = 0.24146 + 2.25683], recall= [ 0.02119  0.10985  0.17108  0.21596] , precision= [ 0.02522  0.02452  0.01948  0.01652] , auc=[0.82168], sum_recall=[0.51808]
Epoch 16 [39.5s + 11.8s]: train==[2.48692 = 0.23510 + 2.25182], recall= [ 0.02119  0.10941  0.17282  0.21770] , precision= [ 0.02522  0.02435  0.01965  0.01664] , auc=[0.82389], sum_recall=[0.52112]
Epoch 17 [39.2s + 11.3s]: train==[2.47238 = 0.22509 + 2.24729], recall= [ 0.02235  0.10999  0.17456  0.22147] , precision= [ 0.02696  0.02470  0.02000  0.01693] , auc=[0.82571], sum_recall=[0.52837]
Epoch 18 [39.2s + 11.3s]: train==[2.47118 = 0.22772 + 2.24345], recall= [ 0.02235  0.10912  0.17554  0.22016] , precision= [ 0.02696  0.02452  0.02017  0.01681] , auc=[0.82714], sum_recall=[0.52717]
Epoch 19 [38.9s + 11.8s]: train==[2.45024 = 0.21017 + 2.24007], recall= [ 0.02235  0.11191  0.17771  0.21951] , precision= [ 0.02696  0.02522  0.02043  0.01681] , auc=[0.82830], sum_recall=[0.53148]
Epoch 20 [39.5s + 11.3s]: train==[2.44736 = 0.21036 + 2.23701], recall= [ 0.02322  0.11191  0.18018  0.21806] , precision= [ 0.02783  0.02522  0.02061  0.01670] , auc=[0.82934], sum_recall=[0.53336]
Epoch 21 [39.0s + 11.3s]: train==[2.43774 = 0.20338 + 2.23436], recall= [ 0.02409  0.11386  0.17887  0.21893] , precision= [ 0.02870  0.02574  0.02043  0.01675] , auc=[0.83011], sum_recall=[0.53575]
Epoch 22 [39.2s + 11.4s]: train==[2.42970 = 0.19752 + 2.23218], recall= [ 0.02496  0.11222  0.17844  0.22024] , precision= [ 0.02957  0.02557  0.02035  0.01675] , auc=[0.83057], sum_recall=[0.53585]
Epoch 23 [39.3s + 10.8s]: train==[2.42310 = 0.19259 + 2.23051], recall= [ 0.02670  0.11222  0.17641  0.21821] , precision= [ 0.03130  0.02557  0.02009  0.01652] , auc=[0.83062], sum_recall=[0.53353]
Epoch 24 [39.1s + 10.7s]: train==[2.41633 = 0.18711 + 2.22922], recall= [ 0.02767  0.11526  0.17554  0.21840] , precision= [ 0.03304  0.02626  0.02000  0.01652] , auc=[0.83070], sum_recall=[0.53688]
Epoch 25 [38.8s + 10.9s]: train==[2.40859 = 0.18029 + 2.22830], recall= [ 0.02854  0.11468  0.17467  0.21502] , precision= [ 0.03391  0.02626  0.01991  0.01629] , auc=[0.83083], sum_recall=[0.53292]
Epoch 26 [39.2s + 12.2s]: train==[2.40797 = 0.18047 + 2.22750], recall= [ 0.02924  0.11121  0.17800  0.21502] , precision= [ 0.03391  0.02557  0.02035  0.01629] , auc=[0.83096], sum_recall=[0.53347]
Epoch 27 [46.0s + 10.7s]: train==[2.40084 = 0.17407 + 2.22676], recall= [ 0.02924  0.11207  0.17684  0.21743] , precision= [ 0.03391  0.02574  0.02017  0.01652] , auc=[0.83107], sum_recall=[0.53559]
Epoch 28 [39.0s + 11.2s]: train==[2.39495 = 0.16886 + 2.22610], recall= [ 0.03011  0.11121  0.17626  0.22197] , precision= [ 0.03478  0.02539  0.02017  0.01681] , auc=[0.83114], sum_recall=[0.53955]
Epoch 29 [39.3s + 11.3s]: train==[2.38904 = 0.16365 + 2.22539], recall= [ 0.03011  0.11019  0.17721  0.22110] , precision= [ 0.03478  0.02504  0.02026  0.01675] , auc=[0.83087], sum_recall=[0.53861]
Epoch 30 [39.0s + 11.1s]: train==[2.38714 = 0.16219 + 2.22495], recall= [ 0.03098  0.11019  0.17677  0.21936] , precision= [ 0.03565  0.02504  0.02026  0.01664] , auc=[0.83053], sum_recall=[0.53730]
Epoch 31 [39.0s + 11.1s]: train==[2.38410 = 0.15945 + 2.22465], recall= [ 0.03011  0.11150  0.17387  0.21850] , precision= [ 0.03478  0.02539  0.01991  0.01658] , auc=[0.83005], sum_recall=[0.53397]
Epoch 32 [39.0s + 12.0s]: train==[2.37832 = 0.15380 + 2.22452], recall= [ 0.03087  0.11251  0.17677  0.21850] , precision= [ 0.03478  0.02574  0.02026  0.01658] , auc=[0.82969], sum_recall=[0.53864]
Epoch 33 [39.4s + 10.9s]: train==[2.37844 = 0.15399 + 2.22444], recall= [ 0.03174  0.11150  0.17735  0.21903] , precision= [ 0.03565  0.02539  0.02026  0.01670] , auc=[0.82947], sum_recall=[0.53961]
Epoch 34 [39.2s + 11.1s]: train==[2.37373 = 0.14942 + 2.22431], recall= [ 0.03174  0.11117  0.17822  0.21816] , precision= [ 0.03565  0.02557  0.02035  0.01664] , auc=[0.82950], sum_recall=[0.53929]
Epoch 35 [39.1s + 10.8s]: train==[2.37363 = 0.14948 + 2.22415], recall= [ 0.03174  0.10947  0.17851  0.22077] , precision= [ 0.03565  0.02487  0.02043  0.01681] , auc=[0.82984], sum_recall=[0.54049]
Epoch 36 [39.2s + 11.1s]: train==[2.37441 = 0.15044 + 2.22396], recall= [ 0.03261  0.11078  0.17996  0.22033] , precision= [ 0.03652  0.02504  0.02052  0.01681] , auc=[0.83010], sum_recall=[0.54368]
Epoch 37 [39.0s + 11.8s]: train==[2.36267 = 0.13881 + 2.22386], recall= [ 0.03261  0.11208  0.17822  0.21903] , precision= [ 0.03652  0.02539  0.02035  0.01670] , auc=[0.83035], sum_recall=[0.54194]
Epoch 38 [39.1s + 12.3s]: train==[2.35806 = 0.13446 + 2.22360], recall= [ 0.03261  0.10860  0.17851  0.21842] , precision= [ 0.03652  0.02470  0.02043  0.01664] , auc=[0.83072], sum_recall=[0.53814]
End of trainning! Best recall= [ 0.03011  0.11121  0.17626  0.22197] , precision= [ 0.03478  0.02539  0.02017  0.01681] , auc=[0.83114]
