Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross0', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200,200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-25 16:46:08
loading data...
[n_users, n_items]=[3209, 12331]
[n_train, n_test]=[2636, 1318]
[n_edges]=[260034]
Using GPU 0,  memory_free: 24265
tensor([-0.0025,  0.0079,  0.0252, -0.0301,  0.0233], device='cuda:0')
Loading Model..Number of Model Parameters:  3509402
Epoch 0 [27.8s + 11.1s]: train==[4.99802 = 2.68485 + 2.31317], recall= [ 0.00739  0.01217  0.01674  0.02080] , precision= [ 0.00783  0.00261  0.00183  0.00157] , auc=[0.55936], sum_recall=[0.05710]
Epoch 1 [29.0s + 10.5s]: train==[3.35385 = 1.04165 + 2.31220], recall= [ 0.01935  0.05713  0.09302  0.11229] , precision= [ 0.02087  0.01287  0.01061  0.00841] , auc=[0.67594], sum_recall=[0.28179]
Epoch 2 [31.5s + 11.1s]: train==[2.91672 = 0.60590 + 2.31082], recall= [ 0.01669  0.06901  0.10626  0.13017] , precision= [ 0.01913  0.01565  0.01200  0.00980] , auc=[0.70984], sum_recall=[0.32213]
Epoch 3 [29.6s + 12.6s]: train==[2.76969 = 0.46115 + 2.30854], recall= [ 0.01727  0.07379  0.11220  0.13640] , precision= [ 0.02087  0.01687  0.01261  0.01032] , auc=[0.72942], sum_recall=[0.33966]
Epoch 4 [27.5s + 13.1s]: train==[2.67949 = 0.37420 + 2.30529], recall= [ 0.01792  0.07466  0.11423  0.13684] , precision= [ 0.02087  0.01704  0.01296  0.01038] , auc=[0.74215], sum_recall=[0.34365]
Epoch 5 [30.2s + 12.8s]: train==[2.63646 = 0.33531 + 2.30116], recall= [ 0.02053  0.07604  0.11713  0.14205] , precision= [ 0.02348  0.01739  0.01322  0.01078] , auc=[0.75017], sum_recall=[0.35575]
Epoch 6 [27.7s + 12.9s]: train==[2.59584 = 0.29943 + 2.29641], recall= [ 0.02401  0.07618  0.11582  0.14075] , precision= [ 0.02696  0.01739  0.01313  0.01072] , auc=[0.75499], sum_recall=[0.35676]
Epoch 7 [28.9s + 12.3s]: train==[2.57217 = 0.28071 + 2.29146], recall= [ 0.02589  0.07357  0.11582  0.14336] , precision= [ 0.02870  0.01687  0.01313  0.01072] , auc=[0.75791], sum_recall=[0.35865]
Epoch 8 [31.6s + 12.7s]: train==[2.55374 = 0.26707 + 2.28667], recall= [ 0.02415  0.07749  0.11321  0.13918] , precision= [ 0.02696  0.01757  0.01287  0.01049] , auc=[0.76081], sum_recall=[0.35404]
Epoch 9 [31.2s + 13.3s]: train==[2.52555 = 0.24330 + 2.28226], recall= [ 0.02198  0.07771  0.11705  0.13933] , precision= [ 0.02435  0.01739  0.01313  0.01043] , auc=[0.76299], sum_recall=[0.35607]
Epoch 10 [27.1s + 13.2s]: train==[2.51753 = 0.23934 + 2.27819], recall= [ 0.02198  0.08118  0.11701  0.13527] , precision= [ 0.02435  0.01826  0.01322  0.01014] , auc=[0.76505], sum_recall=[0.35544]
Epoch 11 [26.6s + 12.3s]: train==[2.50527 = 0.23104 + 2.27423], recall= [ 0.02198  0.08002  0.11473  0.13744] , precision= [ 0.02435  0.01774  0.01287  0.01032] , auc=[0.76797], sum_recall=[0.35418]
Epoch 12 [26.6s + 12.3s]: train==[2.48895 = 0.21865 + 2.27031], recall= [ 0.02372  0.07988  0.11531  0.13860] , precision= [ 0.02609  0.01774  0.01287  0.01043] , auc=[0.76961], sum_recall=[0.35752]
Epoch 13 [26.5s + 12.2s]: train==[2.46496 = 0.19852 + 2.26644], recall= [ 0.02372  0.08075  0.11843  0.13846] , precision= [ 0.02609  0.01791  0.01330  0.01038] , auc=[0.77155], sum_recall=[0.36136]
Epoch 14 [26.5s + 12.8s]: train==[2.45840 = 0.19578 + 2.26262], recall= [ 0.02372  0.08104  0.12089  0.14081] , precision= [ 0.02609  0.01809  0.01348  0.01067] , auc=[0.77310], sum_recall=[0.36647]
Epoch 15 [26.4s + 12.6s]: train==[2.44960 = 0.19072 + 2.25888], recall= [ 0.02372  0.07756  0.12249  0.14201] , precision= [ 0.02609  0.01739  0.01365  0.01067] , auc=[0.77401], sum_recall=[0.36578]
Epoch 16 [26.8s + 12.1s]: train==[2.43784 = 0.18274 + 2.25510], recall= [ 0.02459  0.08365  0.12292  0.14549] , precision= [ 0.02696  0.01861  0.01365  0.01090] , auc=[0.77442], sum_recall=[0.37665]
Epoch 17 [26.6s + 12.4s]: train==[2.42536 = 0.17410 + 2.25126], recall= [ 0.02459  0.08162  0.11698  0.14879] , precision= [ 0.02696  0.01809  0.01296  0.01101] , auc=[0.77581], sum_recall=[0.37198]
Epoch 18 [26.4s + 13.2s]: train==[2.41545 = 0.16820 + 2.24725], recall= [ 0.02459  0.08321  0.12365  0.14894] , precision= [ 0.02696  0.01861  0.01374  0.01101] , auc=[0.77623], sum_recall=[0.38039]
Epoch 19 [26.8s + 12.6s]: train==[2.40870 = 0.16525 + 2.24346], recall= [ 0.02589  0.08386  0.12263  0.14807] , precision= [ 0.02870  0.01861  0.01365  0.01096] , auc=[0.77678], sum_recall=[0.38046]
Epoch 20 [26.6s + 12.1s]: train==[2.40051 = 0.16057 + 2.23994], recall= [ 0.02372  0.08350  0.12089  0.15122] , precision= [ 0.02609  0.01878  0.01348  0.01125] , auc=[0.77808], sum_recall=[0.37934]
Epoch 21 [26.8s + 12.2s]: train==[2.39700 = 0.16022 + 2.23678], recall= [ 0.02329  0.08872  0.12437  0.15165] , precision= [ 0.02609  0.01983  0.01383  0.01125] , auc=[0.77879], sum_recall=[0.38803]
Epoch 22 [26.5s + 12.0s]: train==[2.39015 = 0.15618 + 2.23397], recall= [ 0.02401  0.08785  0.12611  0.15079] , precision= [ 0.02609  0.01965  0.01400  0.01119] , auc=[0.77944], sum_recall=[0.38876]
Epoch 23 [26.6s + 12.1s]: train==[2.37960 = 0.14815 + 2.23145], recall= [ 0.02227  0.09017  0.12626  0.15470] , precision= [ 0.02435  0.02000  0.01400  0.01148] , auc=[0.78051], sum_recall=[0.39339]
Epoch 24 [26.6s + 12.8s]: train==[2.37028 = 0.14105 + 2.22923], recall= [ 0.02314  0.08669  0.12872  0.15155] , precision= [ 0.02522  0.01930  0.01426  0.01119] , auc=[0.78057], sum_recall=[0.39010]
Epoch 25 [26.5s + 12.1s]: train==[2.37396 = 0.14670 + 2.22726], recall= [ 0.02314  0.08785  0.12981  0.15372] , precision= [ 0.02522  0.01965  0.01435  0.01136] , auc=[0.78095], sum_recall=[0.39452]
Epoch 26 [26.6s + 12.0s]: train==[2.36751 = 0.14207 + 2.22544], recall= [ 0.02227  0.09104  0.12930  0.15502] , precision= [ 0.02435  0.02017  0.01426  0.01142] , auc=[0.78136], sum_recall=[0.39763]
Epoch 27 [26.6s + 13.1s]: train==[2.36038 = 0.13672 + 2.22366], recall= [ 0.02184  0.09002  0.13133  0.15720] , precision= [ 0.02348  0.02000  0.01461  0.01159] , auc=[0.78183], sum_recall=[0.40039]
Epoch 28 [26.7s + 13.3s]: train==[2.35700 = 0.13490 + 2.22210], recall= [ 0.02053  0.09002  0.12698  0.15575] , precision= [ 0.02261  0.02000  0.01417  0.01148] , auc=[0.78247], sum_recall=[0.39329]
Epoch 29 [26.7s + 13.0s]: train==[2.35006 = 0.12937 + 2.22069], recall= [ 0.02053  0.08829  0.12647  0.15705] , precision= [ 0.02261  0.01965  0.01400  0.01159] , auc=[0.78195], sum_recall=[0.39234]
Epoch 30 [27.1s + 12.7s]: train==[2.35233 = 0.13282 + 2.21951], recall= [ 0.02271  0.09089  0.12234  0.15930] , precision= [ 0.02609  0.02017  0.01357  0.01188] , auc=[0.78074], sum_recall=[0.39524]
Epoch 31 [27.2s + 13.0s]: train==[2.34364 = 0.12529 + 2.21835], recall= [ 0.02343  0.08915  0.12300  0.15626] , precision= [ 0.02609  0.01983  0.01374  0.01165] , auc=[0.78096], sum_recall=[0.39184]
Epoch 32 [26.8s + 13.0s]: train==[2.34203 = 0.12479 + 2.21725], recall= [ 0.02246  0.08973  0.12423  0.15973] , precision= [ 0.02435  0.01983  0.01391  0.01188] , auc=[0.78172], sum_recall=[0.39616]
Epoch 33 [27.0s + 12.8s]: train==[2.33321 = 0.11730 + 2.21591], recall= [ 0.02377  0.09075  0.12394  0.15716] , precision= [ 0.02522  0.02000  0.01391  0.01177] , auc=[0.78337], sum_recall=[0.39562]
Epoch 34 [27.0s + 13.3s]: train==[2.33082 = 0.11655 + 2.21427], recall= [ 0.02507  0.09401  0.12492  0.15702] , precision= [ 0.02696  0.02087  0.01409  0.01183] , auc=[0.78124], sum_recall=[0.40101]
Epoch 35 [26.7s + 12.6s]: train==[2.32339 = 0.11106 + 2.21233], recall= [ 0.02681  0.08879  0.12702  0.15676] , precision= [ 0.02870  0.01983  0.01435  0.01177] , auc=[0.78043], sum_recall=[0.39938]
Epoch 36 [29.9s + 12.3s]: train==[2.31536 = 0.10537 + 2.20999], recall= [ 0.02464  0.08966  0.12832  0.15816] , precision= [ 0.02609  0.02000  0.01452  0.01194] , auc=[0.78007], sum_recall=[0.40078]
Epoch 37 [29.3s + 12.6s]: train==[2.31688 = 0.10967 + 2.20722], recall= [ 0.02464  0.09024  0.12981  0.15903] , precision= [ 0.02609  0.02000  0.01470  0.01200] , auc=[0.77945], sum_recall=[0.40371]
Epoch 38 [26.7s + 13.1s]: train==[2.31116 = 0.10746 + 2.20370], recall= [ 0.02464  0.08763  0.12661  0.15598] , precision= [ 0.02609  0.01930  0.01452  0.01183] , auc=[0.77846], sum_recall=[0.39486]
Epoch 39 [26.7s + 12.2s]: train==[2.30825 = 0.10899 + 2.19926], recall= [ 0.02551  0.08850  0.12940  0.15468] , precision= [ 0.02696  0.01948  0.01461  0.01171] , auc=[0.77829], sum_recall=[0.39809]
Epoch 40 [26.7s + 12.2s]: train==[2.29129 = 0.09741 + 2.19388], recall= [ 0.02551  0.08763  0.12907  0.15656] , precision= [ 0.02696  0.01930  0.01461  0.01177] , auc=[0.77950], sum_recall=[0.39878]
Epoch 41 [26.5s + 12.3s]: train==[2.29370 = 0.10636 + 2.18734], recall= [ 0.02638  0.09227  0.13136  0.15671] , precision= [ 0.02783  0.02035  0.01461  0.01183] , auc=[0.77911], sum_recall=[0.40672]
Epoch 42 [26.6s + 13.1s]: train==[2.28402 = 0.10384 + 2.18018], recall= [ 0.02565  0.08836  0.13093  0.15656] , precision= [ 0.02696  0.01965  0.01470  0.01171] , auc=[0.77849], sum_recall=[0.40150]
Epoch 43 [26.7s + 12.9s]: train==[2.27050 = 0.09793 + 2.17256], recall= [ 0.02609  0.08618  0.13301  0.15569] , precision= [ 0.02696  0.01913  0.01496  0.01165] , auc=[0.77806], sum_recall=[0.40098]
End of trainning! Best recall= [ 0.02377  0.09075  0.12394  0.15716] , precision= [ 0.02522  0.02000  0.01391  0.01177] , auc=[0.78337]
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross0', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200,200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-25 17:15:35
loading data...
[n_users, n_items]=[3209, 12331]
[n_train, n_test]=[2636, 1318]
[n_edges]=[260034]
Using GPU 0,  memory_free: 24265
tensor([ 0.0272, -0.0122, -0.0269,  0.0260,  0.0155], device='cuda:0')
Loading Model..Number of Model Parameters:  3509402
Epoch 0 [26.4s + 8.5s]: train==[4.94087 = 2.62478 + 2.31608], recall= [ 0.00826  0.01978  0.02326  0.02761] , precision= [ 0.00870  0.00435  0.00252  0.00197] , auc=[0.56311], sum_recall=[0.07891]
Epoch 1 [26.6s + 8.9s]: train==[3.33120 = 1.01587 + 2.31533], recall= [ 0.01558  0.06580  0.09558  0.11089] , precision= [ 0.01826  0.01496  0.01052  0.00812] , auc=[0.67763], sum_recall=[0.28785]
Epoch 2 [26.5s + 9.3s]: train==[2.89888 = 0.58480 + 2.31408], recall= [ 0.01486  0.07688  0.10442  0.12461] , precision= [ 0.01739  0.01757  0.01165  0.00933] , auc=[0.71801], sum_recall=[0.32077]
Epoch 3 [27.3s + 10.4s]: train==[2.75175 = 0.43988 + 2.31188], recall= [ 0.02094  0.07495  0.10872  0.13000] , precision= [ 0.02348  0.01704  0.01226  0.00986] , auc=[0.73888], sum_recall=[0.33462]
Epoch 4 [26.9s + 10.6s]: train==[2.66408 = 0.35542 + 2.30867], recall= [ 0.02435  0.07771  0.10857  0.13287] , precision= [ 0.02696  0.01774  0.01226  0.01009] , auc=[0.74960], sum_recall=[0.34350]
Epoch 5 [26.9s + 11.4s]: train==[2.62126 = 0.31674 + 2.30451], recall= [ 0.02159  0.07937  0.11278  0.13159] , precision= [ 0.02348  0.01774  0.01278  0.01009] , auc=[0.75415], sum_recall=[0.34534]
Epoch 6 [26.9s + 10.7s]: train==[2.58965 = 0.28997 + 2.29968], recall= [ 0.02014  0.07684  0.11302  0.13058] , precision= [ 0.02261  0.01722  0.01287  0.01003] , auc=[0.75703], sum_recall=[0.34058]
Epoch 7 [27.0s + 11.7s]: train==[2.56561 = 0.27100 + 2.29461], recall= [ 0.02174  0.07382  0.10882  0.12986] , precision= [ 0.02348  0.01687  0.01235  0.00986] , auc=[0.76040], sum_recall=[0.33424]
Epoch 8 [26.7s + 10.6s]: train==[2.54607 = 0.25637 + 2.28970], recall= [ 0.02275  0.07498  0.11121  0.13682] , precision= [ 0.02522  0.01722  0.01252  0.01032] , auc=[0.76360], sum_recall=[0.34576]
Epoch 9 [26.6s + 10.8s]: train==[2.52603 = 0.24086 + 2.28517], recall= [ 0.02232  0.07824  0.11368  0.14029] , precision= [ 0.02435  0.01774  0.01287  0.01055] , auc=[0.76676], sum_recall=[0.35453]
Epoch 10 [26.7s + 10.8s]: train==[2.51599 = 0.23500 + 2.28099], recall= [ 0.02188  0.07556  0.11602  0.14058] , precision= [ 0.02435  0.01722  0.01313  0.01055] , auc=[0.76908], sum_recall=[0.35405]
Epoch 11 [26.6s + 10.3s]: train==[2.49783 = 0.22096 + 2.27687], recall= [ 0.02319  0.07672  0.11723  0.14406] , precision= [ 0.02522  0.01757  0.01322  0.01072] , auc=[0.76964], sum_recall=[0.36120]
Epoch 12 [26.8s + 10.4s]: train==[2.48490 = 0.21213 + 2.27277], recall= [ 0.02232  0.07998  0.12324  0.14471] , precision= [ 0.02435  0.01809  0.01365  0.01072] , auc=[0.77148], sum_recall=[0.37026]
Epoch 13 [26.8s + 10.6s]: train==[2.46525 = 0.19652 + 2.26872], recall= [ 0.02232  0.08172  0.12281  0.14776] , precision= [ 0.02435  0.01843  0.01365  0.01090] , auc=[0.77307], sum_recall=[0.37460]
Epoch 14 [26.6s + 10.4s]: train==[2.46065 = 0.19584 + 2.26481], recall= [ 0.02232  0.08194  0.12513  0.14776] , precision= [ 0.02435  0.01861  0.01383  0.01090] , auc=[0.77356], sum_recall=[0.37714]
Epoch 15 [26.7s + 10.6s]: train==[2.44935 = 0.18815 + 2.26120], recall= [ 0.02145  0.08476  0.12426  0.15022] , precision= [ 0.02348  0.01913  0.01374  0.01113] , auc=[0.77368], sum_recall=[0.38069]
Epoch 16 [26.6s + 10.3s]: train==[2.43772 = 0.18004 + 2.25768], recall= [ 0.02217  0.08679  0.12744  0.15051] , precision= [ 0.02522  0.01965  0.01400  0.01119] , auc=[0.77409], sum_recall=[0.38692]
Epoch 17 [26.5s + 10.1s]: train==[2.42669 = 0.17256 + 2.25413], recall= [ 0.02217  0.08836  0.12643  0.15109] , precision= [ 0.02522  0.01983  0.01391  0.01119] , auc=[0.77396], sum_recall=[0.38805]
Epoch 18 [26.7s + 10.7s]: train==[2.41655 = 0.16627 + 2.25028], recall= [ 0.02217  0.08705  0.12585  0.15218] , precision= [ 0.02522  0.01948  0.01391  0.01130] , auc=[0.77615], sum_recall=[0.38726]
Epoch 19 [26.9s + 10.8s]: train==[2.41203 = 0.16551 + 2.24652], recall= [ 0.02043  0.08444  0.13013  0.15116] , precision= [ 0.02348  0.01896  0.01452  0.01125] , auc=[0.77721], sum_recall=[0.38617]
Epoch 20 [26.6s + 10.6s]: train==[2.40182 = 0.15900 + 2.24282], recall= [ 0.02043  0.09162  0.12865  0.14866] , precision= [ 0.02348  0.02052  0.01426  0.01113] , auc=[0.77761], sum_recall=[0.38936]
Epoch 21 [26.9s + 10.4s]: train==[2.39541 = 0.15612 + 2.23929], recall= [ 0.02217  0.09097  0.13180  0.14903] , precision= [ 0.02522  0.02017  0.01470  0.01113] , auc=[0.77793], sum_recall=[0.39397]
Epoch 22 [26.6s + 10.7s]: train==[2.38834 = 0.15253 + 2.23581], recall= [ 0.02029  0.09397  0.12868  0.15124] , precision= [ 0.02261  0.02104  0.01426  0.01142] , auc=[0.77945], sum_recall=[0.39418]
Epoch 23 [26.8s + 10.6s]: train==[2.38082 = 0.14863 + 2.23219], recall= [ 0.02130  0.09136  0.12521  0.15124] , precision= [ 0.02435  0.02052  0.01383  0.01142] , auc=[0.78035], sum_recall=[0.38911]
Epoch 24 [26.6s + 10.9s]: train==[2.36660 = 0.13808 + 2.22852], recall= [ 0.02130  0.08934  0.12825  0.14889] , precision= [ 0.02435  0.02000  0.01417  0.01119] , auc=[0.78109], sum_recall=[0.38778]
Epoch 25 [26.5s + 10.5s]: train==[2.36593 = 0.14129 + 2.22464], recall= [ 0.02130  0.08934  0.12977  0.14816] , precision= [ 0.02435  0.02000  0.01426  0.01113] , auc=[0.77992], sum_recall=[0.38857]
Epoch 26 [26.7s + 10.6s]: train==[2.35997 = 0.13949 + 2.22048], recall= [ 0.02232  0.09107  0.12749  0.14918] , precision= [ 0.02522  0.02035  0.01417  0.01113] , auc=[0.78038], sum_recall=[0.39006]
Epoch 27 [26.6s + 10.6s]: train==[2.34925 = 0.13353 + 2.21573], recall= [ 0.02232  0.09151  0.12778  0.14903] , precision= [ 0.02522  0.02035  0.01426  0.01119] , auc=[0.78074], sum_recall=[0.39064]
Epoch 28 [26.6s + 10.9s]: train==[2.34471 = 0.13397 + 2.21074], recall= [ 0.02232  0.09151  0.12843  0.15338] , precision= [ 0.02435  0.02035  0.01443  0.01148] , auc=[0.78137], sum_recall=[0.39564]
Epoch 29 [26.7s + 10.3s]: train==[2.33278 = 0.12753 + 2.20525], recall= [ 0.02319  0.09010  0.12865  0.15556] , precision= [ 0.02522  0.02000  0.01443  0.01165] , auc=[0.78108], sum_recall=[0.39749]
Epoch 30 [26.6s + 10.2s]: train==[2.32935 = 0.12977 + 2.19958], recall= [ 0.02319  0.08749  0.12589  0.15425] , precision= [ 0.02522  0.01948  0.01435  0.01159] , auc=[0.77989], sum_recall=[0.39082]
Epoch 31 [26.6s + 10.9s]: train==[2.31761 = 0.12417 + 2.19344], recall= [ 0.02145  0.08923  0.12173  0.15214] , precision= [ 0.02348  0.01983  0.01374  0.01154] , auc=[0.77867], sum_recall=[0.38455]
Epoch 32 [26.7s + 11.0s]: train==[2.31130 = 0.12426 + 2.18704], recall= [ 0.02043  0.08568  0.12255  0.15043] , precision= [ 0.02261  0.01913  0.01383  0.01154] , auc=[0.78046], sum_recall=[0.37910]
Epoch 33 [26.8s + 11.1s]: train==[2.29539 = 0.11541 + 2.17999], recall= [ 0.02130  0.09013  0.12560  0.15058] , precision= [ 0.02348  0.02017  0.01417  0.01142] , auc=[0.78043], sum_recall=[0.38761]
Epoch 34 [26.7s + 10.7s]: train==[2.28959 = 0.11656 + 2.17302], recall= [ 0.02203  0.09042  0.12560  0.15079] , precision= [ 0.02348  0.02035  0.01417  0.01148] , auc=[0.78090], sum_recall=[0.38884]
Epoch 35 [26.6s + 10.3s]: train==[2.27554 = 0.10989 + 2.16565], recall= [ 0.02290  0.08915  0.12453  0.15217] , precision= [ 0.02609  0.01983  0.01435  0.01154] , auc=[0.78060], sum_recall=[0.38876]
Epoch 36 [26.8s + 10.5s]: train==[2.26463 = 0.10615 + 2.15848], recall= [ 0.02333  0.08742  0.12801  0.15435] , precision= [ 0.02522  0.01948  0.01470  0.01171] , auc=[0.78002], sum_recall=[0.39311]
Epoch 37 [26.5s + 10.8s]: train==[2.26133 = 0.10987 + 2.15145], recall= [ 0.02290  0.08611  0.12381  0.15217] , precision= [ 0.02435  0.01930  0.01417  0.01154] , auc=[0.78068], sum_recall=[0.38499]
Epoch 38 [26.6s + 10.8s]: train==[2.25339 = 0.10855 + 2.14484], recall= [ 0.02290  0.08713  0.12653  0.15229] , precision= [ 0.02435  0.01930  0.01443  0.01159] , auc=[0.78047], sum_recall=[0.38885]
End of trainning! Best recall= [ 0.02232  0.09151  0.12843  0.15338] , precision= [ 0.02435  0.02035  0.01443  0.01148] , auc=[0.78137]
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross0', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200,200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-25 17:39:53
loading data...
[n_users, n_items]=[3209, 12331]
[n_train, n_test]=[2636, 1318]
[n_edges]=[260034]
Using GPU 0,  memory_free: 24265
tensor([-0.0120, -0.0347,  0.0281, -0.0235, -0.0137], device='cuda:0')
Loading Model..Number of Model Parameters:  3509402
Epoch 0 [26.2s + 9.1s]: train==[4.95330 = 2.63026 + 2.32304], recall= [ 0.01283  0.02210  0.02471  0.02862] , precision= [ 0.01391  0.00487  0.00270  0.00209] , auc=[0.56182], sum_recall=[0.08826]
Epoch 1 [27.1s + 9.0s]: train==[3.34258 = 1.02049 + 2.32209], recall= [ 0.01899  0.06749  0.09778  0.11831] , precision= [ 0.02087  0.01530  0.01078  0.00875] , auc=[0.67256], sum_recall=[0.30257]
Epoch 2 [26.4s + 10.1s]: train==[2.92519 = 0.60487 + 2.32032], recall= [ 0.01761  0.08024  0.11853  0.13833] , precision= [ 0.02000  0.01809  0.01330  0.01038] , auc=[0.70857], sum_recall=[0.35471]
Epoch 3 [26.5s + 10.8s]: train==[2.76798 = 0.45045 + 2.31753], recall= [ 0.02130  0.08155  0.11664  0.13914] , precision= [ 0.02348  0.01809  0.01330  0.01055] , auc=[0.73306], sum_recall=[0.35863]
Epoch 4 [26.4s + 10.8s]: train==[2.67535 = 0.36167 + 2.31367], recall= [ 0.02217  0.08575  0.11722  0.14464] , precision= [ 0.02435  0.01896  0.01330  0.01084] , auc=[0.74489], sum_recall=[0.36979]
Epoch 5 [26.4s + 11.2s]: train==[2.63797 = 0.32911 + 2.30886], recall= [ 0.02623  0.09031  0.11809  0.14305] , precision= [ 0.02870  0.01983  0.01339  0.01078] , auc=[0.75242], sum_recall=[0.37769]
Epoch 6 [26.3s + 11.2s]: train==[2.60213 = 0.29872 + 2.30341], recall= [ 0.02488  0.08162  0.11809  0.14218] , precision= [ 0.02870  0.01809  0.01330  0.01072] , auc=[0.75710], sum_recall=[0.36677]
Epoch 7 [26.3s + 10.6s]: train==[2.57010 = 0.27230 + 2.29780], recall= [ 0.02589  0.08271  0.11896  0.14392] , precision= [ 0.02870  0.01809  0.01339  0.01084] , auc=[0.76016], sum_recall=[0.37148]
Epoch 8 [26.3s + 11.0s]: train==[2.55439 = 0.26195 + 2.29244], recall= [ 0.02502  0.07633  0.11671  0.14518] , precision= [ 0.02783  0.01670  0.01304  0.01101] , auc=[0.76291], sum_recall=[0.36325]
Epoch 9 [26.3s + 10.9s]: train==[2.52817 = 0.24072 + 2.28745], recall= [ 0.02676  0.07988  0.11961  0.14761] , precision= [ 0.02957  0.01774  0.01339  0.01113] , auc=[0.76583], sum_recall=[0.37387]
Epoch 10 [26.4s + 11.3s]: train==[2.51863 = 0.23582 + 2.28280], recall= [ 0.02406  0.08056  0.11962  0.15083] , precision= [ 0.02609  0.01826  0.01339  0.01136] , auc=[0.76825], sum_recall=[0.37507]
Epoch 11 [26.3s + 11.0s]: train==[2.50635 = 0.22814 + 2.27821], recall= [ 0.02589  0.07860  0.12527  0.15250] , precision= [ 0.02870  0.01774  0.01391  0.01136] , auc=[0.77120], sum_recall=[0.38227]
Epoch 12 [26.9s + 10.9s]: train==[2.49289 = 0.21929 + 2.27360], recall= [ 0.02329  0.08230  0.12614  0.15224] , precision= [ 0.02609  0.01861  0.01400  0.01148] , auc=[0.77282], sum_recall=[0.38396]
Epoch 13 [26.3s + 11.1s]: train==[2.46784 = 0.19876 + 2.26908], recall= [ 0.02242  0.08150  0.12875  0.15279] , precision= [ 0.02522  0.01843  0.01426  0.01136] , auc=[0.77450], sum_recall=[0.38545]
Epoch 14 [26.2s + 11.2s]: train==[2.46178 = 0.19709 + 2.26470], recall= [ 0.02145  0.08208  0.12802  0.15047] , precision= [ 0.02348  0.01843  0.01426  0.01125] , auc=[0.77522], sum_recall=[0.38202]
Epoch 15 [26.3s + 11.1s]: train==[2.45408 = 0.19351 + 2.26057], recall= [ 0.02232  0.08426  0.12585  0.16003] , precision= [ 0.02435  0.01913  0.01400  0.01188] , auc=[0.77527], sum_recall=[0.39246]
Epoch 16 [26.5s + 11.5s]: train==[2.44031 = 0.18377 + 2.25653], recall= [ 0.02232  0.08321  0.12585  0.15156] , precision= [ 0.02435  0.01878  0.01400  0.01136] , auc=[0.77598], sum_recall=[0.38294]
Epoch 17 [26.6s + 11.2s]: train==[2.43245 = 0.18011 + 2.25235], recall= [ 0.02319  0.08872  0.12657  0.15329] , precision= [ 0.02522  0.02000  0.01409  0.01148] , auc=[0.77603], sum_recall=[0.39178]
Epoch 18 [26.3s + 11.3s]: train==[2.41826 = 0.17031 + 2.24794], recall= [ 0.02145  0.08481  0.12872  0.15735] , precision= [ 0.02348  0.01913  0.01417  0.01171] , auc=[0.77631], sum_recall=[0.39233]
Epoch 19 [26.6s + 11.3s]: train==[2.41112 = 0.16742 + 2.24370], recall= [ 0.02304  0.08973  0.13031  0.15648] , precision= [ 0.02609  0.02000  0.01435  0.01171] , auc=[0.77776], sum_recall=[0.39957]
Epoch 20 [26.4s + 11.0s]: train==[2.40459 = 0.16490 + 2.23969], recall= [ 0.02304  0.08329  0.12829  0.15729] , precision= [ 0.02609  0.01896  0.01409  0.01177] , auc=[0.77864], sum_recall=[0.39190]
Epoch 21 [26.4s + 10.8s]: train==[2.39798 = 0.16197 + 2.23601], recall= [ 0.02391  0.08850  0.12944  0.16052] , precision= [ 0.02696  0.02000  0.01426  0.01200] , auc=[0.77985], sum_recall=[0.40238]
Epoch 22 [26.3s + 11.0s]: train==[2.39094 = 0.15839 + 2.23256], recall= [ 0.02551  0.08865  0.13042  0.15939] , precision= [ 0.02783  0.02000  0.01452  0.01194] , auc=[0.78033], sum_recall=[0.40397]
Epoch 23 [26.5s + 11.2s]: train==[2.38262 = 0.15338 + 2.22925], recall= [ 0.02377  0.09050  0.12999  0.15932] , precision= [ 0.02609  0.02052  0.01452  0.01194] , auc=[0.78124], sum_recall=[0.40357]
Epoch 24 [26.4s + 11.3s]: train==[2.36885 = 0.14270 + 2.22615], recall= [ 0.02464  0.08778  0.13057  0.16279] , precision= [ 0.02696  0.01983  0.01470  0.01223] , auc=[0.78108], sum_recall=[0.40578]
Epoch 25 [26.5s + 10.8s]: train==[2.37111 = 0.14794 + 2.22317], recall= [ 0.02333  0.08702  0.13296  0.16349] , precision= [ 0.02522  0.01983  0.01487  0.01223] , auc=[0.78033], sum_recall=[0.40680]
Epoch 26 [26.4s + 10.9s]: train==[2.36549 = 0.14542 + 2.22007], recall= [ 0.02420  0.08865  0.13165  0.15878] , precision= [ 0.02609  0.02000  0.01478  0.01188] , auc=[0.78116], sum_recall=[0.40329]
Epoch 27 [26.6s + 10.8s]: train==[2.35465 = 0.13803 + 2.21662], recall= [ 0.02377  0.08463  0.13644  0.16421] , precision= [ 0.02522  0.01913  0.01522  0.01229] , auc=[0.78085], sum_recall=[0.40905]
Epoch 28 [26.3s + 10.9s]: train==[2.35132 = 0.13817 + 2.21316], recall= [ 0.02304  0.08626  0.13107  0.16421] , precision= [ 0.02435  0.01930  0.01461  0.01229] , auc=[0.78171], sum_recall=[0.40459]
Epoch 29 [26.6s + 11.0s]: train==[2.33998 = 0.13055 + 2.20942], recall= [ 0.02507  0.08771  0.13383  0.16378] , precision= [ 0.02696  0.01948  0.01496  0.01229] , auc=[0.78293], sum_recall=[0.41039]
Epoch 30 [26.5s + 10.9s]: train==[2.33900 = 0.13353 + 2.20547], recall= [ 0.02420  0.08886  0.13349  0.16233] , precision= [ 0.02609  0.01983  0.01504  0.01223] , auc=[0.78320], sum_recall=[0.40889]
Epoch 31 [26.3s + 11.2s]: train==[2.32691 = 0.12593 + 2.20098], recall= [ 0.02507  0.09028  0.12675  0.16120] , precision= [ 0.02696  0.02035  0.01443  0.01217] , auc=[0.78223], sum_recall=[0.40330]
Epoch 32 [26.5s + 11.3s]: train==[2.32056 = 0.12453 + 2.19603], recall= [ 0.02493  0.08738  0.12820  0.15903] , precision= [ 0.02696  0.01965  0.01452  0.01206] , auc=[0.78207], sum_recall=[0.39953]
Epoch 33 [26.5s + 11.2s]: train==[2.30893 = 0.11897 + 2.18996], recall= [ 0.02667  0.08618  0.12864  0.15903] , precision= [ 0.02870  0.01948  0.01461  0.01206] , auc=[0.78241], sum_recall=[0.40051]
Epoch 34 [26.5s + 11.0s]: train==[2.30163 = 0.11817 + 2.18346], recall= [ 0.02594  0.08850  0.12675  0.16178] , precision= [ 0.02783  0.01983  0.01426  0.01223] , auc=[0.78247], sum_recall=[0.40298]
Epoch 35 [26.5s + 11.0s]: train==[2.28969 = 0.11337 + 2.17632], recall= [ 0.02623  0.08800  0.12921  0.15871] , precision= [ 0.02870  0.01983  0.01461  0.01194] , auc=[0.78254], sum_recall=[0.40215]
Epoch 36 [26.3s + 10.7s]: train==[2.27632 = 0.10739 + 2.16893], recall= [ 0.02449  0.08959  0.12302  0.15835] , precision= [ 0.02696  0.02000  0.01391  0.01188] , auc=[0.78192], sum_recall=[0.39545]
Epoch 37 [26.4s + 11.3s]: train==[2.27419 = 0.11270 + 2.16149], recall= [ 0.02580  0.08691  0.12708  0.15305] , precision= [ 0.02783  0.01930  0.01435  0.01159] , auc=[0.78114], sum_recall=[0.39283]
Epoch 38 [26.6s + 11.5s]: train==[2.26370 = 0.10951 + 2.15420], recall= [ 0.02754  0.08705  0.12585  0.15392] , precision= [ 0.02957  0.01930  0.01417  0.01165] , auc=[0.78104], sum_recall=[0.39435]
Epoch 39 [26.6s + 11.7s]: train==[2.25880 = 0.11162 + 2.14718], recall= [ 0.02667  0.08444  0.12604  0.15566] , precision= [ 0.02870  0.01878  0.01417  0.01177] , auc=[0.78076], sum_recall=[0.39281]
Epoch 40 [27.0s + 11.5s]: train==[2.24367 = 0.10294 + 2.14073], recall= [ 0.02667  0.08531  0.12662  0.15428] , precision= [ 0.02870  0.01896  0.01409  0.01171] , auc=[0.78122], sum_recall=[0.39288]
End of trainning! Best recall= [ 0.02420  0.08886  0.13349  0.16233] , precision= [ 0.02609  0.01983  0.01504  0.01223] , auc=[0.78320]
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross0', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200,200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-25 18:05:35
loading data...
[n_users, n_items]=[3209, 12331]
[n_train, n_test]=[2636, 1318]
[n_edges]=[260034]
Using GPU 0,  memory_free: 24265
tensor([-0.0361, -0.0353,  0.0278, -0.0173, -0.0079], device='cuda:0')
Loading Model..Number of Model Parameters:  3509402
Epoch 0 [26.3s + 10.0s]: train==[4.96810 = 2.65143 + 2.31667], recall= [ 0.00717  0.01587  0.01848  0.02022] , precision= [ 0.00783  0.00348  0.00200  0.00145] , auc=[0.56223], sum_recall=[0.06174]
Epoch 1 [26.2s + 10.0s]: train==[3.34470 = 1.02898 + 2.31572], recall= [ 0.02297  0.07256  0.09727  0.12309] , precision= [ 0.02522  0.01600  0.01078  0.00904] , auc=[0.68162], sum_recall=[0.31589]
Epoch 2 [26.1s + 10.4s]: train==[2.90185 = 0.58764 + 2.31421], recall= [ 0.02514  0.07280  0.11490  0.13998] , precision= [ 0.02783  0.01635  0.01278  0.01038] , auc=[0.72106], sum_recall=[0.35283]
Epoch 3 [26.1s + 11.4s]: train==[2.76766 = 0.45590 + 2.31176], recall= [ 0.02261  0.08353  0.12085  0.14447] , precision= [ 0.02522  0.01878  0.01348  0.01078] , auc=[0.74377], sum_recall=[0.37145]
Epoch 4 [27.1s + 11.2s]: train==[2.66966 = 0.36130 + 2.30835], recall= [ 0.02676  0.08647  0.12200  0.14954] , precision= [ 0.02957  0.01930  0.01374  0.01113] , auc=[0.75776], sum_recall=[0.38478]
Epoch 5 [26.5s + 11.7s]: train==[2.63125 = 0.32717 + 2.30408], recall= [ 0.02807  0.08430  0.12466  0.15139] , precision= [ 0.03130  0.01896  0.01400  0.01130] , auc=[0.76336], sum_recall=[0.38842]
Epoch 6 [26.2s + 11.5s]: train==[2.60226 = 0.30302 + 2.29923], recall= [ 0.02415  0.08792  0.12524  0.14791] , precision= [ 0.02696  0.01965  0.01400  0.01107] , auc=[0.76581], sum_recall=[0.38523]
Epoch 7 [26.6s + 11.3s]: train==[2.57238 = 0.27812 + 2.29427], recall= [ 0.02589  0.08589  0.12807  0.15000] , precision= [ 0.02870  0.01948  0.01417  0.01125] , auc=[0.76685], sum_recall=[0.38986]
Epoch 8 [26.3s + 11.6s]: train==[2.55138 = 0.26193 + 2.28945], recall= [ 0.02502  0.08075  0.12824  0.15446] , precision= [ 0.02783  0.01791  0.01426  0.01154] , auc=[0.76853], sum_recall=[0.38848]
Epoch 9 [27.9s + 11.7s]: train==[2.52849 = 0.24358 + 2.28492], recall= [ 0.02609  0.08179  0.13153  0.15084] , precision= [ 0.02870  0.01826  0.01478  0.01136] , auc=[0.77055], sum_recall=[0.39024]
Epoch 10 [26.7s + 12.0s]: train==[2.52068 = 0.24010 + 2.28059], recall= [ 0.02348  0.08049  0.12921  0.15316] , precision= [ 0.02609  0.01791  0.01443  0.01148] , auc=[0.77313], sum_recall=[0.38633]
Epoch 11 [26.6s + 12.7s]: train==[2.50154 = 0.22535 + 2.27619], recall= [ 0.02174  0.08031  0.12500  0.15348] , precision= [ 0.02435  0.01774  0.01409  0.01148] , auc=[0.77485], sum_recall=[0.38054]
Epoch 12 [26.2s + 11.4s]: train==[2.48880 = 0.21702 + 2.27178], recall= [ 0.02261  0.07771  0.12544  0.15566] , precision= [ 0.02522  0.01722  0.01417  0.01159] , auc=[0.77704], sum_recall=[0.38141]
Epoch 13 [26.2s + 11.4s]: train==[2.46436 = 0.19685 + 2.26751], recall= [ 0.02174  0.08249  0.13022  0.15696] , precision= [ 0.02435  0.01826  0.01470  0.01171] , auc=[0.77861], sum_recall=[0.39141]
Epoch 14 [26.3s + 12.3s]: train==[2.46024 = 0.19687 + 2.26337], recall= [ 0.02174  0.08597  0.13160  0.16055] , precision= [ 0.02435  0.01913  0.01478  0.01200] , auc=[0.77912], sum_recall=[0.39985]
Epoch 15 [26.5s + 11.7s]: train==[2.45154 = 0.19218 + 2.25937], recall= [ 0.01797  0.08640  0.12907  0.15620] , precision= [ 0.02000  0.01913  0.01461  0.01171] , auc=[0.77921], sum_recall=[0.38964]
Epoch 16 [26.4s + 11.7s]: train==[2.43908 = 0.18377 + 2.25531], recall= [ 0.02058  0.08376  0.12711  0.15559] , precision= [ 0.02261  0.01878  0.01435  0.01159] , auc=[0.77962], sum_recall=[0.38704]
Epoch 17 [26.4s + 11.2s]: train==[2.42648 = 0.17536 + 2.25113], recall= [ 0.01928  0.08281  0.12885  0.15777] , precision= [ 0.02087  0.01826  0.01452  0.01171] , auc=[0.78001], sum_recall=[0.38871]
Epoch 18 [26.2s + 11.4s]: train==[2.41329 = 0.16642 + 2.24686], recall= [ 0.02058  0.08419  0.12581  0.15806] , precision= [ 0.02261  0.01878  0.01417  0.01177] , auc=[0.78062], sum_recall=[0.38864]
Epoch 19 [27.9s + 14.3s]: train==[2.40916 = 0.16626 + 2.24291], recall= [ 0.02043  0.08506  0.12972  0.15979] , precision= [ 0.02348  0.01896  0.01452  0.01188] , auc=[0.78110], sum_recall=[0.39501]
Epoch 20 [26.9s + 11.7s]: train==[2.40392 = 0.16476 + 2.23916], recall= [ 0.02203  0.08658  0.13277  0.16081] , precision= [ 0.02522  0.01913  0.01487  0.01194] , auc=[0.78203], sum_recall=[0.40219]
Epoch 21 [27.9s + 14.1s]: train==[2.39698 = 0.16138 + 2.23561], recall= [ 0.02174  0.08760  0.13450  0.15994] , precision= [ 0.02435  0.01965  0.01504  0.01194] , auc=[0.78221], sum_recall=[0.40378]
Epoch 22 [26.9s + 13.1s]: train==[2.38963 = 0.15741 + 2.23221], recall= [ 0.02232  0.08651  0.13624  0.16458] , precision= [ 0.02435  0.01948  0.01522  0.01229] , auc=[0.78366], sum_recall=[0.40965]
Epoch 23 [26.6s + 13.2s]: train==[2.37888 = 0.15003 + 2.22885], recall= [ 0.02232  0.08339  0.13624  0.16371] , precision= [ 0.02435  0.01861  0.01522  0.01217] , auc=[0.78374], sum_recall=[0.40566]
Epoch 24 [26.8s + 12.1s]: train==[2.36932 = 0.14379 + 2.22553], recall= [ 0.02348  0.08455  0.13668  0.16037] , precision= [ 0.02609  0.01861  0.01530  0.01194] , auc=[0.78385], sum_recall=[0.40508]
Epoch 25 [32.2s + 13.5s]: train==[2.37049 = 0.14856 + 2.22194], recall= [ 0.02391  0.08847  0.13537  0.16016] , precision= [ 0.02696  0.01948  0.01513  0.01188] , auc=[0.78400], sum_recall=[0.40791]
Epoch 26 [26.9s + 13.8s]: train==[2.36160 = 0.14355 + 2.21804], recall= [ 0.02449  0.08760  0.13581  0.16190] , precision= [ 0.02696  0.01930  0.01513  0.01200] , auc=[0.78353], sum_recall=[0.40979]
Epoch 27 [26.0s + 11.1s]: train==[2.35212 = 0.13824 + 2.21388], recall= [ 0.02377  0.08861  0.13885  0.16190] , precision= [ 0.02609  0.01965  0.01548  0.01206] , auc=[0.78385], sum_recall=[0.41313]
Epoch 28 [26.1s + 11.4s]: train==[2.34702 = 0.13735 + 2.20967], recall= [ 0.02536  0.09024  0.14016  0.16081] , precision= [ 0.02783  0.01983  0.01565  0.01200] , auc=[0.78461], sum_recall=[0.41657]
Epoch 29 [26.2s + 11.0s]: train==[2.33504 = 0.13016 + 2.20488], recall= [ 0.02507  0.08524  0.13624  0.16016] , precision= [ 0.02696  0.01896  0.01522  0.01188] , auc=[0.78497], sum_recall=[0.40671]
Epoch 30 [26.1s + 11.0s]: train==[2.33465 = 0.13478 + 2.19987], recall= [ 0.02507  0.08502  0.13726  0.15893] , precision= [ 0.02696  0.01878  0.01530  0.01188] , auc=[0.78414], sum_recall=[0.40628]
Epoch 31 [26.5s + 11.5s]: train==[2.32003 = 0.12590 + 2.19413], recall= [ 0.02681  0.08589  0.13943  0.15842] , precision= [ 0.02870  0.01896  0.01548  0.01177] , auc=[0.78370], sum_recall=[0.41056]
Epoch 32 [26.3s + 11.3s]: train==[2.31308 = 0.12525 + 2.18783], recall= [ 0.02594  0.08807  0.14016  0.15871] , precision= [ 0.02783  0.01948  0.01565  0.01183] , auc=[0.78333], sum_recall=[0.41287]
Epoch 33 [26.2s + 11.9s]: train==[2.29845 = 0.11746 + 2.18098], recall= [ 0.02681  0.09155  0.13943  0.15929] , precision= [ 0.02870  0.02017  0.01548  0.01183] , auc=[0.78377], sum_recall=[0.41708]
Epoch 34 [26.0s + 12.0s]: train==[2.29189 = 0.11805 + 2.17385], recall= [ 0.02594  0.09155  0.13639  0.15798] , precision= [ 0.02783  0.02017  0.01522  0.01171] , auc=[0.78468], sum_recall=[0.41186]
Epoch 35 [26.1s + 11.1s]: train==[2.27522 = 0.10874 + 2.16648], recall= [ 0.02551  0.09361  0.13465  0.15755] , precision= [ 0.02696  0.02087  0.01504  0.01171] , auc=[0.78466], sum_recall=[0.41132]
Epoch 36 [26.8s + 11.9s]: train==[2.26498 = 0.10585 + 2.15913], recall= [ 0.02681  0.09252  0.13349  0.15685] , precision= [ 0.02870  0.02052  0.01487  0.01171] , auc=[0.78363], sum_recall=[0.40968]
Epoch 37 [26.4s + 12.0s]: train==[2.26267 = 0.11046 + 2.15221], recall= [ 0.02725  0.09513  0.13581  0.15349] , precision= [ 0.02870  0.02104  0.01504  0.01142] , auc=[0.78418], sum_recall=[0.41168]
Epoch 38 [26.3s + 12.1s]: train==[2.25289 = 0.10726 + 2.14563], recall= [ 0.02246  0.09332  0.13624  0.15562] , precision= [ 0.02348  0.02070  0.01513  0.01171] , auc=[0.78364], sum_recall=[0.40764]
Epoch 39 [26.3s + 10.9s]: train==[2.25132 = 0.11185 + 2.13947], recall= [ 0.02681  0.09202  0.13460  0.15402] , precision= [ 0.02783  0.02035  0.01504  0.01159] , auc=[0.78324], sum_recall=[0.40745]
End of trainning! Best recall= [ 0.02507  0.08524  0.13624  0.16016] , precision= [ 0.02696  0.01896  0.01522  0.01188] , auc=[0.78497]
Namespace(Ks=[1, 5, 10, 15], T=0.01, alpha=3.0, batch_size=512, beta=0.1, dataset='./OMIM/bigraph/cross0', dropout=0.3, emb_dim=200, gamma=0.1, gpu_id=-1, hid_dim=200, k=0.5, layer_size='[200,200]', learning_rate=0.005, mi_batch_size=1000, mi_kind='js', neg_num=5, num_epochs=1000, pretrain=None, reg=0.001, seed=-1, show_model_param=False, show_step=1, weight=None)
2021-12-25 18:31:19
loading data...
[n_users, n_items]=[3209, 12331]
[n_train, n_test]=[2636, 1318]
[n_edges]=[260034]
Using GPU 0,  memory_free: 24265
tensor([-0.0297,  0.0241,  0.0310,  0.0363, -0.0419], device='cuda:0')
Loading Model..Number of Model Parameters:  3509402
Epoch 0 [27.8s + 9.7s]: train==[4.95946 = 2.64165 + 2.31782], recall= [ 0.00928  0.01580  0.01971  0.01971] , precision= [ 0.01043  0.00365  0.00226  0.00151] , auc=[0.56526], sum_recall=[0.06449]
Epoch 1 [27.5s + 10.8s]: train==[3.34973 = 1.03275 + 2.31697], recall= [ 0.01442  0.06560  0.09838  0.10703] , precision= [ 0.01739  0.01461  0.01096  0.00800] , auc=[0.68073], sum_recall=[0.28543]
Epoch 2 [27.4s + 9.8s]: train==[2.91349 = 0.59804 + 2.31545], recall= [ 0.01993  0.06553  0.10428  0.13014] , precision= [ 0.02348  0.01530  0.01191  0.00974] , auc=[0.71421], sum_recall=[0.31988]
Epoch 3 [27.3s + 11.3s]: train==[2.77702 = 0.46411 + 2.31292], recall= [ 0.01877  0.07379  0.11114  0.13583] , precision= [ 0.02261  0.01722  0.01261  0.01026] , auc=[0.73211], sum_recall=[0.33952]
Epoch 4 [27.0s + 11.6s]: train==[2.67397 = 0.36458 + 2.30939], recall= [ 0.01988  0.07792  0.11447  0.13783] , precision= [ 0.02348  0.01809  0.01304  0.01055] , auc=[0.74211], sum_recall=[0.35010]
Epoch 5 [27.2s + 13.0s]: train==[2.63522 = 0.33028 + 2.30495], recall= [ 0.02162  0.07589  0.11389  0.13743] , precision= [ 0.02609  0.01757  0.01304  0.01055] , auc=[0.74779], sum_recall=[0.34883]
Epoch 6 [29.9s + 12.1s]: train==[2.59650 = 0.29660 + 2.29991], recall= [ 0.02379  0.07734  0.10493  0.13573] , precision= [ 0.02870  0.01809  0.01226  0.01038] , auc=[0.75077], sum_recall=[0.34180]
Epoch 7 [27.9s + 11.7s]: train==[2.56942 = 0.27471 + 2.29472], recall= [ 0.02394  0.07662  0.11051  0.13399] , precision= [ 0.02783  0.01774  0.01278  0.01014] , auc=[0.75447], sum_recall=[0.34506]
Epoch 8 [28.0s + 12.6s]: train==[2.55062 = 0.26089 + 2.28973], recall= [ 0.02481  0.07868  0.11290  0.14051] , precision= [ 0.02870  0.01826  0.01296  0.01061] , auc=[0.75674], sum_recall=[0.35690]
Epoch 9 [27.4s + 11.9s]: train==[2.52816 = 0.24305 + 2.28511], recall= [ 0.02379  0.07578  0.11493  0.14095] , precision= [ 0.02783  0.01757  0.01304  0.01061] , auc=[0.75919], sum_recall=[0.35545]
Epoch 10 [27.9s + 13.5s]: train==[2.51995 = 0.23920 + 2.28076], recall= [ 0.02271  0.07730  0.11935  0.14356] , precision= [ 0.02609  0.01774  0.01348  0.01078] , auc=[0.76077], sum_recall=[0.36291]
Epoch 11 [27.6s + 14.1s]: train==[2.50324 = 0.22683 + 2.27641], recall= [ 0.02213  0.07701  0.12044  0.14269] , precision= [ 0.02609  0.01757  0.01365  0.01072] , auc=[0.76304], sum_recall=[0.36226]
Epoch 12 [29.0s + 12.4s]: train==[2.48639 = 0.21430 + 2.27208], recall= [ 0.02203  0.07324  0.12131  0.14399] , precision= [ 0.02522  0.01687  0.01374  0.01078] , auc=[0.76500], sum_recall=[0.36057]
Epoch 13 [27.4s + 12.2s]: train==[2.46656 = 0.19874 + 2.26782], recall= [ 0.02116  0.08020  0.12116  0.14182] , precision= [ 0.02435  0.01843  0.01374  0.01067] , auc=[0.76597], sum_recall=[0.36434]
Epoch 14 [30.3s + 13.7s]: train==[2.46203 = 0.19832 + 2.26371], recall= [ 0.02174  0.07725  0.11914  0.14443] , precision= [ 0.02435  0.01791  0.01348  0.01084] , auc=[0.76645], sum_recall=[0.36255]
Epoch 15 [27.6s + 12.9s]: train==[2.45113 = 0.19127 + 2.25985], recall= [ 0.02145  0.07812  0.12377  0.14856] , precision= [ 0.02522  0.01809  0.01400  0.01107] , auc=[0.76734], sum_recall=[0.37190]
Epoch 16 [30.2s + 12.9s]: train==[2.43901 = 0.18290 + 2.25611], recall= [ 0.02174  0.07708  0.12729  0.15186] , precision= [ 0.02435  0.01774  0.01417  0.01125] , auc=[0.76802], sum_recall=[0.37797]
Epoch 17 [28.9s + 13.7s]: train==[2.42790 = 0.17560 + 2.25230], recall= [ 0.02217  0.07490  0.12744  0.15186] , precision= [ 0.02522  0.01722  0.01417  0.01125] , auc=[0.76820], sum_recall=[0.37638]
Epoch 18 [29.4s + 13.4s]: train==[2.41483 = 0.16651 + 2.24832], recall= [ 0.02217  0.07133  0.12700  0.14911] , precision= [ 0.02522  0.01635  0.01409  0.01113] , auc=[0.76889], sum_recall=[0.36961]
Epoch 19 [27.9s + 13.7s]: train==[2.41004 = 0.16548 + 2.24456], recall= [ 0.02246  0.07568  0.12614  0.15360] , precision= [ 0.02609  0.01722  0.01400  0.01136] , auc=[0.76957], sum_recall=[0.37787]
Epoch 20 [29.2s + 13.2s]: train==[2.40219 = 0.16112 + 2.24106], recall= [ 0.02217  0.07969  0.12773  0.15099] , precision= [ 0.02522  0.01809  0.01417  0.01125] , auc=[0.77014], sum_recall=[0.38058]
Epoch 21 [28.1s + 13.3s]: train==[2.39667 = 0.15875 + 2.23792], recall= [ 0.02304  0.08075  0.12816  0.15143] , precision= [ 0.02609  0.01826  0.01426  0.01130] , auc=[0.77105], sum_recall=[0.38338]
Epoch 22 [28.6s + 13.4s]: train==[2.39320 = 0.15809 + 2.23511], recall= [ 0.02261  0.07742  0.12773  0.15512] , precision= [ 0.02609  0.01757  0.01426  0.01159] , auc=[0.77171], sum_recall=[0.38287]
Epoch 23 [27.6s + 14.3s]: train==[2.38325 = 0.15075 + 2.23250], recall= [ 0.02261  0.08002  0.12787  0.15403] , precision= [ 0.02522  0.01809  0.01417  0.01142] , auc=[0.77210], sum_recall=[0.38454]
Epoch 24 [30.4s + 14.9s]: train==[2.37320 = 0.14300 + 2.23020], recall= [ 0.02217  0.08089  0.12729  0.15396] , precision= [ 0.02522  0.01826  0.01417  0.01154] , auc=[0.77224], sum_recall=[0.38432]
Epoch 25 [33.0s + 13.1s]: train==[2.37489 = 0.14677 + 2.22812], recall= [ 0.02261  0.08002  0.12744  0.15614] , precision= [ 0.02609  0.01809  0.01426  0.01165] , auc=[0.77195], sum_recall=[0.38621]
Epoch 26 [28.8s + 14.0s]: train==[2.36680 = 0.14066 + 2.22615], recall= [ 0.02130  0.08075  0.12440  0.15440] , precision= [ 0.02435  0.01843  0.01400  0.01159] , auc=[0.77262], sum_recall=[0.38085]
Epoch 27 [30.2s + 11.7s]: train==[2.36155 = 0.13739 + 2.22417], recall= [ 0.02217  0.08350  0.12990  0.15570] , precision= [ 0.02522  0.01896  0.01452  0.01165] , auc=[0.77231], sum_recall=[0.39128]
Epoch 28 [27.6s + 12.4s]: train==[2.35959 = 0.13721 + 2.22238], recall= [ 0.02261  0.08423  0.12715  0.15679] , precision= [ 0.02522  0.01913  0.01426  0.01159] , auc=[0.77343], sum_recall=[0.39077]
Epoch 29 [29.6s + 13.3s]: train==[2.35204 = 0.13127 + 2.22077], recall= [ 0.02435  0.08307  0.12440  0.15744] , precision= [ 0.02696  0.01878  0.01391  0.01171] , auc=[0.77413], sum_recall=[0.38925]
Epoch 30 [28.7s + 13.9s]: train==[2.35216 = 0.13279 + 2.21937], recall= [ 0.02522  0.08292  0.12874  0.15396] , precision= [ 0.02783  0.01896  0.01435  0.01148] , auc=[0.77422], sum_recall=[0.39085]
Epoch 31 [28.6s + 14.2s]: train==[2.34232 = 0.12431 + 2.21801], recall= [ 0.02478  0.08640  0.12744  0.15425] , precision= [ 0.02696  0.01965  0.01426  0.01154] , auc=[0.77354], sum_recall=[0.39287]
Epoch 32 [27.7s + 14.4s]: train==[2.34167 = 0.12502 + 2.21665], recall= [ 0.02435  0.08698  0.12396  0.15128] , precision= [ 0.02696  0.01948  0.01391  0.01136] , auc=[0.77158], sum_recall=[0.38657]
Epoch 33 [27.8s + 14.2s]: train==[2.33160 = 0.11658 + 2.21502], recall= [ 0.02391  0.08655  0.12353  0.15461] , precision= [ 0.02609  0.01948  0.01383  0.01159] , auc=[0.77373], sum_recall=[0.38860]
Epoch 34 [28.4s + 13.3s]: train==[2.33063 = 0.11764 + 2.21298], recall= [ 0.02304  0.08589  0.12135  0.15255] , precision= [ 0.02609  0.01930  0.01357  0.01148] , auc=[0.77412], sum_recall=[0.38284]
Epoch 35 [31.1s + 12.5s]: train==[2.32340 = 0.11282 + 2.21059], recall= [ 0.02377  0.08546  0.12465  0.15523] , precision= [ 0.02609  0.01913  0.01409  0.01165] , auc=[0.77276], sum_recall=[0.38911]
Epoch 36 [28.5s + 13.3s]: train==[2.31579 = 0.10808 + 2.20771], recall= [ 0.02217  0.08155  0.12353  0.14907] , precision= [ 0.02522  0.01843  0.01383  0.01113] , auc=[0.77146], sum_recall=[0.37632]
Epoch 37 [27.9s + 13.1s]: train==[2.31586 = 0.11159 + 2.20427], recall= [ 0.02130  0.08300  0.12599  0.15414] , precision= [ 0.02435  0.01861  0.01417  0.01154] , auc=[0.77195], sum_recall=[0.38443]
Epoch 38 [31.4s + 15.0s]: train==[2.30708 = 0.10708 + 2.20001], recall= [ 0.02377  0.08068  0.12411  0.15690] , precision= [ 0.02696  0.01826  0.01391  0.01171] , auc=[0.77277], sum_recall=[0.38545]
Epoch 39 [31.9s + 14.6s]: train==[2.30394 = 0.10915 + 2.19479], recall= [ 0.02420  0.07865  0.12494  0.15255] , precision= [ 0.02696  0.01774  0.01409  0.01142] , auc=[0.77245], sum_recall=[0.38034]
Epoch 40 [32.8s + 14.9s]: train==[2.28836 = 0.09961 + 2.18875], recall= [ 0.02420  0.08104  0.12523  0.15893] , precision= [ 0.02696  0.01826  0.01409  0.01194] , auc=[0.77285], sum_recall=[0.38940]
End of trainning! Best recall= [ 0.02522  0.08292  0.12874  0.15396] , precision= [ 0.02783  0.01896  0.01435  0.01148] , auc=[0.77422]
